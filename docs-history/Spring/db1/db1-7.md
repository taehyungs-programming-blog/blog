---
layout: default
title: "07. Springboot ë¦¬ì†ŒìŠ¤ ìë™ ë“±ë¡"
parent: "(DB1)"
grand_parent: "Spring ğŸ"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

* ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ë“±ì¥í•˜ê¸° ì´ì „ì—ëŠ” ë°ì´í„°ì†ŒìŠ¤ì™€ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ê°œë°œìê°€ ì§ì ‘ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•´ì„œ ì‚¬ìš©í–ˆë‹¤. 
* ê·¸ëŸ°ë° ìŠ¤í”„ë§ ë¶€íŠ¸ë¡œ ê°œë°œì„ ì‹œì‘í•œ ê°œë°œìë¼ë©´ ë°ì´í„°ì†ŒìŠ¤ë‚˜ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ì§ì ‘ ë“±ë¡í•œ ì ì´ ì—†ì„ ê²ƒì´ë‹¤. 

* ì´ ë¶€ë¶„ì„ ì ì‹œ ì‚´í´ë³´ì

```java
@TestConfiguration
static class TestConfig {
    @Bean
    DataSource dataSource() {
        return new DriverManagerDataSource(URL, USERNAME, PASSWORD);
    }

    @Bean
    PlatformTransactionManager transactionManager() {
        return new DataSourceTransactionManager(dataSource());
    }
```

* ë°ì´í„°ì†ŒìŠ¤
    * ìë™ ë“±ë¡ ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ë°ì´í„°ì†ŒìŠ¤( DataSource )ë¥¼ ìŠ¤í”„ë§ ë¹ˆì— ìë™ìœ¼ë¡œ ë“±ë¡í•œë‹¤. 
    * ìë™ìœ¼ë¡œ ë“±ë¡ë˜ëŠ” ìŠ¤í”„ë§ ë¹ˆ ì´ë¦„: dataSource 
    * ì°¸ê³ ë¡œ ê°œë°œìê°€ ì§ì ‘ ë°ì´í„°ì†ŒìŠ¤ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ë°ì´í„°ì†ŒìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ì§€ ì•ŠëŠ”ë‹¤.
* ì´ë•Œ ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì´ application.properties ì— ìˆëŠ” ì†ì„±ì„ ì‚¬ìš©í•´ì„œ DataSource ë¥¼ ìƒì„±í•œë‹¤. ê·¸ë¦¬ê³  ìŠ¤í”„ë§ ë¹ˆì— ë“±ë¡í•œë‹¤

```
spring.datasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.username=sa
spring.datasource.password=
```

---

* íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € 
    * ìë™ ë“±ë¡ ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ì ì ˆí•œ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €( PlatformTransactionManager )ë¥¼ ìë™ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆì— ë“±ë¡í•œë‹¤. 
    * ìë™ìœ¼ë¡œ ë“±ë¡ë˜ëŠ” ìŠ¤í”„ë§ ë¹ˆ ì´ë¦„: transactionManager 
* ì°¸ê³ ë¡œ ê°œë°œìê°€ ì§ì ‘ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ì§€ ì•ŠëŠ”ë‹¤.

```java
/**
 * íŠ¸ëœì­ì…˜ - DataSource, transactionManager ìë™ ë“±ë¡
 */
@Slf4j
@SpringBootTest
class MemberServiceV3_4Test {

    public static final String MEMBER_A = "memberA";
    public static final String MEMBER_B = "memberB";
    public static final String MEMBER_EX = "ex";

    @Autowired
    private MemberRepositoryV3 memberRepository;
    @Autowired
    private MemberServiceV3_3 memberService;

    @TestConfiguration
    static class TestConfig {

        private final DataSource dataSource;

        public TestConfig(DataSource dataSource) {
            this.dataSource = dataSource;
        }

        @Bean
        MemberRepositoryV3 memberRepositoryV3() {
            return new MemberRepositoryV3(dataSource);
        }

        @Bean
        MemberServiceV3_3 memberServiceV3_3() {
            return new MemberServiceV3_3(memberRepositoryV3());
        }
    }

    // ...
```