---
layout: default
title: "06. Transaction AOP"
parent: "(DB1)"
grand_parent: "Spring ğŸ"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

* ì§€ê¸ˆê¹Œì§€ íŠ¸ëœì­ì…˜ì„ í¸ë¦¬í•˜ê²Œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ íŠ¸ëœì­ì…˜ ì¶”ìƒí™”ë„ ë„ì…í•˜ê³ , ì¶”ê°€ë¡œ ë°˜ë³µì ì¸ íŠ¸ëœì­ì…˜ ë¡œì§ì„ í•´ê²°í•˜ê¸° ìœ„í•´ íŠ¸ëœì­ì…˜ í…œí”Œë¦¿ë„ ë„ì…í–ˆë‹¤. 
* íŠ¸ëœì­ì…˜ í…œí”Œë¦¿ ë•ë¶„ì— íŠ¸ëœì­ì…˜ì„ ì²˜ë¦¬í•˜ëŠ” ë°˜ë³µ ì½”ë“œëŠ” í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤. 
* í•˜ì§€ë§Œ ì„œë¹„ìŠ¤ ê³„ì¸µì— ìˆœìˆ˜í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œ ë‚¨ê¸´ë‹¤ëŠ” ëª©í‘œëŠ” ì•„ì§ ë‹¬ì„±í•˜ì§€ ëª»í–ˆë‹¤. 
* ì´ëŸ´ ë•Œ ìŠ¤í”„ë§ AOPë¥¼ í†µí•´ í”„ë¡ì‹œë¥¼ ë„ì…í•˜ë©´ ë¬¸ì œë¥¼ ê¹”ë”í•˜ê²Œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

```java
@Slf4j
public class MemberServiceV3_3 {

    private final MemberRepositoryV3 memberRepository;

    public MemberServiceV3_3(MemberRepositoryV3 memberRepository) {
        this.memberRepository = memberRepository;
    }

    // @Transactionalì´ ë‚´ë¶€ì ìœ¼ë¡œ êµ¬í˜„ì„ í•´ì¤€ë‹¤ê³  ìƒê°í•˜ì
    @Transactional
    public void accountTransfer(String fromId, String toId, int money) throws SQLException {
        bizLogic(fromId, toId, money);
    }
```

```java
/**
 * íŠ¸ëœì­ì…˜ - @Transactional AOP
* íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ë ¤ë©´ ëª¨ë‘ Beanìœ¼ë¡œ ë“±ë¡í•´ì•¼í•¨ì„ ê¸°ì–µí•˜ì.
 */
@Slf4j
@SpringBootTest
class MemberServiceV3_3Test {

    public static final String MEMBER_A = "memberA";
    public static final String MEMBER_B = "memberB";
    public static final String MEMBER_EX = "ex";

    @Autowired
    private MemberRepositoryV3 memberRepository;
    @Autowired
    private MemberServiceV3_3 memberService;

    @TestConfiguration
    static class TestConfig {
        @Bean
        DataSource dataSource() {
            return new DriverManagerDataSource(URL, USERNAME, PASSWORD);
        }

        @Bean
        PlatformTransactionManager transactionManager() {
            return new DataSourceTransactionManager(dataSource());
        }

        @Bean
        MemberRepositoryV3 memberRepositoryV3() {
            return new MemberRepositoryV3(dataSource());
        }

        @Bean
        MemberServiceV3_3 memberServiceV3_3() {
            return new MemberServiceV3_3(memberRepositoryV3());
        }
    }
```