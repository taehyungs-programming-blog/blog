---
layout: default
title: "29. Init D3D12"
parent: "(Part.3 - ì—”ì§„ ë‚´ë¶€ êµ¬í˜„)"
grand_parent: "(ë‚˜ì˜ ê²Œì„ì—”ì§„ ğŸ²)"
nav_order: 3
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

* [Get Code ğŸŒ](https://github.com/Arthur880708/ArthurDX12GameEngine/commit/cb151b055ed1ea53d2a9305b3fc8366ecabae550)

* ì‚¬ì‹¤ìƒ ì—¬ê¸°ì„œ ë¶€í„°ê°€ í•µì‹¬ì´ë¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* DirectX API ì‚¬ìš©ë²•ì€ ì•ˆë‹¤ê³  ê°€ì •í•˜ê³  ìµœì†Œí•œìœ¼ë¡œ ì„¤ëª…í•  ì˜ˆì •ì´ê³ , 
* **êµ¬ì¡°**ë¥¼ ì–´ë–»ê²Œ ê°€ì ¸ê°”ëŠ”ì§€ ìœ„ì£¼ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## Tester

* Renderer í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œ EngineTest í”„ë¡œì íŠ¸ê°€ ì¡´ì¬

```cpp
int WINAPI WinMain(HINSTANCE, HINSTANCE, LPSTR, int)
{
#if _DEBUG
    _CrtSetDbgFlag(_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);
#endif
    // engine_testë¥¼ ë§Œë“¤ì–´ runí•˜ëŠ” í˜•íƒœì´ë‹¤.
    engine_test test{};
    if (test.initialize())
    {
        MSG msg{};
        bool is_running{ true };
        while (is_running)
        {
            while (PeekMessage(&msg, NULL, 0, 0, PM_REMOVE))
            {
                TranslateMessage(&msg);
                DispatchMessage(&msg);
                is_running &= (msg.message != WM_QUIT);
            }

            test.run();
        }
    }
    test.shutdown();
    return 0;
}
```

```cpp
class engine_test : public test // testëŠ” ê·¸ì € interfaceì¼ ë¿ ..
{
public: 
    bool initialize() override;
    void run() override;
    void shutdown() override;
};
```

```cpp
bool
engine_test::initialize()
{
    bool result{ graphics::initialize(graphics::graphics_platform::direct3d12) };
    if (!result) return result;

    // ...
}
```

```cpp
namespace primal::graphics {

class surface
{};

struct render_surface
{
    platform::window window{};
    surface surface{};
};

enum class graphics_platform :u32
{
    direct3d12 = 0,
};

// primal::graphicsì— initializeê°€ ìˆê³  graphics_platformì„ ë„˜ê¸´ë‹¤
bool initialize(graphics_platform platform);
void shutdown();

}
```

```cpp
bool
initialize(graphics_platform platform)
{
    return set_platform_interface(platform) && gfx.initialize();
}
```

```cpp
bool
initialize()
{
    // ì—¬ê¸°ì„œ DX12 Init
    if (main_device) shutdown();

    u32 dxgi_factory_flags{ 0 };

    // ...
}
```

* Graphics
    * Direct3D12
        * D3D12Core
        * D3D12Interface

```cpp
// D3D12Interface
namespace primal::graphics::d3d12 {

void
get_platform_interface(platform_interface& pi)
{
    // D3D12Core ë‚´ì— initialize, shutdownì´ êµ¬í˜„ë˜ì–´ ìˆìŒ.
    pi.initialize = core::initialize;
    pi.shutdown = core::shutdown;
}

}
```

---

## ì •ë¦¬

* Rendererì˜ `initialize()`ì„ í˜¸ì¶œí•´ ëœë”ë§ ì¤€ë¹„

```cpp
bool
engine_test::initialize()
{
    // graphics::initialize -> Rendererë‚´ì˜ initialize
    bool result{ graphics::initialize(graphics::graphics_platform::direct3d12) };

    // ...
```

```cpp
bool
initialize(graphics_platform platform)
{
    // Dx12ì§€ì • ë° init
    return set_platform_interface(platform) && gfx.initialize();
}

bool
set_platform_interface(graphics_platform platform)
{
    switch (platform)
    {
    case graphics_platform::direct3d12:
        // ì—¬ê¸°ì„œ Core Dx12ì™€ ì—°ê²°í•œë‹¤
        d3d12::get_platform_interface(gfx);
        break;
    default:
        return false;
    }

    return true;
}

} 
```

* (í•µì‹¬) **Renderer**ë¥¼ í†µí•´ Dx12ì— ì ‘ê·¼í•¨ì„ ìŠì§€ ë§ì.