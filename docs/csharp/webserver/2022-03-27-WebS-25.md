---
layout: default
title: "25. Example - WebApi 1"
parent: (WebServer)
grand_parent: "(C#)"
nav_order: 3
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

{% raw %}

* [Get Code ğŸŒ](https://github.com/EasyCoding-7/AspNetTutorial/tree/25.Example.WebApi)

ğŸ… **API (C#)** í”„ë¡œì íŠ¸ë¥¼ í•˜ë‚˜ ì¶”ê°€í•˜ì

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/webserver/web-25-1.png"/>
</p>

ğŸ… **í´ë˜ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ (C#)** í”„ë¡œì íŠ¸ë¥¼ í•˜ë‚˜ ì¶”ê°€í•˜ì

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/webserver/web-25-2.png"/>
</p>

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/webserver/web-25-3.png"/>
</p>

ğŸ… SharedData ì•„ë˜ GameReulst.csë¥¼ ë§Œë“¤ê³  ì•„ë˜ë¥¼ ì¶”ê°€í•˜ì<br>
ğŸ… GameResultë¥¼ ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œë„ ê³µí†µìœ¼ë¡œ ì“¸ ì˜ˆì •ì´ë‹¤.

```csharp
namespace SharedData.Models
{
    public class GameResult
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public string UserName { get; set; }
        public DateTime Date { get; set; }
    }
}
```

ğŸ… ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ **ì¶”ê°€ -> í”„ë¡œì íŠ¸ ì°¸ì¡° -> ë‹¤ë¥¸ í”„ë¡œì íŠ¸ ì„ íƒ**

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/webserver/web-25-4.png"/>
</p>

ğŸ… WebAPIì—ì„œë„ DBì°¸ì¡°ë¥¼ ìœ„í•´ì„œ Data/ApplicationDbContext.cs ë¥¼ í•˜ë‚˜ ë§Œë“¤ì

```csharp
namespace WebAPI.Data
{
    // DbContextëŠ” NuGet íŒ¨í‚¤ì§€ ì„¤ì¹˜ê°€ í•„ìš”í•˜ë‹¤.(ì•„ë˜ ì°¸ê³ )
    public class ApplicationDbContext : DbContext
    {
        public DbSet<GameResult> GameResults { get; set; }
        public ApplicationDbContext(DbContextOptions<ApplicationDbContext> options)
            : base(options)
        {

        }
    }
}
```

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/webserver/web-25-5.png"/>
</p>

```csharp
    public class Startup
    {
        // ...

        public void ConfigureServices(IServiceCollection services)
        {
            services.AddControllers();

            // ApplicationDbContextë¥¼ ì‚¬ìš©í•˜ê² ë‹¤ê³  ì•Œë¦°ë‹¤.
            services.AddDbContext<ApplicationDbContext>(options =>
                    options.UseSqlServer(
                        Configuration.GetConnectionString("DefaultConnection")));
        }
```

ğŸ… sql.server NuGetì„ ê¹”ì•„ì¤˜ì•¼í•œë‹¤.

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/webserver/web-25-8.png"/>
</p>

ğŸ… DB-Migrationì´ í•„ìš”í•˜ë‹¤<br>
ğŸ… **ë„êµ¬ -> NuGet íŒ¨í‚¤ì§€ ê´€ë¦¬ì -> íŒ¨í‚¤ì§€ ê´€ë¦¬ì ì½˜ì†”**

```bash
# ì°¸ê³ ë¡œ ì‹œì‘í”„ë¡œì íŠ¸ë¥¼ WebAPIë¡œ ë°”ê¾¸ê³ , íŒ¨í‚¤ì§€ ê´€ë¦¬ì ì½˜ì†”ì˜ ê¸°ë³¸ í”„ë¡œì íŠ¸ë„ WebAPIë¡œ ë°”ê¾¸ì
$ add-migration RankingApp

# ì—ëŸ¬ê°€ ë‚ í…ë°, Microsoft.EntityFrameworkCore.Design NuGet ì„¤ì¹˜
# ê·¸ë˜ë„ connectionString ê´€ë ¨ ì—ëŸ¬ê°€ë‚˜ëŠ”ë°, appsettings.jsonì— DefaultConnection ì¶”ê°€(ì•„ë˜ì°¸ì¡°)
$ update-database
```

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/webserver/web-25-6.png"/>
</p>

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/webserver/web-25-7.png"/>
</p>

```json
/*appsettings.json*/
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=(localdb)\\ProjectsV13;Initial Catalog=RankingAPIDB;Integrated Security=True;Connect Timeout=30;Encrypt=False;TrustServerCertificate=False;ApplicationIntent=ReadWrite;MultiSubnetFailover=False"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
    }
  },
  "AllowedHosts": "*"
}
```

{% endraw %}
