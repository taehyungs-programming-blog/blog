---
layout: default
title: "1. C# ë¬¸ë²• ì¶”ê°€ (Async, Await)"
parent: (WebServer)
grand_parent: C#
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

## Task ì¨ë³´ê¸°

```csharp
static Task Test()
{
    Console.WriteLine("* Start Test *");
    Task t = Task.Delay(3000);
    return t;
}

static void Main(string[] args)
{
    Task t = Test();

    Console.WriteLine("* Start While *");
    while(true)
    {

    }

    /*
        * Start While *     <- Whileì´ ë¨¼ì € ëœ¬ë‹¤??
        * Start Test *

        Taskì˜ ì™„ë£Œ ì—¬ë¶€ë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ë‹¤ìŒì¤„ë¡œ ë„˜ì–´ê°„ë‹¤.
    */
}
```

```csharp
static Task Test()
{
    Console.WriteLine("* Start Test *");
    Task t = Task.Delay(3000);
    return t;
}

static void Main(string[] args)
{
    Task t = Test();
    t.Wait();           // tì˜ ì™„ë£Œë¥¼ ê¸°ë‹¤ë ¤ ë‹¬ë¼.

    Console.WriteLine("* Start While *");
    while(true)
    {

    }

    /*
        * Start Test *
        // 3ì´ˆ í›„
        * Start While *
    */
}
```

---

## Async, Await ì¨ë³´ê¸°

```csharp
static void TestAsync()
{
    Console.WriteLine("* Start TestAsync *");
    Task t = Task.Delay(3000);  // <- ë³µì¡í•œ ë¡œì§ì´ë¼ ê°€ì •í•œë‹¤.
    t.Wait();
    Console.WriteLine("* End TestAsync *");
}

static void Main(string[] args)
{
    TestAsync();

    Console.WriteLine("* Start While *");
    while(true)
    {

    }

    /*
        * Start TestAsync *
        // 3ì´ˆí›„
        * End TestAsync *
        * Start While *
    */  
}
```

```csharp
static async void TestAsync()
{
    Console.WriteLine("* Start TestAsync *");
    await Task.Delay(3000);
    Console.WriteLine("* End TestAsync *");
}

static void Main(string[] args)
{
    TestAsync();

    Console.WriteLine("* Start While *");
    while(true)
    {

    }

    /*
        * Start TestAsync *
        * Start While *
        // 3ì´ˆí›„
        * End TestAsync *
    */  
}
```

```csharp
static async Task TestAsync()
{
    Console.WriteLine("* Start TestAsync *");
    await Task.Delay(3000);
    Console.WriteLine("* End TestAsync *");
}

static async Task Main(string[] args)
{
    await TestAsync();

    Console.WriteLine("* Start While *");
    while(true)
    {

    }

    /*
        * Start TestAsync *
        // 3ì´ˆí›„
        * End TestAsync *
        * Start While *
    */  
}
```

* [Good Example ğŸŒ](https://docs.microsoft.com/ko-kr/dotnet/csharp/programming-guide/concepts/async/)

```csharp
static async Task Main(string[] args)
{
    Coffee cup = PourCoffee();
    Console.WriteLine("coffee is ready");

    var eggsTask = FryEggsAsync(2);
    var baconTask = FryBaconAsync(3);
    var toastTask = MakeToastWithButterAndJamAsync(2);

    var breakfastTasks = new List<Task> { eggsTask, baconTask, toastTask };
    while (breakfastTasks.Count > 0)
    {
        // ì…‹ì¤‘ ëë‚œì• ê°€ ìˆëŠ”ì§€ ì²´í¬
        Task finishedTask = await Task.WhenAny(breakfastTasks);
        if (finishedTask == eggsTask)
        {
            Console.WriteLine("eggs are ready");
        }
        else if (finishedTask == baconTask)
        {
            Console.WriteLine("bacon is ready");
        }
        else if (finishedTask == toastTask)
        {
            Console.WriteLine("toast is ready");
        }
        breakfastTasks.Remove(finishedTask);
    }

    Juice oj = PourOJ();
    Console.WriteLine("oj is ready");
    Console.WriteLine("Breakfast is ready!");
}
```
