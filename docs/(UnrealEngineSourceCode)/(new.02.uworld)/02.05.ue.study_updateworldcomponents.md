---
layout: default
title: "02-05. UpdateWorldComponents"
parent: "(02. UWorldë“¤ì–´ê°€ê¸°)"
grand_parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

```cpp
// UpdateWorldComponentsì˜ ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ ì§„í–‰ë˜ê²Œ ëœë‹¤.
void UpdateWorldComponents(bool bRerunConstructionScripts, bool bCurrentLevelOnly, FRegisterComponentContext* Context = nullptr)
{
    // ...

    if (!bInSkipInitWorld)
    {
        InitWorld(IVS);

        // update components
        const bool bRerunConstructionScripts = !FPlatformProperties::RequiresCookedData();
        UpdateWorldComponents(bRerunConstructionScripts, false);
    }
}
```

```cpp
/** updates world components like e.g. line batcher and all level components */
void UpdateWorldComponents(bool bRerunConstructionScripts, bool bCurrentLevelOnly, FRegisterComponentContext* Context = nullptr)
{
    if (!IsRunningDedicatedServer())
    {
        // - ULineBatchComponent is herited from UPrimitiveComponent
        // - ULineBatchComponent can be seen as UActorComponent
        // - UWorld is NOT AActor, but has UActorComponent as its dynamic object for LineBatcher
        // - LineBatchers should be registered separately
        if (!LineBatcher)
        {
            LineBatcher = NewObject<ULineBatchComponent>();
            LineBatcher->bCalculateAccurateBounds = false;
        }

        if(!LineBatcher->IsRegistered())
        {	
            // ì›”ë“œ ì»´í¬ë„ŒíŠ¸ë¥¼ ì—…ë°ì´íŠ¸ í•˜ëŠ” í•¨ìˆ˜ë¡œ ë¼ì¸ ë°°ì²˜ ë° ëª¨ë“  ë ˆë²¨ êµ¬ì„±ìš”ì†Œë“¤ì„ ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.
            LineBatcher->RegisterComponentWithWorld(this, Context);
        }
```

```cpp
/** registers a component with a specific world, which creates any visual/physical state */
// Componentì— ëŒ€í•œ Register í˜¸ì¶œê³¼ ì›”ë“œì— ë“±ë¡ì„ ì§„í–‰í•˜ëŠ” í•¨ìˆ˜ ì…ë‹ˆë‹¤
void RegisterComponentWithWorld(UWorld* InWorld, FRegisterComponentContext* Context = nullptr)
{
    // if the component was already registered, do nothing
    if (IsRegistered())
    {
        return;
    }

    // it is natural to early-out cuz there is no world to register
    if (InWorld == nullptr)
    {
        return;
    }

    // if not registered, should not have a scene
    // it means that we can know whether it is registered or not by its existance of WorldPrivate
    check(WorldPrivate == nullptr);

    // UWorld::LineBatcher(ULineBatchComponent)'s owner is nullptr
    // LineBacherì˜ ê²½ìš° NewObjectë¥¼ í†µí•´ ìƒì„± í›„ ë°”ë¡œ ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œ í•˜ê¸° ë•Œë¬¸ì— ì•„ì§OwnerëŠ” ì¡´ì¬ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
    AActor* MyOwner = GetOwner();
    check(MyOwner == nullptr || MyOwner->OwnsComponent(this));

    if (!HasBeenCreated)
    {
        // do you remember OnComponentCreated() event covered in AActor?
        // - it is called when ActorComponent is being created
        // OnComponentCreated í•¨ìˆ˜ëŠ” ì‚¬ìš©ìê°€ ì˜¤ë²„ë¼ì´ë”©ì„ í•´ì„œ ì¶”ê°€ì ìœ¼ë¡œ ë¡œì§ì„ ì§„í–‰í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” í•¨ìˆ˜ ì…ë‹ˆë‹¤.
        OnComponentCreated();
    }

    WorldPrivate = InWorld;

    ExecuteRegisterEvents(Context);
```
