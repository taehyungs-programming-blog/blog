---
layout: default
title: "01-01. WinMain"
parent: "(01. UEì˜ Mainì€ ì–´ë””ì¼ê¹Œ?)"
grand_parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

```cpp
int32 WinMain(_In_ HINSTANCE hInInstance, _In_opt_ HINSTANCE hPrevInstance, _In_ char* pCmdLine, _In_ int32 nCmdShow)
{
    // ì‹œì‘
        // ì•„ë§ˆ Main Loopê°€ ì—¬ê¸°ì„œ ëŒê² ì§€?
    int32 Result = LaunchWindowsStartup(hInInstance, hPrevInstance, pCmdLine, nCmdShow, nullptr);

    // ì¢…ë£Œ
    LaunchWindowsShutdown();
    return Result;
}
```

```cpp
int32 LaunchWindowsStartup(HINSTANCE hInInstance, HINSTANCE hPrevInstance, char*, int32 nCmdShow, const TCHAR* CmdLine)
{
    int32 ErrorLevel = 0;

    if (!CmdLine)
    {
        CmdLine = GetCommandLineW();
        if (ProcessCommandLine())
        {
            CmdLine = *GSavedCommandLine;
        }
    }

    {
        // use SEH (structured exception handling) to trap the crash:
        // SEH(êµ¬ì¡°í™”ëœ ì˜ˆì™¸ ì²˜ë¦¬)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¶©ëŒì„ í¬ì°©í•©ë‹ˆë‹¤:
        //  if you don't know what SEH is, plz searching it and make sure to understand this!
        // - one thing I want to point out is that SEH is triggered by OS (kernel mode):
        //   - the way of behaving SEH is not static, it could be changed anytime by OS provider like MS:
        //      - cuz, it's related OS security itself
        //      - if you are interested in this, start from:
        //          - IDTR register
        //          - IDT(interrupt descriptor table)
        //          - ISRs(interrupt service routines)
        //          - interrupt dispatching
        //          - kernel patch protection
        //      - for my recommendation, just skip this, just good to know ~ :)

        //  SEHê°€ ë¬´ì—‡ì¸ì§€ ëª¨ë¥´ì‹ ë‹¤ë©´, ê²€ìƒ‰í•´ë³´ì‹œê³  ì´í•´í•˜ì…¨ëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”!
        // - í•œ ê°€ì§€ ì§€ì í•˜ê³  ì‹¶ì€ ì ì€ SEHê°€ OS(ì»¤ë„ ëª¨ë“œ)ì— ì˜í•´ íŠ¸ë¦¬ê±°ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤:
        //   - SEHì˜ ë™ì‘ ë°©ì‹ì€ ì •ì ì´ì§€ ì•Šìœ¼ë©°, MSì™€ ê°™ì€ OS ì œê³µì—…ì²´ì— ì˜í•´ ì–¸ì œë“ ì§€ ë³€ê²½ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
        //      - ì´ëŠ” OS ë³´ì•ˆ ìì²´ì™€ ê´€ë ¨ì´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤
        //      - ì´ì— ê´€ì‹¬ì´ ìˆë‹¤ë©´ ë‹¤ìŒë¶€í„° ì‹œì‘í•´ë³´ì„¸ìš”:
        //          - IDTR ë ˆì§€ìŠ¤í„°
        //          - IDT(ì¸í„°ëŸ½íŠ¸ ë””ìŠ¤í¬ë¦½í„° í…Œì´ë¸”)
        //          - ISR(ì¸í„°ëŸ½íŠ¸ ì„œë¹„ìŠ¤ ë£¨í‹´)
        //          - ì¸í„°ëŸ½íŠ¸ ë””ìŠ¤íŒ¨ì¹­
        //          - ì»¤ë„ íŒ¨ì¹˜ ë³´í˜¸
        //      - ì œ ì¶”ì²œìœ¼ë¡œëŠ” ì´ ë¶€ë¶„ì€ ê·¸ëƒ¥ ë„˜ì–´ê°€ì„¸ìš”. ì•Œì•„ë‘ë©´ ì¢‹ì€ ì •ë„ì…ë‹ˆë‹¤ ~ :)
        __try
        {
            GIsGuarded = 1;
            ErrorLevel = GuardedMainWrapper(CmdLine);
            GIsGuarded = 0;
        }
        //  when exception triggered, catch here
        // - when a crash occurs in the engine, a crash report is generated from here normally
        
        //  ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì—¬ê¸°ì„œ ì¡ìŠµë‹ˆë‹¤
        // - ì—”ì§„ì—ì„œ ì¶©ëŒì´ ë°œìƒí•˜ë©´ ì¼ë°˜ì ìœ¼ë¡œ ì—¬ê¸°ì„œ ì¶©ëŒ ë³´ê³ ì„œê°€ ìƒì„±ë©ë‹ˆë‹¤
        __except(FPlatformMisc::GetCrashHandlingType == ECrashHandlingType::Default
            ? ReportCrash(GetExceptionInformation())
			: EXCEPTION_CONTINUE_SEARCH)
        {
            ErrorLevel = 1;
            FPlatformMisc::RequestExit(true);
        }
    }

    return ErrorLevel;
}
```
