---
layout: default
title: "(07_01.UGameViewportClient)"
parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
has_children: true
nav_order: 1
---

## ì‹œì‘

```cpp
/**
 * a game viewport (FViewport) is high-level abstract interface for the
 * the platform specific rendering, audio, and input subsystems.
 * GameViewportClient is the engine's interface to a game viewport.
 * Exactly, one GameViewportClient is created for each instance of the game.
 * The only case (so far) where you might have a single instance of Engine, but 
 * multiple instances of the game (and thus multiple GameViewportClients) is when
 * you have more than one PIE window running
 * 
 * Responsibilities:
 * - propagate input events to the global interactions list
 */

* UGameViewportClientë¥¼ í†µí•´ì„œ OS(Platform)ì— ìƒê´€ì—†ì´ OSì—ì„œ í•„ìš”í•œ ì •ë³´ë¥¼ ë°›ì•„ì˜¤ê³  ì‹¶ë‹¤ *

//                                   â”‚                                                                                                                
//    Platform ~= Operating System   â”‚            Unreal                                                                                              
//                                   â”‚                                                                                                                
//     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚                                                                                                                
//     â”‚  PC    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       
//     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚         â”‚                                  â”Œâ”€â”€â”€â”€â–ºâ”‚ViewportConsoleâ”‚    // for debug                                                   
//                         â”‚         â”‚                       InputAxis  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       
//     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚         â”‚                                  â”‚                                                                             
//     â”‚ Xbox S â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       
//     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºUGameViewportClientâ”œâ”€â”€â”€â”´â”€â”€â”€â”€â–ºâ”‚ULocalPlayer   â”œâ”€â”€â”€â”€â”€â”€â”€â–ºPlayerControllerâ”€â”€â”€â”€â”€â”€â”€â”€â–ºCharacter             
//                         â”‚         â”‚      â–²   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       
//     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚         â”‚      â”‚                                                                                                         
//     â”‚ PS5    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚      â”‚                                                                                                         
//     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚         â”‚      â”‚                                                                                                         
//                         â”‚         â”‚      â”‚                                                                                                         
//     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚         â”‚   - In Unreal, various system wraps platform specific handling: e.g. SlateApplication                          
//     â”‚ Switch â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   - Various systems puts platform events like input,viewport(window) size changes, ... to UGameViewportClient  
//     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚                                                                                                                
//                                   â”‚                                                                                                                
//                                   â”‚                                                                                                                

class UGameViewportClient : public UScriptViewportClient, public FExec
{
    virtual ULocalPlayer* SetupInitialLocalPlayer(FString& OutError)
    {
        UGameInstance* ViewportGameInstance = GEngine->GetWorldContextFromGameViewportChecked(this).OwningGameInstance;
        if (!ensure(ViewportGameInstance))
        {
            return NULL;
        }

        return ViewportGameInstance->CreateInitialPlayer(OutError);
    }
};
```

---

## UScriptViewportClientëŠ” ë­˜ê¹Œ?

* íƒ€ê³ íƒ€ê³  ì˜¬ë¼ê°€ë©´ ...

```cpp
// ê²°êµ­ ì—¬ê¸°ë‹¤
class FViewportClient
{
    virtual void Draw(FViewport* Viewport, FCanvas* Canvas) {}

    /** 
     * check a key event received by the viewport 
     * if the viewport client uses the event, it should return true to consume it
     */
    virtual bool InputKey(const FInputKeyEventArgs& EventArgs)
    {
        //...
    }

    /**
     * check an axis movement received by the viewport
     * if the viewport client uses the movement, it should return true to consume it 
     */
    virtual bool InputAxis(FViewport* Viewport, FInputDeviceId InputDevice, FKey Key, float Delta, float DeltaTime, int32 NumSamples = 1, bool bGamepad = false) { return false; }
};

/** common functionality for game and editor viewport clients */
class FCommonViewportClient : public FViewportClient
{

};

class UScriptViewportClient : public UObject, public FCommonViewportClient
{

};
```

* **ViewPort** : DirectX, Vulkanì„ í†µí•œ Drawê°€ ì•„ë‹ˆë¼ OS Levelì˜ Drawë¼ ìƒê°í•˜ë©´ëœë‹¤
    * ê·¸ëŸ°ë° ì´ë¦„ì´ `GameViewPort`ì¸ê±¸ë¡œ ë´ì„  Gameì— ê³¼ë ¨ëœ Viewportë§Œ interfaceë¡œ ë§Œë“¤ì–´ë†¨ë‹¤ ìƒê°í•˜ë©´ë˜ê² êµ°?

```cpp
/**
 * an abstract interface to a viewport's client
 * the viewport's client processes input received by the viewport, and draws the viewport 
 */


//                                                                                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          
//                                                                                                  â”‚ Operating System â”‚                                          
//           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          
//           â–¼                                                                                    â”‚         â”‚                                                     
//    Viewport in OS                                                                              â”‚         â”‚                                                     
//    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”¬â”€â”¬â”€â”                                              â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                                               
//    â”‚                                      â”‚-â”‚oâ”‚xâ”‚                                              â”‚    â”‚ Process0 â”‚                                               
//    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”´â”€â”´â”€â”¤                                              â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                               
//    â”‚                                            â”‚                                              â”œâ”€â”€â”€â”€â”¤ Process1 â”‚                                               
//    â”‚                                            â”‚  Viewport's Client?                          â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                               
//    â”‚                                            â”‚   :Process(Main Thread)                      â”‚    â”‚ Process2 â”‚                                               
//    â”‚                                            â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                               
//    â”‚                                            â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚FViewportClientâ”‚â—„â”€â”€â”€â”€â”˜    â”‚ Process3 â”‚                                               
//    â”‚                                            â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               
//    â”‚                                            â”‚                                â”‚                                                                             
//    â”‚                                            â”‚                                â”‚                                                                             
//    â”‚                                            â”‚                       1.ViewportClient is the bridge between Process and UnrealEngine                        
//    â”‚                                            â”‚                                                                                                              
//    â”‚                                            â”‚                       2.ViewportClient listen input interrupts from Process (from OS)                        
//    â”‚                                            â”‚                                                                                                              
//    â”‚                                            â”‚                            OS â”€â”€â”€â”€â”€â–º Process â”€â”€â”€â”€â”€â–º FViewportClient â”€â”€â”€â”€â–º Unreal System                      
//    â”‚                                            â”‚                                                                                                              
//    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            : Transfer input events from OS to Unreal Engine                                  
//                                                                                                                                                                
//                                                                         3.Viewport doesn't mean graphical viewport (D3D11), it is about OS's window' viewport  
//                                                                                                                                                
```