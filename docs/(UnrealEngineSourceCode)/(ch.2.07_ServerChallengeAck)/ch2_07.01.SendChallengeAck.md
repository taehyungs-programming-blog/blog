---
layout: default
title: "07-01. SendChallengeAck"
parent: "([Network] 07. ServerChallengeAck)"
grand_parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

```cpp
/** constructs and sends the server ack to a successful challenge response, from the server to the client */
/** ì„±ê³µì ì¸ ì±Œë¦°ì§€ ì‘ë‹µì— ëŒ€í•œ ì„œë²„ í™•ì¸(ack)ì„ êµ¬ì„±í•˜ê³  ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡í•©ë‹ˆë‹¤ */

void SendChallengeAck(FCommonSendToClientParams CommonParams, uint8 ClientSentHandshakePacketCount, uint8 InCookie[COOKIE_BYTE_SIZE])
{
    if (Driver != nullptr)
    {
        // construct AckPacket for Challenge packet from the client
        // - note that packet-type is 'EHandshakePacketType::Ack'
        // - rest of codes are similar to what we have done!

        // í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„°ì˜ ì±Œë¦°ì§€ íŒ¨í‚·ì— ëŒ€í•œ AckPacketì„ êµ¬ì„±í•©ë‹ˆë‹¤
        // - íŒ¨í‚· íƒ€ì…ì´ 'EHandshakePacketType::Ack'ì„ì— ì£¼ëª©í•˜ì„¸ìš”
        // - ë‚˜ë¨¸ì§€ ì½”ë“œëŠ” ìš°ë¦¬ê°€ ì´ì „ì— í–ˆë˜ ê²ƒê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤!

        const int32 AdjustedSize = GetAdjustedSizeBits(HANDSHAKE_PACKET_SIZE_BITS, CommonParams.HandshakeVersion);
        FBitWriter AckPacket(AdjustedSize + (BaseRandomDataLengthBytes * 8) + 1 /*termination bit*/);

        BeginHandshakePacket(AckPacket, EHandshakePacketType::Ack, CommonParams.HandshakeVersion, ClientSentHandshakePacketCount, CommonParams.ClientID);

        // for packet serialization order, we add dummy data to ActiveSecret and Timestamp
        // *** let's remember that we write 'Timestamp' as '-1.0'!
        // íŒ¨í‚· ì§ë ¬í™” ìˆœì„œë¥¼ ìœ„í•´ ActiveSecretê³¼ Timestampì— ë”ë¯¸ ë°ì´í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤
        // *** 'Timestamp'ë¥¼ '-1.0'ìœ¼ë¡œ ì“´ë‹¤ëŠ” ê²ƒì„ ê¸°ì–µí•©ì‹œë‹¤!
        double Timestamp  = -1.0;
        uint8 ActiveSecret_Unused = 1;
        AckPacket.WriteBit(ActiveSecret_Unused);
        AckPacket << Timestamp;
        AckPacket.Serialize(InCookie, COOKIE_BYTE_SIZE);

        SendToClient(CommonParams, EHandshakePacketType::Ack, AckPacket);

        // it's time to create server-side NetConnection(IpConnection)
        // ì´ì œ ì„œë²„ ì¸¡ NetConnection(IpConnection)ì„ ìƒì„±í•  ì‹œê°„ì…ë‹ˆë‹¤
    }
}
```