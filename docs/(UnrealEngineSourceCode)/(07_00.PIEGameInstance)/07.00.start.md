---
layout: default
title: "(07_00.PIEGameInstanceë§Œë“¤ê¸°)"
parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
has_children: true
nav_order: 1
---

## ì‹œì‘

* ì—­ì‹œ ì‹œì‘ì€ Create! í•˜ë‚˜í•˜ë‚˜ ì‚´í´ë³¼ ì˜ˆì •

```cpp
/** create an GameInstance with the given settings. a window is created if this isn't server */
UGameInstance* CreateInnerProcessPIEGameInstance(
    FRequestPlaySessionParams& InParams, 
    const FGameInstancePIEParameters& InPIEParameters, 
    int32 InPIEInstanceIndex)
{
    // create a GameInstance for this new instance
    FSoftClassPath GameInstanceClassName = GetDefault<UGameMapsSettings>()->GameInstanceClass;

    // if an invalid class type was specified we fall back to the default
    UClass* GameInstanceClass = GameInstanceClassName.TryLoadClass<UGameInstance>();
    if (!GameInstanceClass)
    {
        GameInstanceClass = UGameInstance::StaticClass();
    }

    UGameInstance* GameInstance = NewObject<UGameInstance>(this, GameInstanceClass);

    // ì—¬ê¸°ì„œ AddToRoot ë¥¼ í•´ì£¼ëŠ” ì´ìœ ëŠ” GameInstance->InitializeForPlayInEditorê³¼ì •ì—ì„œ
    // GCê°€ í•œ ë²ˆ ëŒê²Œ ëœë‹¤. ê·¸ë•Œ ì œê±°ë˜ëŠ”ê±¸ ë°©ì§€í•˜ê¸° ìœ„í•¨ì´ë‹¤.
    GameInstance->AddToRoot();

    // ì—¬ê¸°ë¶€í„° 1ê°•ì˜ ì‹œì‘ì´ë‹¤! -> GameInstance->InitializeForPlayInEditorë¥¼ ì‚´í´ë³´ì
    const FGameInstancePIEResult InitializeResult = GameInstance->InitializeForPlayInEditor(InPIEInstanceIndex, InPIEParameters);
    if (!InitializeResult.IsSuccess())
    {
        GameInstance->RemoveFromRoot();
        return nullptr;
    }

    // ..


    // ìœ„ì—ì„œ GCëŠ” í”¼í–ˆìœ¼ë‹ˆ ë‹¤ì‹œ Remove
    GameInstance->RemoveFromRoot();

    // ...
```

---

## Tips) ìš©ì–´ì •ë¦¬

* **CDO(Class Default Object)** : 
* CDOëŠ” ì´ëŸ° ì •ë³´ë“¤ì„ ë‹´ëŠ”ë‹¤
    * ê¸°ë³¸ê°’ ì €ì¥: CDOëŠ” íŠ¹ì • í´ë˜ìŠ¤ì˜ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì— ì ìš©ë  ê¸°ë³¸ ì†ì„± ê°’ì„ ì €ì¥í•©ë‹ˆë‹¤. 
        * ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • í´ë˜ìŠ¤ì˜ ê¸°ë³¸ ì²´ë ¥ ê°’, ì†ë„ ê°’ ë“±ì„ CDOì— ì €ì¥í•´ ë‘ë©´, í•´ë‹¹ í´ë˜ìŠ¤ì˜ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë  ë•Œ ì´ëŸ¬í•œ ê¸°ë³¸ê°’ì´ ìë™ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.
    * ê°ì²´ ì´ˆê¸°í™”: ìƒˆ ê°ì²´ê°€ ìƒì„±ë  ë•Œ, CDOì˜ ê°’ì´ ë³µì‚¬ë˜ì–´ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ì— ì ìš©ë©ë‹ˆë‹¤. ì´ëŠ” ê°ì²´ ì´ˆê¸°í™”ë¥¼ ë‹¨ìˆœí™”í•˜ê³  ì¼ê´€ì„±ì„ ìœ ì§€í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.
    * ì„±ëŠ¥ í–¥ìƒ: CDOëŠ” ê¸°ë³¸ê°’ì„ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ë¯€ë¡œ, ë™ì¼í•œ ê¸°ë³¸ê°’ì„ ì—¬ëŸ¬ ê°ì²´ì— ì¼ì¼ì´ ì„¤ì •í•  í•„ìš”ê°€ ì—†ì–´ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.
    * ë°˜ì‚¬(reflection) ì‹œìŠ¤í…œ: Unreal Engineì˜ ë°˜ì‚¬ ì‹œìŠ¤í…œì€ CDOë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë˜ìŠ¤ì˜ ê¸°ë³¸ ì†ì„±ì„ ì¡°íšŒí•˜ê³ , ì—ë””í„°ì—ì„œ í´ë˜ìŠ¤ ì†ì„±ì„ í‘œì‹œí•˜ê±°ë‚˜ ìˆ˜ì •í•˜ëŠ” ë° í™œìš©í•©ë‹ˆë‹¤.

```cpp
// MyCharacter.h
#pragma once

#include "CoreMinimal.h"
#include "GameFramework/Character.h"
#include "MyCharacter.generated.h"

UCLASS()
class MYPROJECT_API AMyCharacter : public ACharacter
{
    GENERATED_BODY()

public:
    AMyCharacter();

protected:
    virtual void BeginPlay() override;

public:    
    virtual void Tick(float DeltaTime) override;

    // Example property
    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Character Stats")
    float Health;

    // Another property
    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Character Stats")
    float Speed;
};

// MyCharacter.cpp
#include "MyCharacter.h"

AMyCharacter::AMyCharacter()
{
    // Set default values for this character's properties
    Health = 100.0f;
    Speed = 600.0f;
}

void AMyCharacter::BeginPlay()
{
    Super::BeginPlay();
}

void AMyCharacter::Tick(float DeltaTime)
{
    Super::Tick(DeltaTime);
}

// MyGameMode.h
#pragma once

#include "CoreMinimal.h"
#include "GameFramework/GameModeBase.h"
#include "MyCharacter.h"
#include "MyGameMode.generated.h"

UCLASS()
class MYPROJECT_API AMyGameMode : public AGameModeBase
{
    GENERATED_BODY()

public:
    virtual void BeginPlay() override;
};

// MyGameMode.cpp
#include "MyGameMode.h"

void AMyGameMode::BeginPlay()
{
    Super::BeginPlay();

    // Get the CDO (Class Default Object) of the MyCharacter class
    AMyCharacter* CDO = Cast<AMyCharacter>(AMyCharacter::StaticClass()->GetDefaultObject());
    if (CDO)
    {
        // Log the default health and speed from the CDO
        UE_LOG(LogTemp, Warning, TEXT("Default Health: %f"), CDO->Health);
        UE_LOG(LogTemp, Warning, TEXT("Default Speed: %f"), CDO->Speed);
    }

    // Example of creating a new character instance and using the CDO's default values
    AMyCharacter* NewCharacter = GetWorld()->SpawnActor<AMyCharacter>(AMyCharacter::StaticClass());
    if (NewCharacter)
    {
        // Optionally, log the new character's initial values
        UE_LOG(LogTemp, Warning, TEXT("New Character Health: %f"), NewCharacter->Health);
        UE_LOG(LogTemp, Warning, TEXT("New Character Speed: %f"), NewCharacter->Speed);
    }
}

```