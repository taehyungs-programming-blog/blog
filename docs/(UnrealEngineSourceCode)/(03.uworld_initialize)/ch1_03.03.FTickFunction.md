---
layout: default
title: "03-03. FTickFunction"
parent: "(03. CreateWorld::Initialize)"
grand_parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

```cpp
struct FTickFunction
{
    // ì—­ì‹œ ì‹œì‘ì€ ë³€ìˆ˜
    // ...


    /** If false, this tick function will never be registered and will never tick. Only settable in defaults */
    // if true, it will tick <every frame?>

    // falseì¸ ê²½ìš° ì´ í‹± í•¨ìˆ˜ëŠ” ì ˆëŒ€ ë“±ë¡ë˜ì§€ ì•Šê³  í‹±í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ì—ì„œë§Œ ì„¤ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.
    // trueì¸ ê²½ìš°, <ë§¤ í”„ë ˆì„ë§ˆë‹¤> í‹±í•  ê²ƒì¸ê°€ìš”?
    uint8 bCanEverTick : 1;

    /** if true, this tick function will start enabled, but can be disabled later on */
    // like bAutoActivate, when tick function is instantiated, automatically register tick function to tick every frame
    // trueì¸ ê²½ìš°, ì´ í‹± í•¨ìˆ˜ëŠ” í™œì„±í™”ëœ ìƒíƒœë¡œ ì‹œì‘í•˜ì§€ë§Œ ë‚˜ì¤‘ì— ë¹„í™œì„±í™”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    // bAutoActivateì™€ ìœ ì‚¬í•˜ê²Œ, í‹± í•¨ìˆ˜ê°€ ì¸ìŠ¤í„´ìŠ¤í™”ë  ë•Œ ìë™ìœ¼ë¡œ ë§¤ í”„ë ˆì„ë§ˆë‹¤ í‹±í•˜ë„ë¡ ë“±ë¡ë©ë‹ˆë‹¤.
    uint8 bStartWithTickEnabled : 1;

    enum class ETickState : uint8
    {
        Disabled,
        Enabled,
        CoolingDown
    };

    /**
     * if Disabled, this tick will not fire
     * if CoolingDown, this tick has an interval frequency that is being adhered to currently
     * CAUTION: do not set this directly
     */
    // Disabledì¸ ê²½ìš°, ì´ í‹±ì€ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    // CoolingDownì¸ ê²½ìš°, ì´ í‹±ì€ í˜„ì¬ ì¤€ìˆ˜ë˜ê³  ìˆëŠ” ê°„ê²© ì£¼ê¸°ë¥¼ ê°€ì§‘ë‹ˆë‹¤.
    // ì£¼ì˜: ì´ê²ƒì„ ì§ì ‘ ì„¤ì •í•˜ì§€ ë§ˆì„¸ìš”.

    // tick function could be specified its frequency
    // - when frequency value is set, tick function will have a moment to be in CoolingDown
    
    // í‹± í•¨ìˆ˜ëŠ” ì£¼ê¸°ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    // - ì£¼ê¸° ê°’ì´ ì„¤ì •ë˜ë©´, í‹± í•¨ìˆ˜ëŠ” CoolingDown ìƒíƒœì— ìˆëŠ” ìˆœê°„ì´ ìˆì„ ê²ƒì…ë‹ˆë‹¤.
    ETickState TickState;

    /** internal data structure that contains members only required for a registered tick function */
    // ë“±ë¡ëœ í‹± í•¨ìˆ˜ì—ë§Œ í•„ìš”í•œ ë©¤ë²„ë“¤ì„ í¬í•¨í•˜ëŠ” ë‚´ë¶€ ë°ì´í„° êµ¬ì¡°
    struct FInternalData
    {
        /** whether the tick function is registered */
        // í‹± í•¨ìˆ˜ê°€ ë“±ë¡ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€
        bool bRegistered : 1;

        /** cache whether this function was rescheduled as an interval function during StartParallel */
        // if true, the TickFunction is in CoolingDown list
        // StartParallel ë™ì•ˆ ì´ í•¨ìˆ˜ê°€ ê°„ê²© í•¨ìˆ˜ë¡œ ì¬ìŠ¤ì¼€ì¤„ë§ë˜ì—ˆëŠ”ì§€ ìºì‹œí•©ë‹ˆë‹¤.
        // trueì¸ ê²½ìš°, TickFunctionì€ CoolingDown ë¦¬ìŠ¤íŠ¸ì— ìˆìŠµë‹ˆë‹¤.
        bool bWasInternal : 1;

        /** the next function in the cooling down list for ticks with an interval */
        // cooling down tick-function list is in a form of linked list
        // ê°„ê²©ì´ ìˆëŠ” í‹±ë“¤ì„ ìœ„í•œ cooling down ë¦¬ìŠ¤íŠ¸ì˜ ë‹¤ìŒ í•¨ìˆ˜
        // cooling down í‹± í•¨ìˆ˜ ë¦¬ìŠ¤íŠ¸ëŠ” ì—°ê²° ë¦¬ìŠ¤íŠ¸ í˜•íƒœì…ë‹ˆë‹¤.
        FTickFunction* Next;

        /** back pointer to the FTickTaskLevel containing this tick function if it is registered */
        // FTickFunction has similar relationship between AActor and ULevel:
        // - FTickFunction is contained in FTickTaskLevel

        // ì´ í‹± í•¨ìˆ˜ê°€ ë“±ë¡ëœ ê²½ìš° ì´ë¥¼ í¬í•¨í•˜ëŠ” FTickTaskLevelì— ëŒ€í•œ ì—­ í¬ì¸í„°
        // FTickFunctionì€ AActorì™€ ULevel ì‚¬ì´ì˜ ê´€ê³„ì™€ ìœ ì‚¬í•©ë‹ˆë‹¤:
        // - FTickFunctionì€ FTickTaskLevelì— í¬í•¨ë©ë‹ˆë‹¤.
        class FTickTaskLevel* TickTaskLevel;
    };

    /** lazily allocated struct that contains the necessary data for a tick function that is registered */
    // why does it separate data as InternalData?
    // - we can achieve the following benefits, splitting hot/cold data
    //   - memory optimization
    //   - performance optimization
    // - think how many tick functions exist: Actor & ActorComponent

    // ë“±ë¡ëœ í‹± í•¨ìˆ˜ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” ì§€ì—° í• ë‹¹ëœ êµ¬ì¡°ì²´
    // ì™œ ë°ì´í„°ë¥¼ InternalDataë¡œ ë¶„ë¦¬í–ˆì„ê¹Œìš”?
    // - ë‹¤ìŒê³¼ ê°™ì€ ì´ì ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤, í•«/ì½œë“œ ë°ì´í„° ë¶„ë¦¬:
    //   - ë©”ëª¨ë¦¬ ìµœì í™”
    //   - ì„±ëŠ¥ ìµœì í™”
    // - ì–¼ë§ˆë‚˜ ë§ì€ í‹± í•¨ìˆ˜ê°€ ì¡´ì¬í•˜ëŠ”ì§€ ìƒê°í•´ë³´ì„¸ìš”: Actor & ActorComponent
    TUniquePtr<FInternalData> InternalData;
};
```

```cpp
class FTickTaskLevel
{
    /** primary list of enabled tick functions */
    // í™œì„±í™”ëœ í‹± í•¨ìˆ˜ë“¤ì˜ ì£¼ìš” ëª©ë¡
    TSet<FTickFunction*> AllEnabledTickFunctions;

    /** primary list of enabled tick functions */
    // í™œì„±í™”ëœ í‹± í•¨ìˆ˜ë“¤ì˜ ì£¼ìš” ëª©ë¡
    // see FCoolingDownTickFunctionList
    // FCoolingDownTickFunctionList ì°¸ì¡°
    FCoolingDownTickFunctionList AllCoolingDownTickFunctions;

    /** primary list of disabled tick functions */
    // ë¹„í™œì„±í™”ëœ í‹± í•¨ìˆ˜ë“¤ì˜ ì£¼ìš” ëª©ë¡
    TSet<FTickFunction*> AllDisabledTickFunctions;

    /** utility array to avoid memory reallocation when collecting functions to reschedule */
    // ì¬ìŠ¤ì¼€ì¤„ë§í•  í•¨ìˆ˜ë“¤ì„ ìˆ˜ì§‘í•  ë•Œ ë©”ëª¨ë¦¬ ì¬í• ë‹¹ì„ í”¼í•˜ê¸° ìœ„í•œ ìœ í‹¸ë¦¬í‹° ë°°ì—´

    // FTickScheduleDetails is separate data for each tick-function to describe how it will be scheduled
    // FTickScheduleDetailsëŠ” ê° í‹± í•¨ìˆ˜ê°€ ì–´ë–»ê²Œ ìŠ¤ì¼€ì¤„ë§ë ì§€ ì„¤ëª…í•˜ëŠ” ë³„ë„ì˜ ë°ì´í„°ì…ë‹ˆë‹¤
    TArrayWithThreadsafeAdd<FTickScheduleDetails> TickFunctionsToReschedule;

    /** list of tick functions added during a tick phase; these items are also duplicated in AllLiveTickFunctions for future frames */
    // í‹± ë‹¨ê³„ ë™ì•ˆ ì¶”ê°€ëœ í‹± í•¨ìˆ˜ë“¤ì˜ ëª©ë¡; ì´ í•­ëª©ë“¤ì€ í–¥í›„ í”„ë ˆì„ì„ ìœ„í•´ AllLiveTickFunctionsì—ë„ ë³µì œë©ë‹ˆë‹¤
    TSet<FTickFunction*> NewlySpawnedTickFunctions;
    
    /** true during the tick phase, when true, tick function adds also go to the newly spawned list */
    // í‹± ë‹¨ê³„ ë™ì•ˆ trueì´ë©°, trueì¼ ë•Œ í‹± í•¨ìˆ˜ ì¶”ê°€ëŠ” ìƒˆë¡œ ìƒì„±ëœ ëª©ë¡ì—ë„ ì¶”ê°€ë©ë‹ˆë‹¤
    bool bTickNewlySpawned;

    // who is the owner of FTickTaskLevel to create/destroy?
    // FTickTaskLevelì„ ìƒì„±/íŒŒê´´í•˜ëŠ” ì†Œìœ ìëŠ” ëˆ„êµ¬ì¸ê°€ìš”?


    // from here we can know two things:
    // ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” ë‘ ê°€ì§€ë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
    // 1. FTickFunction -> FTickTaskLevel:
    //   - we can see the abstraction between Actor,ActorComponent and TickFunction
    //   - Actor, ActorComponentì™€ TickFunction ì‚¬ì´ì˜ ì¶”ìƒí™”ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤
    //   - Diagram:
    //   - ë‹¤ì´ì–´ê·¸ë¨:
    //          Levelâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºTickTaskLevel                                            
    //           â”‚                                      â”‚                                                       
    //           â”œâ”€â”€Actor0â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”œâ”€â”€TickFunction0                                        
    //           â”‚   â”‚                                  â”‚                                                       
    //           â”‚   â”œâ”€â”€ActorComponent0â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”œâ”€â”€TickFunction1                                        
    //           â”‚   â”‚                                  â”‚                                                       
    //           â”‚   â””â”€â”€ActorComponent1â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”œâ”€â”€TickFunction2                                        
    //           â”‚                                      â”‚                                                       
    //           â””â”€â”€Actor1â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”œâ”€â”€TickFunction3                                        
    //               â”‚                                  â”‚                                                       
    //               â””â”€â”€ActorComponent2â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â””â”€â”€TickFunction4                                        
    //
    // 2. FTickFunction cycle:
    // 2. FTickFunction ì£¼ê¸°:
    //   - Diagram: 
    //   - ë‹¤ì´ì–´ê·¸ë¨:
    //     see this diagram just try to understand general pattern of tick-function life-cycle                                                                                                                                                                                                             
    //     ì´ ë‹¤ì´ì–´ê·¸ë¨ì„ ë³´ê³  í‹± í•¨ìˆ˜ ìƒëª… ì£¼ê¸°ì˜ ì¼ë°˜ì ì¸ íŒ¨í„´ì„ ì´í•´í•´ ë³´ì„¸ìš”
    //        â”Œâ”€â”€TickFunction Cycleâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          
    //        â”‚                          frequency is NOT set                        â”‚                          
    //        â”‚                          ì£¼ê¸°ê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ                         â”‚                          
    //        â”‚                        â”Œâ”€â”€â”€â”                                         â”‚                          
    //        â”‚                        â”‚   â”‚                                         â”‚                          
    //        â”‚                        â”‚   â”‚                                         â”‚                          
    //        â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”´â”€â”€â”€â–¼â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                          
    //        â”‚    â”‚ Register â”œâ”€â”€â”€â”€â–º Enabled â”œâ”€â”€â”€â”€â–º CoolingDown â”œâ”€â”€â”€â”€â–º Disable â”‚     â”‚                          
    //        â”‚    â”‚  ë“±ë¡    â”‚    â”‚  í™œì„±í™”  â”‚    â”‚   ëƒ‰ê° ì¤‘   â”‚    â”‚ ë¹„í™œì„±í™”â”‚     â”‚                          
    //        â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â–²â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                          
    //        â”‚                        â”‚                 â”‚                           â”‚                          
    //        â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚                          
    //        â”‚                           frequency is set                           â”‚                          
    //        â”‚                           ì£¼ê¸°ê°€ ì„¤ì •ë¨                               â”‚                          
    //        â”‚                                                                      â”‚                          
    //        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          

};
```