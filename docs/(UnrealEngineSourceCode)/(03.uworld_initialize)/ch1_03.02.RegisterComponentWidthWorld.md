---
layout: default
title: "03-02. RegisterComponentWithWorld"
parent: "(03. CreateWorld::Initialize)"
grand_parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

```cpp
/** registers a component with a specific world, which creates any visual/physical state */
/** ì»´í¬ë„ŒíŠ¸ë¥¼ íŠ¹ì • ì›”ë“œì— ë“±ë¡í•˜ë©°, ì´ëŠ” ì‹œê°ì /ë¬¼ë¦¬ì  ìƒíƒœë¥¼ ìƒì„±í•©ë‹ˆë‹¤ */
void RegisterComponentWithWorld(UWorld* InWorld, FRegisterComponentContext* Context = nullptr)
{
    // if the component was already registered, do nothing
    // ì»´í¬ë„ŒíŠ¸ê°€ ì´ë¯¸ ë“±ë¡ë˜ì–´ ìˆë‹¤ë©´ ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
    if (IsRegistered())
    {
        return;
    }

    // it is natural to early-out cuz there is no world to register 
    // ë“±ë¡í•  ì›”ë“œê°€ ì—†ìœ¼ë¯€ë¡œ ì¼ì° ì¢…ë£Œí•˜ëŠ” ê²ƒì´ ìì—°ìŠ¤ëŸ½ìŠµë‹ˆë‹¤
    if (InWorld == nullptr)
    {
        return;
    }

    // if not registered, should not have a scene
    // it means that we can know whether it is registered or not by its existance of WorldPrivate
    // ë“±ë¡ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ì”¬ì„ ê°€ì§€ê³  ìˆì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤
    // ì´ëŠ” WorldPrivateì˜ ì¡´ì¬ ì—¬ë¶€ë¡œ ë“±ë¡ ì—¬ë¶€ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤
    check(WorldPrivate == nullptr);

    // UWorld::LineBatcher(ULineBatchComponent)'s owner is nullptr
    // UWorld::LineBatcher(ULineBatchComponent)ì˜ ì†Œìœ ìëŠ” nullptrì…ë‹ˆë‹¤
    AActor* MyOwner = GetOwner();
    check(MyOwner == nullptr || MyOwner->OwnsComponent(this));

    if (!HasBeenCreated)
    {
        // do you remember OnComponentCreated() event covered in AActor?
        // - it is called when ActorComponent is being created
        // AActorì—ì„œ ë‹¤ë£¬ OnComponentCreated() ì´ë²¤íŠ¸ë¥¼ ê¸°ì–µí•˜ì‹œë‚˜ìš”?
        // - ì´ëŠ” ActorComponentê°€ ìƒì„±ë  ë•Œ í˜¸ì¶œë©ë‹ˆë‹¤
        OnComponentCreated();
    }

    WorldPrivate = InWorld;

    // see ExectueRegisterEvents (goto 40)
    // ExecuteRegisterEvents ì°¸ì¡° (40ë²ˆìœ¼ë¡œ ì´ë™)
    ExecuteRegisterEvents(Context);

    // if not in a game world register ticks now, otherwise defer until BeginPlay
    // if no owner we won't trigger BeginPlay() either so register now in that case as well
    // ê²Œì„ ì›”ë“œê°€ ì•„ë‹ˆë¼ë©´ ì§€ê¸ˆ í‹±ì„ ë“±ë¡í•˜ê³ , ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ BeginPlayê¹Œì§€ ì—°ê¸°í•©ë‹ˆë‹¤
    // ì†Œìœ ìê°€ ì—†ë‹¤ë©´ BeginPlay()ë„ íŠ¸ë¦¬ê±°í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì´ ê²½ìš°ì—ë„ ì§€ê¸ˆ ë“±ë¡í•©ë‹ˆë‹¤
    if (!InWorld->IsGameWorld())
    {
        // 
        // - if the world is not game world, we didn't call InitializeComponent()
        //   - see the condition below (MyOwner == nullptr) 
        // - we are debugging with PIE, so we are not in here
        //   - the PIE returns true on IsGameWorld()
        // 
        // - ì›”ë“œê°€ ê²Œì„ ì›”ë“œê°€ ì•„ë‹ˆë¼ë©´, InitializeComponent()ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤
        //   - ì•„ë˜ì˜ ì¡°ê±´ì„ ë³´ì„¸ìš” (MyOwner == nullptr)
        // - ìš°ë¦¬ëŠ” PIEë¡œ ë””ë²„ê¹… ì¤‘ì´ë¯€ë¡œ, ì—¬ê¸°ì— í•´ë‹¹í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
        //   - PIEëŠ” IsGameWorld()ì—ì„œ trueë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤
        RegisterAllComponentTickFunctions(true);
    }
    else if (MyOwner == nullptr)
    {
        // here is the InitializeComponent() call which we covered in AActor's initialization stages
        // ì—¬ê¸°ì„œ InitializeComponent()ë¥¼ í˜¸ì¶œí•˜ëŠ”ë°, ì´ëŠ” AActorì˜ ì´ˆê¸°í™” ë‹¨ê³„ì—ì„œ ë‹¤ë£¨ì—ˆìŠµë‹ˆë‹¤
        if (!bHasBeenInitialized && bWantsInitializeComponent)
        {
            InitializeComponent();
        }

        RegisterAllComponentTickFunctions(true);
    }
    else
    {
        // ë³´í†µì—¬ê¸°ë¡œ íƒ‘ë‹ˆë‹¤.
        MyOwner->HandleRegisterComponentWithWorld(this);
    }

    // if this is a blueprint created component and it has component children they can miss getting registered in some scenarios
    // ì´ê²ƒì´ ë¸”ë£¨í”„ë¦°íŠ¸ë¡œ ìƒì„±ëœ ì»´í¬ë„ŒíŠ¸ì´ê³  ìì‹ ì»´í¬ë„ŒíŠ¸ê°€ ìˆë‹¤ë©´, ì¼ë¶€ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ë“±ë¡ì´ ëˆ„ë½ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤
    if (IsCreatedByConstructionScript())
    {
        // explain what is SCS(Simple Construction Script) and CCS(Custom Construction Script) with examples (or with editor)
        // - Children will be collected from SCS and CCS, and they have outer object as this UActorComponent
        // SCS(Simple Construction Script)ì™€ CCS(Custom Construction Script)ê°€ ë¬´ì—‡ì¸ì§€ ì˜ˆì œ(ë˜ëŠ” ì—ë””í„°)ë¡œ ì„¤ëª…í•˜ì„¸ìš”
        // - ìì‹ë“¤ì€ SCSì™€ CCSì—ì„œ ìˆ˜ì§‘ë˜ë©°, ì´ UActorComponentë¥¼ ì™¸ë¶€ ê°ì²´ë¡œ ê°€ì§‘ë‹ˆë‹¤
        TArray<UObject*> Children;
        GetObjectsWithOuter(this, Children, true, RF_NoFlags, EInternalObjectFlags::Garbage);

        // iterating Children, and try to RegisterComponentWithWorld (recursive calls)
        // Childrenì„ ìˆœíšŒí•˜ë©° RegisterComponentWithWorldë¥¼ ì‹œë„í•©ë‹ˆë‹¤ (ì¬ê·€ í˜¸ì¶œ)
        for (UObject* Child : Children)
        {
            if (UActorComponent* ChildComponent = Cast<UActorComponent>(Child))
            {
                // when RegisterComponentWithWorld is called, bRegister will be true
                // RegisterComponentWithWorldê°€ í˜¸ì¶œë˜ë©´ bRegisterê°€ trueê°€ ë©ë‹ˆë‹¤
                if (ChildComponent->bAutoRegister && !ChildComponent->IsRegistered() && ChildComponent->GetOwner() == MyOwner)
                {
                    // maybe some ActorComponents from SCS or CCS not registered yet, if so, register components
                    // SCSë‚˜ CCSì—ì„œ ì˜¨ ì¼ë¶€ ActorComponentê°€ ì•„ì§ ë“±ë¡ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ê·¸ë ‡ë‹¤ë©´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤
                    ChildComponent->RegisterComponentWithWorld(InWorld);
                }
            }
        }
    }
}
```