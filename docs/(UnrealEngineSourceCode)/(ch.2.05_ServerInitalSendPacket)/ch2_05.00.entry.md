---
layout: default
title: "([Network] 05. ServerInitalSendPacket)"
parent: "(UE SourceCode ë¶„ì„ ðŸ¤–)"
has_children: true
nav_order: 3
---

* ì—­ì‹œ Engine Tickì—ì„œ ë¶€í„° ì‹œìž‘ëœë‹¤.

```cpp
virtual void Tick(float DeltaSeconds, bool bIdleMode) override
{
    // ...
    
    for (FWorldContext* PieContextPtr : LocalPieContextPtrs)
    {
        // ...

        for (; PieContext.PIEAccumulatedTickSeconds >= TickDeltaSeconds; PieContext.PIEAccumulatedTickSeconds -= TickDeltaSeconds)
        {
            TickWorldTravel(PieContext, TickDeltaSeconds);

            // - we are looking into the server-side code, which is why we look into UWorld::Tick
            // - and also, we are interested in receiving packets sending from client as handshake packet

            // - ìš°ë¦¬ëŠ” ì„œë²„ ì¸¡ ì½”ë“œë¥¼ ì‚´íŽ´ë³´ê³  ìžˆìŠµë‹ˆë‹¤. ê·¸ëž˜ì„œ UWorld::Tickì„ ì‚´íŽ´ë³´ëŠ” ê²ƒìž…ë‹ˆë‹¤
            // - ë˜í•œ ìš°ë¦¬ëŠ” í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° í•¸ë“œì…°ì´í¬ íŒ¨í‚·ìœ¼ë¡œ ë³´ë‚´ëŠ” íŒ¨í‚·ì„ ìˆ˜ì‹ í•˜ëŠ” ê²ƒì— ê´€ì‹¬ì´ ìžˆìŠµë‹ˆë‹¤
            {
                PieContext.World()->Tick(LEVELTICK_All, TickDeltaSeconds);
            }
        }
    }
}
```

```cpp
void Tick(ELevelTick TickType, float DeltaSeconds)
{
    FWorldDelegates::OnWorldTickStart.Broadcast(this, TickType, DeltaSeconds);

    // [ServerInitialSendPacket]
    // almost at the beginning of UWorld::Tick, we can find BroadcastTickDispatch()
    // - see BroadcastTickDispatch briefly
    //   - do you remember UNetDriver::RegisterTickEvents()?
    //   - we already register delegate to 'TickDispatchEvent' as UNetDriver::InternalTickDispatch

    /*
UWorld::Tick í•¨ìˆ˜ì˜ ì´ˆë°˜ë¶€ì—ì„œ BroadcastTickDispatch() í˜¸ì¶œì„ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
ì´ëŠ” ë„¤íŠ¸ì›Œí‚¹ê³¼ ê´€ë ¨ëœ ì¤‘ìš”í•œ ë¶€ë¶„ìž…ë‹ˆë‹¤.

BroadcastTickDispatch()ë¥¼ ê°„ë‹¨ížˆ ì‚´íŽ´ë³´ë©´:
    UNetDriver::RegisterTickEvents()ë¥¼ í†µí•´ ì´ë¯¸ 'TickDispatchEvent'ì— UNetDriver::InternalTickDispatchë¥¼ ë¸ë¦¬ê²Œì´íŠ¸ë¡œ ë“±ë¡í–ˆìŒì„ ê¸°ì–µí•˜ì‹¤ ê²ë‹ˆë‹¤.
    ë”°ë¼ì„œ BroadcastTickDispatch() í˜¸ì¶œì€ ê²°êµ­ UNetDriver::InternalTickDispatch í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.

    ì´ì œ UNetDriver::InternalTickDispatch í•¨ìˆ˜ë¡œ ì´ë™í•˜ì—¬ ìžì„¸í•œ ë‚´ìš©ì„ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤ 
    ë„¤íŠ¸ì›Œí‚¹ ê´€ë ¨ ë¡œì§ì´ Tickì˜ ì´ˆê¸°ì— ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
    ì´ëŠ” ë„¤íŠ¸ì›Œí¬ íŒ¨í‚· ì²˜ë¦¬ê°€ í”„ë ˆìž„ì˜ ë‹¤ë¥¸ ìž‘ì—…ë“¤ë³´ë‹¤ ìš°ì„ ì ìœ¼ë¡œ ì´ë£¨ì–´ì§ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
    */
```

```cpp
// (ì°¸ê³ )
void RegisterTickEvents(class UWorld* InWorld)
{
    if (InWorld)
    {
        TickDispatchDelegateHandle = InWorld->OnTickDispatch().AddUObject(this, &UNetDriver::InternalTickDispatch);
```

```cpp
class UNetDriver : public UObject, public FExec
{
public:
    void InternalTickDispatch(float DeltaSeconds)
    {
        TickDispatch(DeltaSeconds);
    }
```