---
layout: default
title: "([Network] 09. ServerChallengeControlMessage)"
parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
has_children: true
nav_order: 3
---

* NMT_ChallengeëŠ” ì–¸ë¦¬ì–¼ ì—”ì§„ì˜ ë„¤íŠ¸ì›Œí¬ í•¸ë“œì…°ì´í¬ ê³¼ì •ì—ì„œ ì¤‘ìš”í•œ ì—­í• ì„ í•˜ëŠ” ì»¨íŠ¸ë¡¤ ë©”ì‹œì§€ì…ë‹ˆë‹¤.

* ë°œìƒ ì‹œì 
    * í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— NMT_Hello ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë©´
    * ì„œë²„ëŠ” ì´ë¥¼ ê²€ì¦í•œ í›„ NMT_Challenge ë©”ì‹œì§€ë¡œ ì‘ë‹µí•©ë‹ˆë‹¤
* ëª©ì 
    * í´ë¼ì´ì–¸íŠ¸ì˜ ì •ë‹¹ì„±ì„ í™•ì¸í•˜ê¸° ìœ„í•œ ë³´ì•ˆ ë©”ì»¤ë‹ˆì¦˜
    * ë¬´ì‘ìœ„ë¡œ ìƒì„±ëœ ì±Œë¦°ì§€ ê°’ì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡
    * í´ë¼ì´ì–¸íŠ¸ëŠ” ì´ ì±Œë¦°ì§€ ê°’ì„ ì´ìš©í•´ ì‘ë‹µì„ ìƒì„±í•´ì•¼ í•¨

*  ì¦‰, ì„œë²„ì—ì„œ NMT_Hello ì‘ë‹µìœ¼ë¡œ ë³´ë‚¼ NMT_Challenge (Challenge(ëœë¤ê°’))ì„ ì–´ë–»ê²Œ ë³´ë‚´ëŠ”ì§€ 

---

* ìš°ì„ , íŒ¨í‚·ì€ ìˆ˜ì‹ ë˜ì—ˆë‹¤ê³  ê°€ì •í•œë‹¤.

```cpp
/** allows the connection to process the raw data that was received */
/** ìˆ˜ì‹ ëœ ì›ì‹œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤ */

// ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° íŒ¨í‚·ì„ ìˆ˜ì‹ í•©ë‹ˆë‹¤
// - ì´ ê²½ìš°ì—ëŠ” ControlChannelë¡œë¶€í„° NMT_Helloë¥¼ ë””ìŠ¤íŒ¨ì¹˜í•  ê²ƒì…ë‹ˆë‹¤

virtual void ReceivedRawPacket(void* Data, int32 Count)
{
    uint8* Data = (uint8*)InData;

    if (Handler.IsValid())
    {
        FReceivedPacketView PacketView;
        PacketView.DataView = {Data, Count, ECountUnits::Bytes};

        // PacketHandler::Outgoing(StatelessConnectHandlerComponent::Outgoing)ë¥¼ í˜¸ì¶œí•˜ì—¬ ì¶”ê°€ ë°ì´í„°ë¥¼ ì§ë ¬í™”í–ˆë˜ ê²ƒì„ ê¸°ì–µí•˜ì‹œë‚˜ìš”?
        // - ì´í›„ì— íŒ¨í‚·ì„ ì˜¬ë°”ë¥´ê²Œ ì½ê¸° ìœ„í•´ ì´ëŸ¬í•œ ë°ì´í„° ë¹„íŠ¸ë“¤ì„ ì†Œë¹„í•´ì•¼ í•©ë‹ˆë‹¤:
        //   *** StatelessConnectHandlerComponent::Outgoingì„ ê°„ë‹¨íˆ ì‚´í´ë³´ì„¸ìš”
        //
        //          NewPacket                                     PacketHandler's data                                                                        
        //           â”‚                                              â”‚                                                                                         
        //           â”œâ”€MagicHeader(0)                               â”‚            send-buffer data                                                             
        //           â”‚                                              â”‚               â”‚                                                                         
        //           â”œâ”€SessionClientId(2)                      â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       
        //           â”‚                                 â”€â”€â”€â”€â”€â”€â–º â”‚    â–¼    â”‚          â–¼                 â”‚                                                       
        //           â”œâ”€ClientID(3)                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       
        //           â”‚                                         â–²   â–²     â–²                                                                                    
        //           â”œâ”€bHandshakePacket(1): false              â”‚   â”‚     â”‚                                                                                    
        //           â”‚                                        (1) (2)   (...)                                                                                 
        //           â””â”€send-buffer data                                                                                                                       
        //             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                                                                                    
        //              ***                                      *** ë²ˆì¹˜ ë°ì´í„°ë¥¼ ì½ê¸° ì „ì— ë¹„íŠ¸ ì§ë ¬í™”(ì½ê¸°)ë¥¼ í†µí•´ ì»¤ì„œë¥¼ ì ì ˆíˆ ì´ë™ì‹œì¼œì•¼ í•©ë‹ˆë‹¤! 


        EIncomingResult IncomingResult = Handler->Incoming(PacketView);
```

```cpp
class FNetPacketNotify
{
public:
    enum { SequenceNumberBits = 14 };
    enum { MaxSequenceHistoryLength = 256 };

    typedef TSequenceNumber<SequenceNumberBits, uint16> SequenceNumberT;
    typedef TSequenceHistory<MaxSequenceHistoryLength> SequenceHistoryT;

    // ì†ì„±ë“¤ì„ ì„œë²„ ê´€ì ì—ì„œ í•˜ë‚˜ì”© ë¶„ì„í•´ë´…ì‹œë‹¤
    // - Seq: í´ë¼ì´ì–¸íŠ¸ ì¸¡ì˜ OutSeq
    // - AckedSeq: í´ë¼ì´ì–¸íŠ¸ ì¸¡ì˜ InAckSeq(ì—¬ê¸°ì„œ 'In'ì€ server -> clientë¥¼ ì˜ë¯¸)
    // - History: InAckSeq ì´í›„ì˜ íŒ¨í‚· ì „ë‹¬ ì´ë ¥
    //   - HistoryëŠ” InAckSeqAckë¥¼ ê³„ì‚°í•˜ëŠ”ë° ì‚¬ìš©ë©ë‹ˆë‹¤!
    //
    //     ***FNetPacketNotify::FNotificationHeader                                       
    //        â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       
    //            â”‚                                                                       
    //            â”œâ”€â”€AckedSeq: InAckSeq(client): 1024                                     
    //            â”‚                                                                       
    //            â””â”€â”€History:      â”Œâ”€â”€â”€bit-0ëŠ” ê°€ì¥ ìµœê·¼ì˜ ì „ë‹¬ ìƒíƒœë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤(ìµœì‹ )!       
    //               â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â–¼â”€â”                                                    
    //               â”‚ 1 â”‚ 1 â”‚ 0 â”‚ 0 â”‚                                                    
    //               â””â”€â–²â”€â”´â”€â–²â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜                                                    
    //                 â”‚   â”‚                                                              
    //                 â”‚  ***1024ê°€ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì„±ê³µì ìœ¼ë¡œ í™•ì¸ë¨                    
    //                 â”‚                                                                  
    //                 â”‚                                                                  
    //           ***1023ì´ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì„±ê³µì ìœ¼ë¡œ í™•ì¸ë¨                             
    //               â”‚                                                                    
    //               â””â”€InAckSeq(client) == OutSeq(server)                                 
    //                 : íŒ¨í‚· ID(1023)ê°€ ì„œë²„ì—ì„œ ì „ì†¡ë˜ì–´ í´ë¼ì´ì–¸íŠ¸ê°€ ìˆ˜ì‹ í•¨         
    //                                                                                 
    struct FNotificationHeader
    {
        SequenceHistoryT History;
        SIZE_T HisotryWordCount;
        SequenceNumberT Seq;
        SequenceNumberT AckedSeq;
    }
```