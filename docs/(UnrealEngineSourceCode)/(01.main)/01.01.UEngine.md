---
layout: default
title: "01. UEngine"
parent: "(01.Unrealì˜ Main! ë¶„ì„)"
grand_parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

## UEngine

```cpp
class UEngine : public UObject, public FExec
{
    FWorldContext& CreateNewWorldContext(EWorldType::Type WorldType)
    {
        FWorldContext* NewWorldContext = new FWorldContext;
        WorldList.Add(NewWorldContext);
        NewWorldContext->WorldType = WorldType;
        NewWorldContext->ContextHandle = FName(*FString::Printf(TEXT("Context_%d"), NextWorldContextHandle++));
        return *NewWorldContext;
    }

    virtual void Init(IEngineLoop* InEngineLoop)
    {
        if (GIsEditor)
        {
            FWorldConext& InitialWorldContext = CreateNewWorldContext(EWorldType::Editor);

            InitialWorldContext.SetCurrentWorld(UWorld::CreateWorld(EWorldType::Editor, true));
            GWorld = InitialWorldContext.World();
        }
    }

    // FWorldContextë¥¼ UEngineì—ì„œ í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.
    TIndirectArray<FWorldContext> WorldList;
    int32 NextWorldContextHandle;
};
```

---

## FWorldContext

* ìš°ì„  ë“¤ì–´ê°€ê¸° ì „ **Context**ë¼ëŠ” ìš©ì–´ì— ëŒ€í•´ ì•Œê³ ê°€ì
* **Context**
    * ì£¼ë¡œ íŠ¹ì • ì‘ì—…ì´ ìˆ˜í–‰ë˜ëŠ” í™˜ê²½ì´ë‚˜ ìƒí™©ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. 
    * ì´ëŠ” ì–´ë–¤ ë°ì´í„°ë‚˜ ê¸°ëŠ¥ì´ íŠ¹ì •í•œ ì‹œì ì—ì„œ ì–´ë–»ê²Œ ì ‘ê·¼ë˜ê³  ì‚¬ìš©ë˜ì–´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•œ ë§¥ë½ì„ í¬í•¨í•©ë‹ˆë‹¤.
    * **ì •ë¦¬** ë³´í†µ ì´ë ‡ê²Œ ì„¤ëª…í•˜ì§€ë§Œ... ë‘ UObjectê°„ì˜ Defendencyë¥¼ ëŠê¸°ìœ„í•´ì„œ ë§ì´ ì‚¬ìš©ëœë‹¤. ëŒ€í‘œì  ì˜ˆê°€ `FWorldContext`ì´ê³  UWorldì™€ UEngineì˜ Defendencyë¥¼ ëŠì„ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

```cpp
struct FWorldContext
{
    void SetCurrentWorld(UWorld* World)
    {
        UWorld* OldWorld = ThisCurrentWorld;
        ThisCurrentWorld = World;

        if (OwningGameInstance)
        {
            OwningGameInstance->OnWorldChanged(OldWorld, ThisCurrentWorld);
        }
    }

    TEnumAsByte<EWorldType::Type> WorldType;
    
    FName ContextHandle;

    TObjectPtr<class UGameInstance> OwningGameInstance;

    TObjectPtr<UWorld> ThisCurrentWorld;
};
```