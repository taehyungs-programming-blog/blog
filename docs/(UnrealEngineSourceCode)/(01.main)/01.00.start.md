---
layout: default
title: "(01.Unrealì˜ Main! ë¶„ì„)"
parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
has_children: true
nav_order: 1
---

* ì‹œì‘ì´ ë°˜ ì´ë‹¤! 
* ìš°ì„ ì€ ì•„ë˜ì™€ ê°™ì´ Mainì´ ëŒ€ëµëŒì•„ê°„ë‹¤ë§Œ ì´í•´í•˜ì.

```cpp
// Launch.h

int32 WinMain(_In_ HINSTANCE hInInstance, _In_opt_ HINSTANCE hPrevInstance, _In_ char* pCmdLine, _In_ int32 nCmdShow)
{
    int32 Result = LaunchWindowsStartup(hInInstance, hPrevInstance, pCmdLine, nCmdShow, nullptr);
    LaunchWindowsShutdown();

    /*
    void LaunchWindowsShutdown()
    {
        FEngineLoop::AppExit();
    }
    */
    return Result;
}
```

```cpp
int32 LaunchWindowsStartup(HINSTANCE hInInstance, HINSTANCE hPrevInstance, char*, int32 nCmdShow, const TCHAR* CmdLine)
{
    int32 ErrorLevel = 0;

    if (!CmdLine)
    {
        CmdLine = GetCommandLineW();
        if (ProcessCommandLine())
        {
            CmdLine = *GSavedCommandLine;
        }
    }

    {
        // ì´ëŸ° íŒ¨í„´ì„ SEH (structured exception handling) ë¼ê³  í•œë‹¤.
        __try
        {
            GIsGuarded = 1;
            // SEHë¡œ ê°ì‹¸ì ¸ ìˆê¸°ì— GuardedMainì´ë¼ í•œë‹¤.
            ErrorLevel = GuardedMainWrapper(CmdLine);
            GIsGuarded = 0;
        }
        __except(FPlatformMisc::GetCrashHandlingType == ECrashHandlingType::Default
            ? ReportCrash(GetExceptionInformation())
			: EXCEPTION_CONTINUE_SEARCH)
        {
            ErrorLevel = 1;
            FPlatformMisc::RequestExit(true);
        }
    }

    return ErrorLevel;
}
```

```cpp
int32 GuardedMainWrapper(const TCHAR* CmdLine)
{
    int32 ErrorLevel = 0;
    ErrorLevel = GuardMain(CmdLine);
    return ErrorLevel;
}
```

```cpp
int32 GuardMain(const TCHAR* CmdLine)
{
    //...

#if !(UE_BUILD_SHIPPING)
    // -waitforattach ë¥¼ ë¶™ì´ë©´ ë””ë²„ê±°ê°€ ë¶™ì„ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì¤€ë‹¤.
    if (FParse::Param(CmdLine, TEXT("waitforattach")))
    {
        while (!FPlatformMisc::IsDebuggerPresent())
        {
            FPlatformProcess::Sleep(0.1f);
        }

        // ë””ë²„ê±°ê°€ ë¶™ì–´ìˆëŠ” ê²½ìš° ì—¬ê¸°ì„œ ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ê°€ ì¡íŒë‹¤.
        UE_DEBUG_BREAK();
    }
#endif

    FCoreDelegates::GetPreMainInitDelegate().Broadcast();

    struct EngineLoopCleanupGuard
    {
        ~EngineLoopCleanupGuard()
        {
            EngineExit();
        }
    } CleanupGuard;

    // Init
    int32 ErrorLevel = EnginePreInit(CmdLine);

    {
#if WITH_EDITOR || 1
        if (GIsEditor)
        {
            // Editor Init
            ErrorLevel = EditorInit(GEngineLoop);
        }
        else
#endif
        {
            ErrorLevel = EngineInit();
        }
    }

    double EngineInitializationTime = FPlatformTime::Seconds() - GStartTime;

    while (!IsEngineExitRequested())
    {
        // Tick
        EngineTick();
    }

#if WITH_EDITOR || 1
    if (GIsEditor)
    {
        EditorExit();
    }
#endif

    return ErrorLevel;
}
```

## SEH (structured exception handling) 

* SEH(Structured Exception Handling)ëŠ” Microsoft Windowsì—ì„œ C++ í”„ë¡œê·¸ë¨ì˜ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. 
    * SEHë¥¼ ì‚¬ìš©í•˜ë©´ í”„ë¡œê·¸ë¨ì—ì„œ ì˜ˆìƒì¹˜ ëª»í•œ ìƒí™©ì´ ë°œìƒí–ˆì„ ë•Œ, ì´ë¥¼ ê°ì§€í•˜ê³  ì²˜ë¦¬í•˜ëŠ” êµ¬ì¡°í™”ëœ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤. 
    * ì´ëŠ” ìš´ì˜ì²´ì œ ìˆ˜ì¤€ì—ì„œ ì§€ì›ë˜ë©°, í•˜ë“œì›¨ì–´ ì˜ˆì™¸(ì˜ˆ: ì ‘ê·¼ ìœ„ë°˜, 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë“±) ë° ì†Œí”„íŠ¸ì›¨ì–´ ì˜ˆì™¸ ëª¨ë‘ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (`try ~ catch`ëŠ” ìš´ì˜ì²´ì œ ê¸°ë°˜ì œê³µì´ë‹¤.)

* SEHì˜ ì£¼ìš” ê°œë…
    * ì˜ˆì™¸ í•„í„°(exception filter): ì˜ˆì™¸ê°€ ë°œìƒí–ˆì„ ë•Œ í•´ë‹¹ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•  ê²ƒì¸ì§€ ê²°ì •í•˜ëŠ” ì‚¬ìš©ì ì •ì˜ ì½”ë“œì…ë‹ˆë‹¤. ì˜ˆì™¸ í•„í„°ëŠ” ì˜ˆì™¸ê°€ ë°œìƒí•œ í›„ ì ì ˆí•œ ì²˜ë¦¬ê¸°(handler)ë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì— í˜¸ì¶œë©ë‹ˆë‹¤.
    * ì˜ˆì™¸ ì²˜ë¦¬ê¸°(exception handler): ì˜ˆì™¸ í•„í„°ë¥¼ í†µê³¼í•œ ì˜ˆì™¸ë¥¼ ì‹¤ì œë¡œ ì²˜ë¦¬í•˜ëŠ” ì½”ë“œ ë¸”ë¡ì…ë‹ˆë‹¤. ì˜ˆì™¸ ì²˜ë¦¬ê¸°ëŠ” ì˜ˆì™¸ ìƒí™©ì„ ë³µêµ¬í•˜ê±°ë‚˜ ì¶”ê°€ ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* SEH ì‘ë™ ë°©ì‹
    * ì˜ˆì™¸ ë°œìƒ: í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì¤‘ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì‹œìŠ¤í…œì€ ë“±ë¡ëœ ì˜ˆì™¸ í•„í„°ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
    * ì˜ˆì™¸ í•„í„° í˜¸ì¶œ: ë“±ë¡ëœ ì˜ˆì™¸ í•„í„°ê°€ ìˆë‹¤ë©´ ì´ë¥¼ í˜¸ì¶œí•˜ì—¬ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í• ì§€ ì—¬ë¶€ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. ì˜ˆì™¸ í•„í„°ëŠ” ì˜ˆì™¸ë¥¼ ë¬´ì‹œí•˜ê³  ê³„ì† ì‹¤í–‰í•˜ê±°ë‚˜, ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì˜ˆì™¸ ì²˜ë¦¬ê¸°ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    * ì˜ˆì™¸ ì²˜ë¦¬: ì˜ˆì™¸ í•„í„°ê°€ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ê²°ì •í•˜ë©´, ì—°ê²°ëœ ì˜ˆì™¸ ì²˜ë¦¬ê¸°ê°€ í˜¸ì¶œë˜ì–´ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì²˜ë¦¬ê°€ ì™„ë£Œë˜ë©´ í”„ë¡œê·¸ë¨ì€ ë³´í†µ ì‹¤í–‰ì„ ê³„ì†í•˜ê±°ë‚˜, ì˜ˆì™¸ì— ë”°ë¼ ì¢…ë£Œë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
* SEHì˜ íŠ¹ì§•ê³¼ ì‚¬ìš©
    * í”Œë«í¼ ì¢…ì†ì„±: SEHëŠ” Windows ìš´ì˜ì²´ì œì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Microsoftì˜ í™•ì¥ ê¸°ëŠ¥ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ë‹¤ë¥¸ ìš´ì˜ì²´ì œì—ì„œëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
    * ë³µì¡ì„±ê³¼ ì„±ëŠ¥: SEHëŠ” ë¹„êµì  ë³µì¡í•˜ê³  ì„±ëŠ¥ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆì§€ë§Œ, ì˜ˆì™¸ ìƒí™©ì„ ìƒì„¸í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ìœ ì—°ì„±ì„ ì œê³µí•©ë‹ˆë‹¤.