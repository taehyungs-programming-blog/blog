---
layout: default
title: "04-01. TickGroupê³¼ Physicsì˜ ê´€ê³„"
parent: "(04. TickTaskManager)"
grand_parent: "(UE SourceCode ë¶„ì„ ğŸ¤–)"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

```cpp
/** determines which ticking group a tick function belongs to */
// you can think of TickingGroup as join point (or sync point) in task graph:
// - see the diagram below:
//                                                                                                                                                                                                          
//                                 â”Œâ”€â”€â”€TickFunction0â—„â”€â”€â”€â”€TickFunction2â—„â”€â”€â”€â”€â”                                                                                                                                
//                                 â”‚                                       â”‚                                                                                                                                
//            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                                       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                
//            â”‚ TG_PrePhysics â—„â”€â”€â”€â”€â”¼â”€â”€â”€TickFunction1â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ TG_StartPhysics â”‚â—„â”€â”€â”¬â”€â”€â”€TickFunction6â—„â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ TG_EndPhysics â”‚                                                
//            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                                       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                        â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                
//                                 â”‚                                       â”‚                          â”‚                        â”‚                                                                            
//                                 â”œâ”€â”€â”€TickFunction3â—„â”€â”                    â”‚                          â””â”€â”€â”€TickFunction7 â—„â”€â”€â”€â”€â”€â”€â”˜                                                                            
//                                 â”‚                  â”‚                    â”‚                                                                                                                                
//                                 â”‚                  â”œâ”€â”€TickFunction4 â—„â”€â”€â”€â”˜                                                                                                                                
//                                 â”‚                  â”‚                                                                                                                                                     
//                                 â””â”€â”€â”€TickFunction5â—„â”€â”˜      
// - try to understand above diagram as conceptual figure!    
```

* ëŒ€ëµ Tickì´ í˜¸ì¶œë  ì‹œ Jointì˜ `TG_StartPhysics`ê°€ í˜¸ì¶œë˜ë©° ë‚´ë¶€ì˜ TickFuncê°€ í˜¸ì¶œëœë‹¤ê³  ì´í•´í•˜ì
* ì´ ìˆœì„œì²˜ë¦¬ë¥¼ ì–´ë–»ê²Œ í• ê¹Œ?

```cpp
/** class that aggregates the individual levels and deals with parallel tick setup */
// from the comment, we can see parallel tick setup is supported, but for us, we are focusing on single-threaded version
// - what is tick setup?
//   - the tick setup is to prepare tick functions in TickTaskLevels(ULevels in UWorld) to be ticked

// ë ˆë²¨ ë³„ë¡œ í‹±ì— ëŒ€í•œ ìŠ¤ì¼€ì¤„ë§ì„ ë‹´ë‹¹í•˜ëŠ” í´ë˜ìŠ¤ ì…ë‹ˆë‹¤
class FTickTaskManager : public FTickTaskManagerInterface
{
    // ...

    /** global sequencer */
    // what is TickTaskSequencer?
    // - Can think of it as ***tick function scheduler***
    // ì‹¤ì œ í‹± ì‘ì—…ê³¼ í‹± ê·¸ë£¹ ì‹œì‘ ë° ì™„ë£Œë¥¼ ì²˜ë¦¬í•˜ëŠ” í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.
    FTickTaskSequencer& TickTaskSequencer;
}
```

```cpp
/** class that handles the actual tick tasks and starting and completing tick groups */
// TickTaskSequencer manages TaskGraph's event handle of tick function for all tick groups
// - It make sure all tick groups are joined properly
class FTickTaskSequencer
{
    /** completion handles for each phase of ticks */
    // we are NOT covering TaskGraph in engine code:
    // - but, we need to understand FGraphEventRef
    // - FGraphEventRef is similar to Future object in Async/Await
    //   - FGraphEventRef is used to check whether task is finished or not
    //   - FGraphEventRef is used to wait until its task is finished
    // - as we saw previous figure, TickCompletionEvents has all graph-events for all tick functions in each tick-group

    // ì‘ì—…ì˜ ì™„ë£Œ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê±°ë‚˜ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ”ë° ì‚¬ìš©í•©ë‹ˆë‹¤.
    // C#ì˜ Async / Awaitì—ì„œ ì‚¬ìš©í•˜ëŠ” Taskì™€ ìœ ì‚¬í•©ë‹ˆë‹¤
    TArrayWithThreadsafeAdd<FGraphEventRef, TInlineAllocator<4>> TickCompletionEvents[TG_MAX];

    //  we are not covering TGraphTask, FGraphEventRef and FTaskGraph in unreal for now

    // - what is meaning for Pre -> End (two tick-groups)?
    //   - the tick function can be run in two tick groups (pre + start)                                                                                               
    // ETickGroupì˜ ì¢…ë¥˜ ë³„ë¡œ ë“±ë¡í•˜ì—¬ Tickì— ëŒ€í•œ ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•œ ë³€ìˆ˜ ì…ë‹ˆë‹¤.
    TArrayWithThreadsafeAdd<TGraphTask<FTickFunctionTask>*> HiPriTickTasks[TG_MAX][TG_MAX];

    /** LowPri Held tasks for each tick group. */
    TArrayWithThreadsafeAdd<TGraphTask<FTickFunctionTask>*> TickTasks[TG_MAX][TG_MAX];
}
```

```cpp
//   - try to understand with the Diagram:
//     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                   
//     â”‚  Start\End        â”‚    TG_PrePhysics    â”‚    TG_StartPhysics     â”‚     TG_EndPhysics  â”‚                                                                                                   
//     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                                                                   
//     â”‚  TG_PrePhysics    â”‚    Pre -> Pre       â”‚    Pre -> Start        â”‚    Pre->End        â”‚                                                                                                   
//     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                                                                   
//     â”‚  TG_StartPhysics  â”‚    Invalid          â”‚    Start -> Start      â”‚    Start->End      â”‚                                                                                                   
//     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                                                                   
//     â”‚  TG_EndPhysics    â”‚    Invalid          â”‚    Invalid             â”‚    End -> End      â”‚                                                                                                   
//     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    
```

* ë§Œì•½ì— PrePhysicsì´ê³  ëì§€ì ì„ EndPhysicsë¥¼ ë“±ë¡í•œë‹¤ë©´ Pre->Endë¡œ ì§„í–‰ë˜ëŠ” ê²ƒì„ ê·¸ë¦¼ì„ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ì£¼ì˜í• ì ì€ ì‹œì‘ì§€ì ì´ StartPhysicsì¸ë° ëì§€ì ì´ PrePhysicsë¼ë©´ ì‹œê°„ì˜ íë¦„ì´ ë’¤ë¡œ ì—­í–‰í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
* Invalidë“¤ì€ ëª¨ë‘ ì‹œê°„ì˜ íë¦„ì„ ì—­í–‰í•˜ëŠ” êµ¬ê°„ì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰ ì‹œê°„ì˜ íë¦„ì´ ì„ í˜•ì ì¸ êµ¬ì¡°ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.