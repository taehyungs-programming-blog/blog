---
layout: default
title: "5. Controller ì •ë¦¬"
parent: Unity-ì‹¬í™”
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

* [Get Code ğŸŒ](https://github.com/EasyCoding-7/UnityPortfolio/tree/5.Controller)

ğŸ¹ ëª¬ìŠ¤í„°ìš©ìœ¼ë¡œ ì‚¬ìš©í•  Playerë¥¼ í•˜ë‚˜ ë³µì‚¬í•´ ìƒ‰ìƒë§Œ ë°”ê¿” ë³´ì.

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/unity-adv/unity-adv-5-1.png"/>
</p>

ğŸ¹ ì´ì œ ëª¬ìŠ¤í„°ìš© ì»¨íŠ¸ë¡¤ëŸ¬(MonsterController.cs)ë¥¼ ë³„ë„ë¡œ ë§Œë“¤ì–´ë³´ì.

```csharp
public class MonsterController : CreatureController
{
	protected override void Init()
	{
		base.Init();
	}

	protected override void UpdateController()
	{
		//GetDirInput();
		base.UpdateController();
	}

	// í‚¤ë³´ë“œ ì…ë ¥
	void GetDirInput()
	{
		if (Input.GetKey(KeyCode.W))
		{
			Dir = MoveDir.Up;
		}
		else if (Input.GetKey(KeyCode.S))
		{
			Dir = MoveDir.Down;
		}
		else if (Input.GetKey(KeyCode.A))
		{
			Dir = MoveDir.Left;
		}
		else if (Input.GetKey(KeyCode.D))
		{
			Dir = MoveDir.Right;
		}
		else
		{
			Dir = MoveDir.None;
		}
	}
}
```

```csharp
// ì¶”ê°€ì ìœ¼ë¡œ ë ìˆ˜ ìˆìœ¼ë©´ ìƒíƒœê´€ë¦¬ë¥¼ Stateë¥¼ ë‘¬ì„œ í•˜ì§€ boolì„ ì“°ì§€ëŠ” ë§ì.

void UpdatePosition()
{
    if (State != CreatureState.Moving)
        return;

    Vector3 destPos = Managers.Map.CurrentGrid.CellToWorld(_cellPos) + new Vector3(0.5f, 0.5f);
    Vector3 moveDir = destPos - transform.position;

    // ë„ì°© ì—¬ë¶€ ì²´í¬
    float dist = moveDir.magnitude;
    if (dist < _speed * Time.deltaTime)
    {
        transform.position = destPos;
        // ì˜ˆì™¸ì ìœ¼ë¡œ ì• ë‹ˆë©”ì´ì…˜ì„ ì§ì ‘ ì»¨íŠ¸ë¡¤
        // ìƒíƒœ ê°ì‹œ í›„ ë™ì‘ì—¬ë¶€ë¥¼ ì²´í¬
        _state = CreatureState.Idle;
        if (_dir == MoveDir.None)
            UpdateAnimation();
    }
    else
    {
        transform.position += moveDir.normalized * _speed * Time.deltaTime;
        State = CreatureState.Moving;
    }
}
```

```csharp
// ìƒíƒœì— ë”°ë¼ì„œ ì• ë‹ˆë©”ì´ì…˜ ì²˜ë¦¬

protected virtual void UpdateAnimation()
{
    if (_state == CreatureState.Idle)
    {
        switch (_lastDir)
        {
            case MoveDir.Up:
                _animator.Play("IDLE_BACK");
                _sprite.flipX = false;
                break;

    // ...
```
