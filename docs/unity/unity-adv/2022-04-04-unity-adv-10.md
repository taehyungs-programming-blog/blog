---
layout: default
title: "10. ë©€í‹°í”Œë ˆì´"
parent: Unity-ì‹¬í™”
grand_parent: "Unity ğŸ¡"
nav_order: 2
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

* [Get Code ğŸŒ](https://github.com/EasyCoding-7/UnityPortfolio/tree/10.multiplay)

ğŸ›µ Clientë¥¼ ì—¬ëŸ¬ê°œ ë„ì›Œì„œ ì„œë²„ì— ì ‘ì†í•˜ê²Œ í•´ë³´ì.

```csharp
// ìš°ì„  ê¸°ì¡´ Server ì½”ë“œë¥¼ ì¡°ê¸ˆ ì •ë¦¬í•´ ì£¼ì.

class ClientSession : PacketSession
{
    public int SessionId { get; set; }

    public void Send(IMessage packet)
    {
        string msgName = packet.Descriptor.Name.Replace("_", string.Empty);
        MsgId msgId = (MsgId)Enum.Parse(typeof(MsgId), msgName);
        ushort size = (ushort)packet.CalculateSize();
        byte[] sendBuffer = new byte[size + 4];
        Array.Copy(BitConverter.GetBytes(size + 4), 0, sendBuffer, 0, sizeof(ushort));
        Array.Copy(BitConverter.GetBytes((ushort)msgId), 0, sendBuffer, 2, sizeof(ushort));
        Array.Copy(packet.ToByteArray(), 0, sendBuffer, 4, size);
        Send(new ArraySegment<byte>(sendBuffer));
    }

    // ...

    public override void OnConnected(EndPoint endPoint)
    {
        Console.WriteLine($"OnConnected : {endPoint}");

        // PROTO Test
        S_Chat chat = new S_Chat()
        {
            Context = "ì•ˆë…•í•˜ì„¸ìš”"
        };

        // ì´ë ‡ê²Œ ì“°ë©´ëœë‹¤.
        Send(chat);
    }
```

---

ğŸ›µ UnityëŠ” í•˜ë‚˜ì˜ í”„ë¡œì íŠ¸ì—ì„œ ë‘ ê°œì˜ ë°”ì´ë„ˆë¦¬ ì‹¤í–‰ì´ ë¶ˆê°€ëŠ¥ í•˜ê¸°ì—, í”„ë¡œì íŠ¸ë¥¼ í•˜ë‚˜ ë” ë§Œë“¤ê±°ë‚˜ ë¹Œë“œ í›„ ë°”ì´ë„ˆë¦¬ë¥¼ ë‘ ë²ˆ ì‹¤í–‰í•˜ê±°ë‚˜ ë‘˜ ì¤‘í•˜ë‚˜ë¥¼ í•´ì•¼í•œë‹¤.<br>
ğŸ›µ ë³´í†µ ë¹Œë“œ í›„ ë°”ì´ë„ˆë¦¬ë¥¼ ë‘ ë²ˆì‹¤í–‰í•˜ê³¤ í•œë‹¤.<br>
ğŸ›µ **File -> Build Setting** -> Build í´ë¦­

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/unity-adv/unity-adv-10-1.png"/>
</p>

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/unity-adv/unity-adv-10-2.png"/>
</p>

ğŸ›µ UnityëŠ” ìœ„ ê³¼ì •ì„ ì½”ë“œë¡œë„ ê°€ëŠ¥í•˜ë‹¤.

```csharp
public class MultiplayersBuildAndRun
{
	[MenuItem("Tools/Run Multiplayer/2 Players")]
	static void PerformWin64Build2()
	{
		PerformWin64Build(2);
	}

	[MenuItem("Tools/Run Multiplayer/3 Players")]
	static void PerformWin64Build3()
	{
		PerformWin64Build(3);
	}

	[MenuItem("Tools/Run Multiplayer/4 Players")]
	static void PerformWin64Build4()
	{
		PerformWin64Build(4);
	}

	static void PerformWin64Build(int playerCount)
	{
		EditorUserBuildSettings.SwitchActiveBuildTarget(
			BuildTargetGroup.Standalone, BuildTarget.StandaloneWindows);

		for (int i = 1; i <= playerCount; i++)
		{
			BuildPipeline.BuildPlayer(GetScenePaths(),
				"Builds/Win64/" + GetProjectName() + i.ToString() + "/" + GetProjectName() + i.ToString() + ".exe",
				BuildTarget.StandaloneWindows64, BuildOptions.AutoRunPlayer);
		}
	}

	static string GetProjectName()
	{
		string[] s = Application.dataPath.Split('/');
		return s[s.Length - 2];
	}

	static string[] GetScenePaths()
	{
		string[] scenes = new string[EditorBuildSettings.scenes.Length];

		for (int i = 0; i < scenes.Length; i++)
		{
			scenes[i] = EditorBuildSettings.scenes[i].path;
		}

		return scenes;
	}
}
```


