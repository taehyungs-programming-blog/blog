---
layout: default
title: "15-2. InputManager"
parent: "15. FrameWork ì‚¬ìš©ë²• ì •ë¦¬"
grand_parent: Unity
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

* [Get Code ğŸŒ](https://github.com/EasyCoding-7/unity_tutorials/tree/15.1)

## êµ¬í˜„ì€ ì´ë ‡ê²Œ

```csharp
public class InputManager
{
    // Actionì— ë“±ë¡í•´ ë‘ê³  ì“´ë‹¤.
    public Action KeyAction = null;
    public Action<Define.MouseEvent> MouseAction = null;

    bool _pressed = false;

    public void OnUpdate()
    {
        // ë§ˆìš°ìŠ¤, í„°ì¹˜ê°€ UIì˜ì—­ì— ìˆëŠ”ê²Œ ì•„ë‹Œì§€ ì²´í¬í•œë‹¤.
        if (EventSystem.current.IsPointerOverGameObject())
            return;

        if (Input.anyKey && KeyAction != null)
				KeyAction.Invoke();

        if (MouseAction != null)
        {
            if (Input.GetMouseButton(0))
            {
                MouseAction.Invoke(Define.MouseEvent.Press);
                _pressed = true;
            }
            else
            {
                if (_pressed)
                    MouseAction.Invoke(Define.MouseEvent.Click);
                _pressed = false;
            }
        }
    }

    public void Clear()
    {
        KeyAction = null;
        MouseAction = null;
    }
}
```

## ì‚¬ìš©ì€ ì´ë ‡ê²Œ

```csharp
public class PlayerController : MonoBehaviour
{
    // ...

    void Start()
    {
        // PlayerControllerì—ì„œ ì‚¬ìš©ì¤‘
		Managers.Input.MouseAction -= OnMouseClicked;
		Managers.Input.MouseAction += OnMouseClicked;		
	}

    // ...

    void OnMouseClicked(Define.MouseEvent evt)
	{
        // í•˜ëŠ” ê¹€ì— ê°„ë‹¨íˆ ì„¤ëª…í•˜ìë©´ ...
		if (_state == PlayerState.Die)
			return;

        // CameraëŠ” ë©”ì¸ ì¹´ë©”ë¼ë¥¼ ì˜ë¯¸í•œë‹¤.
            // ë©”ì¸ ì¹´ë©”ë¼ì—ì„œ í´ë¦­ëœ ë°©í–¥ìœ¼ë¡œì˜ Ray
		Ray ray = Camera.main.ScreenPointToRay(Input.mousePosition);       
		Debug.DrawRay(Camera.main.transform.position, ray.direction * 100.0f, Color.red, 1.0f);

        /*
            // Screen ì¢Œí‘œ(í•´ìƒë„)
            Debug.Log(Input.mousePosition);

            // Viewport ì¢Œí‘œ(-1 ~ 1)
            Debug.Log(Camera.main.ScreenToViewportPoint(Input.mousePosition));
        */

		RaycastHit hit;
        // Layout Wallì— ë§ëŠ”ë‹¤ë©´ ì¡°ê±´ìœ¼ë¡œ ë“¤ì–´ê°€ ë‹¬ë¼
		if (Physics.Raycast(ray, out hit, 100.0f, LayerMask.GetMask("Wall")))
		{
			_destPos = hit.point;
			_state = PlayerState.Moving;
		}
	}
```