---
layout: default
title: "8-3. UI ìë™í™”-1"
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

* [Get Code ğŸŒ](https://github.com/EasyCoding-7/unity_tutorials/tree/8.3)

ğŸ¦ ê°œì„ í•˜ê³ ì í•˜ëŠ” ë¬¸ì œëŠ” ë‘ ê°€ì§€ ì´ë‹¤.<br>
    ğŸ¦ Buttonì˜ OnClick ì´ë²¤íŠ¸ ì²˜ë¦¬ë¥¼ Unity Toolì„ ì´ìš©í•´ì•¼í•œë‹¤.
    ğŸ¦ UI_Button Scriptì— ë„˜ê¸¸ Textë¥¼ Unity Toolì„ ì´ìš©í•´ì•¼í•œë‹¤.

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/unity/unity-8-3-1.png"/>
</p>

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/unity/unity-8-3-2.png"/>
</p>

---

```csharp
public class UI_Button : MonoBehaviour
{
    /*
        * ì´ë¦„ìœ¼ë¡œ gameObjectë¥¼ ì°¾ëŠ”ë‹¤. *
    */

    Dictionary<Type, UnityEngine.Object[]> _objects = new Dictionary<Type, UnityEngine.Object[]>();


    // * ButtonëŠ” PointButton
    // * TextëŠ” PointText, ScoreTextë¼ëŠ” ì´ë¦„ì´ ìˆì„ ê²½ìš° ì°¾ì„ ì˜ˆì •
    enum Buttons
    {
        PointButton,
    }

    enum Texts
    {
        PointText,
        ScoreText
    }

    private void Start()
    {
        Bind<Button>(typeof(Buttons));
        Bind<Text>(typeof(Texts));

        Get<Text>((int)Texts.ScoreText).text = "Bind Text Test!";
    }

    void Bind<T>(Type type) where T : UnityEngine.Object
    {
        string[] names = Enum.GetNames(type);

        UnityEngine.Object[] objects = new UnityEngine.Object[names.Length];
        _objects.Add(typeof(T), objects);   // ì˜ˆë¥¼ë“¤ì–´ Textë¼ë©´ ( Text, [PointText,ScoreText] ) ì´ë ‡ê²Œ ì €ì¥ë¨.

        for (int i = 0; i < names.Length; i++)
        {
            objects[i] = Util.FindChild<T>(gameObject,      // í˜„ì¬ Unityì—ì„œ ì‚¬ìš©ì¤‘ì¸ ëª¨ë“  objectì˜
                                            names[i], true);
        }
    }

    T Get<T>(int idx) where T : UnityEngine.Object
    {
        UnityEngine.Object[] objects = null;
        if (_objects.TryGetValue(typeof(T), out objects) == false)
            return null;

        return objects[idx] as T;
    }

    int _score = 0;

    public void OnButtonClicked()
    {
        _score++;
    }
}
```

```csharp
public class Util
{
    public static T FindChild<T>(GameObject go, string name = null, bool recursive = false) where T : UnityEngine.Object
    {
        if (go == null)
            return null;

        if(recursive == false)
        {
            for (int i = 0; i < go.transform.childCount; i++)
            {
                Transform transform = go.transform.GetChild(i);
                if (string.IsNullOrEmpty(name) || transform.name == name)
                {
                    T component = transform.GetComponent<T>();
                    if (component != null)
                        return component;
                }
            }
        }
        else 
        {
            foreach(T component in go.GetComponentsInChildren<T>())
            {
                if (string.IsNullOrEmpty(name) || component.name == name)
                    return component;
            }
        }

        return null;
    }
}
```

ğŸ¦ ì—¬ê¸°ê¹Œì§€í•˜ë©´ `_objects`ë‚´ì— ì°¾ê³ ì í•˜ëŠ” objectê°€ ì €ì¥ë˜ì–´ ìˆë‹¤.

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/unity/unity-8-3-3.png"/>
</p>

---

ğŸ¦ ê·¸ëŸ°ë° Text, Buttonë§ê³  GameObjectìì²´ë¥¼ ì—°ê²°ì‹œí‚¬ í•„ìš”ë„ ìˆë‹¤.<br>
ğŸ¦ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ UI_Button Canvasì•ˆì— Empty Objectë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ ì£¼ì.

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/csharp/unity/unity-8-3-4.png"/>
</p>

```csharp
public class UI_Button : MonoBehaviour
{
    // ...

    enum GameObjects
    {
        TestObject,
    }

    private void Start()
    {
        Bind<Button>(typeof(Buttons));
        Bind<Text>(typeof(Texts));
        Bind<GameObject>(typeof(GameObjects));

        Get<Text>((int)Texts.ScoreText).text = "Bind Text Test!";
    }

    // ...
```

```csharp
void Bind<T>(Type type) where T : UnityEngine.Object
{
    string[] names = Enum.GetNames(type);

    UnityEngine.Object[] objects = new UnityEngine.Object[names.Length];
    _objects.Add(typeof(T), objects);

    for (int i = 0; i < names.Length; i++)
    {
        // Bindì‹œ GameObjectëŠ” ë³„ë„ë¡œ Bind
        if(typeof(T) == typeof(GameObject))
            objects[i] = Util.FindChild(gameObject, names[i], true);
        else
            objects[i] = Util.FindChild<T>(gameObject, names[i], true);

        if (objects[i] == null)
            Debug.Log($"Filed to bind{names[i]}");
    }
}
```

```csharp
public static GameObject FindChild(GameObject go, string name = null, bool recursive = false)
{
    // ì°¾ëŠ” ë°©ë²•ì€ ëª¨ë“  objectëŠ” Transformì„ ê°–ê¸°ì— Transformìœ¼ë¡œ ì°¾ê³  gameObjectë¥¼ ë¦¬í„´í•œë‹¤.
    Transform t = FindChild<Transform>(go, name, recursive);
    if (t != null)
        return null;

    return t.gameObject;
}
```

---

ğŸ¦ ë§ì´ ì‚¬ìš©ë˜ëŠ” Text, Buttonì€ ë³„ë„ì˜ í•¨ìˆ˜ë¡œ ë¹¼ë‘ì.

```csharp
public class UI_Button : MonoBehaviour
{
    // ...
    Text GetText(int idx) { return Get<Text>(idx); }
    Button GetButton(int idx) { return Get<Button>(idx); }
    Image GetImage(int idx) { return Get<Image>(idx); }
```

---

ğŸ¦ í˜„ì¬ Bindê°€ ëª¨ë‘ UI_Button ì•„ë˜ìˆëŠ”ë° UI_Baseì•„ë˜ë¡œ ì˜®ê¸°ê² ìŒ.

```csharp
using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;

public class UI_Button : UI_Base
{
    enum Buttons
    {
        PointButton,
    }
    enum Texts
    {
        PointText,
        ScoreText
    }
    enum GameObjects
    {
        TestObject,
    }

    private void Start()
    {
        Bind<Button>(typeof(Buttons));
        Bind<Text>(typeof(Texts));
        Bind<GameObject>(typeof(GameObjects));

        // Get<Text>((int)Texts.ScoreText).text = "Bind Text Test!";
        GetText((int)Texts.ScoreText).text = "Bind Text Test!";
    }



    int _score = 0;

    public void OnButtonClicked()
    {
        _score++;
    }
}

```

```csharp
using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;

public class UI_Base : MonoBehaviour
{
    Dictionary<Type, UnityEngine.Object[]> _objects = new Dictionary<Type, UnityEngine.Object[]>();

    protected void Bind<T>(Type type) where T : UnityEngine.Object
    {
        string[] names = Enum.GetNames(type);

        UnityEngine.Object[] objects = new UnityEngine.Object[names.Length];
        _objects.Add(typeof(T), objects);

        for (int i = 0; i < names.Length; i++)
        {
            if (typeof(T) == typeof(GameObject))
                objects[i] = Util.FindChild(gameObject, names[i], true);
            else
                objects[i] = Util.FindChild<T>(gameObject, names[i], true);

            if (objects[i] == null)
                Debug.Log($"Filed to bind{names[i]}");
        }
    }

    protected T Get<T>(int idx) where T : UnityEngine.Object
    {
        UnityEngine.Object[] objects = null;
        if (_objects.TryGetValue(typeof(T), out objects) == false)
            return null;

        return objects[idx] as T;
    }

    protected Text GetText(int idx) { return Get<Text>(idx); }
    protected Button GetButton(int idx) { return Get<Button>(idx); }
    protected Image GetImage(int idx) { return Get<Image>(idx); }
}

```