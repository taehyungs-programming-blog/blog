---
layout: default
title: "(03. ë¡œë¹„ì˜ êµ¬í˜„)"
parent: "(MMORPG ë§Œë“¤ì–´ ë³´ê¸° ğŸ¤©)"
has_children: true
nav_order: 1
---

```csharp
public class UI_SelectCharacterPopup : UI_Popup
{
    // ...

    Transform _parent;

    // UI_CharacterSlotItemë¥¼ Listë¡œ ê´€ë¦¬
    List<UI_CharacterSlotItem> _slots = new List<UI_CharacterSlotItem>();
```

* ëŒ€ëµ í•„ìš”í•´ ë³´ì´ëŠ” ì‘ì—…ì€ ìºë¦­í„° ëª©ë¡ ë°›ê¸°, ìºë¦­í„° ìƒì„± í•˜ê¸°, ìºë¦­í„° ì‚­ì œ í•˜ê¸°, ê²Œì„ ì‹œì‘í•˜ê¸°

---

## ì‘ì—…ì€ ìºë¦­í„° ëª©ë¡ ë°›ê¸°

### Client

```csharp
public static void S_HeroListResHandler(PacketSession session, IMessage packet)
{
    Debug.Log("S_HeroListResHandler");

    UI_TitleScene sceneUI = Managers.UI.GetSceneUI<UI_TitleScene>();
    if (sceneUI == null)
        return;

    S_HeroListRes resPacket = packet as S_HeroListRes;
    sceneUI.OnHeroListResHandler(resPacket);
}
```

```csharp
public void OnHeroListResHandler(S_HeroListRes resPacket)
{
    List<MyHeroInfo> heroes = resPacket.Heroes.ToList();

    UI_SelectCharacterPopup popup = Managers.UI.GetLastPopupUI<UI_SelectCharacterPopup>();
    if (popup == null)
        popup = Managers.UI.ShowPopupUI<UI_SelectCharacterPopup>();

    popup.SetInfo(heroes);
}
```

### Server

---

## ìºë¦­í„° ìƒì„± í•˜ê¸°

---

## ìºë¦­í„° ì‚­ì œ í•˜ê¸°

---

## ê²Œì„ ì‹œì‘í•˜ê¸°

---

## TODO: ORM to Clientì–´ë–»ê²Œ íŒ¨í‚·ë§Œë“¤ê³  ê´€ë¦¬í•˜ëŠ”ì§€ í™•ì¸.

```csharp
public static HeroDb CreateHeroDb(long accountDbId, C_CreateHeroReq reqPacket)
{
    using (GameDbContext db = new GameDbContext())
    {
        HeroDb heroDb = db.Heroes.Where(h => h.Name == reqPacket.Name).FirstOrDefault();
        if (heroDb != null)
            return null;

        heroDb = new HeroDb()
        {
            AccountDbId = accountDbId,
            Name = reqPacket.Name,
            Gender = reqPacket.Gender,
            ClassType = reqPacket.ClassType
        };

        db.Heroes.Add(heroDb);

        if (db.SaveChangesEx())
            return heroDb;

        return null;
    }
}
```

```csharp
public void HandleCreateHeroReq(C_CreateHeroReq reqPacket)
{
    S_CreateHeroRes resPacket = new S_CreateHeroRes();

    // 1) ì´ë¦„ì´ ì•ˆ ê²¹ì¹˜ëŠ”ì§€ í™•ì¸
    // 2) ìƒì„± ì§„í–‰
    HeroDb heroDb = DBManager.CreateHeroDb(AccountDbId, reqPacket);
    if (heroDb != null)
    {
        resPacket.Result = ECreateHeroResult.Success;
        // ë©”ëª¨ë¦¬ì— ìºì‹±
        Hero hero = MakeHeroFromHeroDb(heroDb);
        Heroes.Add(hero);
    }
    else
    {
        resPacket.Result = ECreateHeroResult.FailDuplicateName;
    }

    Send(resPacket);
}

```