---
layout: default
title: "4. MongoDB ì…ë ¥/ì½ê¸°/ìˆ˜ì •/ì‚­ì œ"
parent: (NoSQL)
grand_parent: Python
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

## CRUD

ğŸ‘© SQLì„ ê°„ë‹¨íˆ ì •ë¦¬í•˜ìë©´ CRUD ë„¤ ê°€ì§€ë¡œ ì •ë¦¬ ë  ìˆ˜ ìˆë‹¤.

* Create
* READ
* Update
* Delete

ğŸ‘© ë™ì¼í•˜ê²Œ NoSQLì—ì„œë„ CRUDë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ ë³´ì.

### Collection (TABLE)

```sql
CREATE TABLE people (
    id MEDIUMINT NOT NULL AUTO_INCREMENT,
    user_id Varchar(30),
    age Number,
    status char(1),
    PRIMARY KEY (id)
)
```

ğŸ‘© ì¡°ê¸ˆ í•´ì„í•˜ìë©´ `PRIMARY KEY (id)`ë¥¼ í†µí•´ idë¥¼ primary keyë¡œ ë§Œë“¤ì–´ ë°ì´í„°ë¥¼ êµ¬ë¶„í•´ ë‹¬ë¼<br>
ğŸ‘© ì´ê±¸ NoSQLì—ì„œëŠ” ì–´ë–»ê²Œ í‘œí˜„í• ê¹Œ?

```json
db.people.insertOne ({
    user_id: "user1",
    age: 55,
    status: "A"
})
```

ğŸ‘© ??? Primary keyëŠ”? MongoDBì—ì„œ ìë™ìœ¼ë¡œ _idê°’ì´ ë“¤ì–´ê°€ë©° ê·¸ _idê°’ì´ Primary Keyê°€ ëœë‹¤.

---

## ì…ë ¥ (Create)

* `insertOne` : í•œ ê°œì˜ document ìƒì„±
* `insertMany` : ì—¬ëŸ¬ê°œì˜ document ìƒì„±

```json
db.people.insertOne (
    {
        user_id: "user1",
        age: 55,
        status: "A"
    }
)
```

```s
$ use <db name>
$ db.createCollection("users")
$ db.users.insertOne(
    {
        user_id: "user1",
        age: 55,
        status: "A"
    }
)
```

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/python/nosql/nosql-4-1.png"/>
</p>

ğŸ‘© SQL ê¸°ì¤€ìœ¼ë¡œ ë³´ìë©´

```sql
INSERT INTO people(user_id, age, status)
VALUES ("user1", 45, "A")
```

ğŸ‘© ì—¬ëŸ¬ documentë¥¼ ë„£ì–´ë³´ì.

```s
$ use <db name>
$ db.createCollection("users")
$ db.users.insertMany(
    [
        { user_id: "user1", age: 55, status: "A" },
        { user_id: "user2", age: 40, status: "C" },
        { user_id: "user3", age: 50, status: "B" },
        { user_id: "user4", age: 15, status: "D" }
    ]
)
```

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/python/nosql/nosql-4-2.png"/>
</p>

---

## ì½ê¸°

* `findOne` : ë§¤ì¹­ë˜ëŠ” í•œê°œì˜ document ì¶œë ¥
* `find` : ë§¤ì¹­ë˜ëŠ” ì—¬ëŸ¬ê°œì˜ documents ì¶œë ¥

```json
db.users.find(
    { age: {$gt: 18} },
    { name: 1, address: 1 }
).limit(5)
```

* `{ name: 1, address: 1 }` : ë°ì´í„° ì¤‘ nameê³¼ addressë§Œ ê°€ì ¸ì™€ ë‹¬ë¼
    * (ì£¼ì˜) `{ _id: 0 }` : _idëŠ” ê¸°ë³¸ìœ¼ë¡œ ë“¤ì–´ê°€ê¸°ì— ë¹¼ê³ ì í•œë‹¤ë©´ ëª…ì‹œì ìœ¼ë¡œ ì•Œë ¤ì¤˜ì•¼ í•¨
* `.find({ status: "A" })` : statusê°€ Aì¼ë•Œë§Œ ê°€ì ¸ì™€ ë‹¬ë¼
* `.find({ $or: [ { status: "A"} , { age: 50}]})` : orì—°ì‚° ê°€ëŠ¥

### Example

```json
db.users.find({}, {user_id: 1, status: 1})
```

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/python/nosql/nosql-4-3.png"/>
</p>

```json
db.users.find({status: "A"})
```

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/python/nosql/nosql-4-4.png"/>
</p>

### ë¹„êµ ë¬¸ë²•

* `$eq` : =
* `$gt` : > (`db.example.find({ age: { $gt: 25 } })`)
* `$gte` : >=
* `$in` : (`db.example.find({ age: { $in: [5, 15] } })`) 5 í˜¹ì€ 15
* `$lt` : <
* `$lte` : <= (`db.example.find({ age: { $gt: 25, $lte: 50 } })`)
* `$ne` : !=
* `$nin` : not in
* íŠ¹ì • ë¬¸ì í¬í•¨ : 
    * `db.example.find({ user_id: /bc/ })` bcê°€ í¬í•¨ëœ ë¬¸ì
    * `db.example.find({ user_id: { $regex: /^bc/} })`

---

## ìˆ˜ì •

* `updateOne` : í•œ ê°œì˜ document ì—…ë°ì´íŠ¸ (ê°€ì¥ ë¨¼ì € ê²€ìƒ‰ëœ documentë§Œ ìˆ˜ì •ë¨)
* `updateMany` : ì—¬ëŸ¬ê°œì˜ document ì—…ë°ì´íŠ¸

```json
db.users.updateMany(
    { age: { $lt: 18 } },
    { $set: { status: "reject" }}
)
```

* `age: { $lt: 18 }` ageê°€ 18ë³´ë‹¤ ì‘ì€ì• ë“¤ì„ `$set: { status: "reject" }` statusë¥¼ rejectë¡œ ë³€ê²½í•´ ë‹¬ë¼

```json
db.users.updateMany(
    { age: { $lt: 18 } },
    { $inc: { age: 3 }}
)
```

* ageë¥¼ 3ë§Œí¼ ì¦ê°€

---

## ì‚­ì œ

* `removeOne` : í•œ ê°œì˜ document ì‚­ì œ
* `removeMany` : ì—¬ëŸ¬ê°œì˜ document ì‚­ì œ

```json
db.users.deleteMany(
    { status: "reject" }
)
```

* `db.users.deleteMany({})` ëª¨ë‘ ì‚­ì œ