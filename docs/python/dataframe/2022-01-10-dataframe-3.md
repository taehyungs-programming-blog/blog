---
layout: default
title: 3. Dataframe combining
parent: (Dataframe)
grand_parent: Python
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

## Install Library


```python
!pip install finance-datareader
!pip install beautifulsoup4 
!pip install numpy
!pip install pandas
```


```python
# default settings
import numpy as np
import pandas as pd

# jupyter notebook 여러 실행인자 실행해도 print되게 만들기
from IPython.core.interactiveshell import InteractiveShell
InteractiveShell.ast_node_interactivity = "all"

pd.set_option('display.float_format', lambda x: '%.3f' % x)
pd.set_option('max_columns', None)
```

---

## DataFrame row 추가


```python
df = pd.DataFrame(columns=['a', 'b'])
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



---


```python
df.loc[0] = [1, 2]
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
df.loc['ㅋㅋ'] = [1, 2]
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>ㅋㅋ</th>
      <td>1</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
df.loc[len(df)] = {'b' : 'ㅎ', 'a': 'ㅋ'}
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>ㅋㅋ</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ㅋ</td>
      <td>ㅎ</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
df.loc["yay"] = pd.Series({'a': 'ㅋ', 'b' : 'ㅎ'})
df.tail()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>ㅋㅋ</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ㅋ</td>
      <td>ㅎ</td>
    </tr>
    <tr>
      <th>yay</th>
      <td>ㅋ</td>
      <td>ㅎ</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# 이미 존재한는 index에 넣기 
df.loc["yay"] = pd.Series({'a': '1111', 'b' : '2222'})
df.tail()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>ㅋㅋ</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ㅋ</td>
      <td>ㅎ</td>
    </tr>
    <tr>
      <th>yay</th>
      <td>1111</td>
      <td>2222</td>
    </tr>
  </tbody>
</table>
</div>



---

### append()


```python
names_df = pd.DataFrame(
    {
        'Name':['철수', '영희', '영수', '영미'],
        'Age':[12, 13, 14, 15]
    },
    index = ['Canada', 'Canada', 'USA', 'USA']
)
names_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Canada</th>
      <td>철수</td>
      <td>12</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>영희</td>
      <td>13</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>영수</td>
      <td>14</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>영미</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# Error (에러내용 확인!) => index를 뭐로 설정해야될지 모르기 때문
names_df.append(
    {'Name':'명수', 'Age':1},
    ignore_index=True   # ignore이 없으면 Error
)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>철수</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>영희</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>영수</td>
      <td>14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>영미</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>명수</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# 리스트 of 딕셔너리로도 전달 가능
names_df.append(
    [
        {'Name':'명수', 'Age':1},
        {'Name':'동수', 'Age':2}
    ], 
    ignore_index=True
)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>철수</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>영희</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>영수</td>
      <td>14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>영미</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>명수</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>동수</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# 원본에 반영안됨.
names_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Canada</th>
      <td>철수</td>
      <td>12</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>영희</td>
      <td>13</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>영수</td>
      <td>14</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>영미</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
s = pd.Series({'Name': 'Zach', 'Age': 3}, name=len(names_df))
s
```




    Name    Zach
    Age        3
    Name: 4, dtype: object



---


```python
names_df.append(s)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Canada</th>
      <td>철수</td>
      <td>12</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>영희</td>
      <td>13</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>영수</td>
      <td>14</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>영미</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Zach</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# 리스트 of Series로도 전달 가능
s1 = pd.Series({'Name': 'Zach', 'Age': 3}, name=len(names_df))
s2 = pd.Series({'Name': 'Zayd', 'Age': 2}, name='USA')
names_df.append([s1, s2])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Canada</th>
      <td>철수</td>
      <td>12</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>영희</td>
      <td>13</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>영수</td>
      <td>14</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>영미</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Zach</td>
      <td>3</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>Zayd</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# 원본에 반영안됨.
names_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Canada</th>
      <td>철수</td>
      <td>12</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>영희</td>
      <td>13</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>영수</td>
      <td>14</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>영미</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
s1
s2
pd.concat([s1, s2], axis=1)
```




    Name    Zach
    Age        3
    Name: 4, dtype: object






    Name    Zayd
    Age        2
    Name: USA, dtype: object






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>4</th>
      <th>USA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Name</th>
      <td>Zach</td>
      <td>Zayd</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



---

## concat()


```python
!pip install finance-datareader
import FinanceDataReader as fdr
```


```python
samsung_df = fdr.DataReader('005390', '2009-01-01', '2017-12-31')
kodex_df = fdr.DataReader('069500', '2016-01-01', '2017-12-31')
```


```python
samsung_df.tail(2)
kodex_df.tail(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-12-27</th>
      <td>1080</td>
      <td>1095</td>
      <td>1060</td>
      <td>1095</td>
      <td>428161</td>
      <td>0.033</td>
    </tr>
    <tr>
      <th>2017-12-28</th>
      <td>1095</td>
      <td>1095</td>
      <td>1050</td>
      <td>1065</td>
      <td>559604</td>
      <td>-0.027</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-12-27</th>
      <td>29559</td>
      <td>29803</td>
      <td>29499</td>
      <td>29810</td>
      <td>13743517</td>
      <td>0.012</td>
    </tr>
    <tr>
      <th>2017-12-28</th>
      <td>29817</td>
      <td>30210</td>
      <td>29812</td>
      <td>30184</td>
      <td>8211476</td>
      <td>0.013</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
pd.concat(
    [samsung_df, kodex_df]
) 
# samsung_df
# kodex_df
# 이런순으로 쌓임
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-01-02</th>
      <td>200</td>
      <td>234</td>
      <td>200</td>
      <td>234</td>
      <td>2122</td>
      <td>0.083</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>229</td>
      <td>234</td>
      <td>213</td>
      <td>223</td>
      <td>6890</td>
      <td>-0.047</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>210</td>
      <td>234</td>
      <td>210</td>
      <td>212</td>
      <td>2144</td>
      <td>-0.049</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>214</td>
      <td>220</td>
      <td>208</td>
      <td>216</td>
      <td>2434</td>
      <td>0.019</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>216</td>
      <td>220</td>
      <td>200</td>
      <td>215</td>
      <td>2280</td>
      <td>-0.005</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2017-12-21</th>
      <td>29947</td>
      <td>30002</td>
      <td>29436</td>
      <td>29442</td>
      <td>9299734</td>
      <td>-0.019</td>
    </tr>
    <tr>
      <th>2017-12-22</th>
      <td>29518</td>
      <td>29646</td>
      <td>29444</td>
      <td>29584</td>
      <td>9212290</td>
      <td>0.005</td>
    </tr>
    <tr>
      <th>2017-12-26</th>
      <td>29643</td>
      <td>29821</td>
      <td>29458</td>
      <td>29464</td>
      <td>8257476</td>
      <td>-0.004</td>
    </tr>
    <tr>
      <th>2017-12-27</th>
      <td>29559</td>
      <td>29803</td>
      <td>29499</td>
      <td>29810</td>
      <td>13743517</td>
      <td>0.012</td>
    </tr>
    <tr>
      <th>2017-12-28</th>
      <td>29817</td>
      <td>30210</td>
      <td>29812</td>
      <td>30184</td>
      <td>8211476</td>
      <td>0.013</td>
    </tr>
  </tbody>
</table>
<p>2718 rows × 6 columns</p>
</div>



---


```python
kodex_df[['Open', 'Close']].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>Close</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-01-04</th>
      <td>21477</td>
      <td>21121</td>
    </tr>
    <tr>
      <th>2016-01-05</th>
      <td>21068</td>
      <td>21253</td>
    </tr>
    <tr>
      <th>2016-01-06</th>
      <td>21242</td>
      <td>21099</td>
    </tr>
    <tr>
      <th>2016-01-07</th>
      <td>21043</td>
      <td>20896</td>
    </tr>
    <tr>
      <th>2016-01-08</th>
      <td>20767</td>
      <td>21045</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
pd.concat(
    [
        samsung_df, 
        kodex_df[['Open', 'Close']]
    ]
).tail(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-12-27</th>
      <td>29559</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>29810</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2017-12-28</th>
      <td>29817</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30184</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
pd.concat(
    [samsung_df, kodex_df],
    keys=['삼성', 'KODEX200'], 
).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th></th>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">삼성</th>
      <th>2009-01-02</th>
      <td>200</td>
      <td>234</td>
      <td>200</td>
      <td>234</td>
      <td>2122</td>
      <td>0.083</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>229</td>
      <td>234</td>
      <td>213</td>
      <td>223</td>
      <td>6890</td>
      <td>-0.047</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>210</td>
      <td>234</td>
      <td>210</td>
      <td>212</td>
      <td>2144</td>
      <td>-0.049</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>214</td>
      <td>220</td>
      <td>208</td>
      <td>216</td>
      <td>2434</td>
      <td>0.019</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>216</td>
      <td>220</td>
      <td>200</td>
      <td>215</td>
      <td>2280</td>
      <td>-0.005</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
pd.concat(
    [samsung_df, kodex_df],
    keys=['삼성', 'KODEX200'],
    names=['종목명']
).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>종목명</th>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">삼성</th>
      <th>2009-01-02</th>
      <td>200</td>
      <td>234</td>
      <td>200</td>
      <td>234</td>
      <td>2122</td>
      <td>0.083</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>229</td>
      <td>234</td>
      <td>213</td>
      <td>223</td>
      <td>6890</td>
      <td>-0.047</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>210</td>
      <td>234</td>
      <td>210</td>
      <td>212</td>
      <td>2144</td>
      <td>-0.049</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>214</td>
      <td>220</td>
      <td>208</td>
      <td>216</td>
      <td>2434</td>
      <td>0.019</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>216</td>
      <td>220</td>
      <td>200</td>
      <td>215</td>
      <td>2280</td>
      <td>-0.005</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
pd.concat(
    [samsung_df, kodex_df],
    keys=['삼성', 'KODEX200'],
    names=['종목명', '날짜']
).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>종목명</th>
      <th>날짜</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">삼성</th>
      <th>2009-01-02</th>
      <td>200</td>
      <td>234</td>
      <td>200</td>
      <td>234</td>
      <td>2122</td>
      <td>0.083</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>229</td>
      <td>234</td>
      <td>213</td>
      <td>223</td>
      <td>6890</td>
      <td>-0.047</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>210</td>
      <td>234</td>
      <td>210</td>
      <td>212</td>
      <td>2144</td>
      <td>-0.049</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>214</td>
      <td>220</td>
      <td>208</td>
      <td>216</td>
      <td>2434</td>
      <td>0.019</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>216</td>
      <td>220</td>
      <td>200</td>
      <td>215</td>
      <td>2280</td>
      <td>-0.005</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
pd.concat([samsung_df, kodex_df], axis=1).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-01-02</th>
      <td>200</td>
      <td>234</td>
      <td>200</td>
      <td>234</td>
      <td>2122</td>
      <td>0.083</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>229</td>
      <td>234</td>
      <td>213</td>
      <td>223</td>
      <td>6890</td>
      <td>-0.047</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>210</td>
      <td>234</td>
      <td>210</td>
      <td>212</td>
      <td>2144</td>
      <td>-0.049</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>214</td>
      <td>220</td>
      <td>208</td>
      <td>216</td>
      <td>2434</td>
      <td>0.019</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>216</td>
      <td>220</td>
      <td>200</td>
      <td>215</td>
      <td>2280</td>
      <td>-0.005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# outter join
pd.concat([samsung_df, kodex_df], keys=['삼성', 'KODEX200'], axis=1).head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">삼성</th>
      <th colspan="6" halign="left">KODEX200</th>
    </tr>
    <tr>
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-01-02</th>
      <td>200</td>
      <td>234</td>
      <td>200</td>
      <td>234</td>
      <td>2122</td>
      <td>0.083</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>229</td>
      <td>234</td>
      <td>213</td>
      <td>223</td>
      <td>6890</td>
      <td>-0.047</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# inner join
pd.concat([samsung_df, kodex_df], keys=['삼성', 'kodex'], axis=1, names=['종목명'], join='inner').head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>종목명</th>
      <th colspan="6" halign="left">삼성</th>
      <th colspan="6" halign="left">kodex</th>
    </tr>
    <tr>
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-01-04</th>
      <td>1470</td>
      <td>1485</td>
      <td>1430</td>
      <td>1430</td>
      <td>862249</td>
      <td>-0.017</td>
      <td>21477</td>
      <td>21485</td>
      <td>21109</td>
      <td>21121</td>
      <td>7823927</td>
      <td>-0.020</td>
    </tr>
    <tr>
      <th>2016-01-05</th>
      <td>1405</td>
      <td>1440</td>
      <td>1400</td>
      <td>1400</td>
      <td>844949</td>
      <td>-0.021</td>
      <td>21068</td>
      <td>21318</td>
      <td>21068</td>
      <td>21253</td>
      <td>14025395</td>
      <td>0.006</td>
    </tr>
    <tr>
      <th>2016-01-06</th>
      <td>1415</td>
      <td>1435</td>
      <td>1390</td>
      <td>1400</td>
      <td>1061873</td>
      <td>0.000</td>
      <td>21242</td>
      <td>21265</td>
      <td>20981</td>
      <td>21099</td>
      <td>12281225</td>
      <td>-0.007</td>
    </tr>
    <tr>
      <th>2016-01-07</th>
      <td>1405</td>
      <td>1415</td>
      <td>1350</td>
      <td>1350</td>
      <td>1184923</td>
      <td>-0.036</td>
      <td>21043</td>
      <td>21122</td>
      <td>20837</td>
      <td>20896</td>
      <td>12663306</td>
      <td>-0.010</td>
    </tr>
    <tr>
      <th>2016-01-08</th>
      <td>1315</td>
      <td>1365</td>
      <td>1290</td>
      <td>1360</td>
      <td>886329</td>
      <td>0.007</td>
      <td>20767</td>
      <td>21054</td>
      <td>20721</td>
      <td>21045</td>
      <td>13841294</td>
      <td>0.007</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# axis=0, inner join(교집합)
pd.concat([samsung_df.head(), kodex_df[['Close']].head()], join='inner')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Close</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-01-02</th>
      <td>234</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>223</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>212</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>216</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>215</td>
    </tr>
    <tr>
      <th>2016-01-04</th>
      <td>21121</td>
    </tr>
    <tr>
      <th>2016-01-05</th>
      <td>21253</td>
    </tr>
    <tr>
      <th>2016-01-06</th>
      <td>21099</td>
    </tr>
    <tr>
      <th>2016-01-07</th>
      <td>20896</td>
    </tr>
    <tr>
      <th>2016-01-08</th>
      <td>21045</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
samsung_diff_col_df = samsung_df.copy()
samsung_diff_col_df.columns = ['1_' + col  for col in samsung_df.columns]
samsung_diff_col_df.head()
samsung_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1_Open</th>
      <th>1_High</th>
      <th>1_Low</th>
      <th>1_Close</th>
      <th>1_Volume</th>
      <th>1_Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-01-02</th>
      <td>200</td>
      <td>234</td>
      <td>200</td>
      <td>234</td>
      <td>2122</td>
      <td>0.083</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>229</td>
      <td>234</td>
      <td>213</td>
      <td>223</td>
      <td>6890</td>
      <td>-0.047</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>210</td>
      <td>234</td>
      <td>210</td>
      <td>212</td>
      <td>2144</td>
      <td>-0.049</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>214</td>
      <td>220</td>
      <td>208</td>
      <td>216</td>
      <td>2434</td>
      <td>0.019</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>216</td>
      <td>220</td>
      <td>200</td>
      <td>215</td>
      <td>2280</td>
      <td>-0.005</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-01-02</th>
      <td>200</td>
      <td>234</td>
      <td>200</td>
      <td>234</td>
      <td>2122</td>
      <td>0.083</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>229</td>
      <td>234</td>
      <td>213</td>
      <td>223</td>
      <td>6890</td>
      <td>-0.047</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>210</td>
      <td>234</td>
      <td>210</td>
      <td>212</td>
      <td>2144</td>
      <td>-0.049</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>214</td>
      <td>220</td>
      <td>208</td>
      <td>216</td>
      <td>2434</td>
      <td>0.019</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>216</td>
      <td>220</td>
      <td>200</td>
      <td>215</td>
      <td>2280</td>
      <td>-0.005</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
pd.concat([samsung_diff_col_df, kodex_df]).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1_Open</th>
      <th>1_High</th>
      <th>1_Low</th>
      <th>1_Close</th>
      <th>1_Volume</th>
      <th>1_Change</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-01-02</th>
      <td>200.000</td>
      <td>234.000</td>
      <td>200.000</td>
      <td>234.000</td>
      <td>2122.000</td>
      <td>0.083</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>229.000</td>
      <td>234.000</td>
      <td>213.000</td>
      <td>223.000</td>
      <td>6890.000</td>
      <td>-0.047</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>210.000</td>
      <td>234.000</td>
      <td>210.000</td>
      <td>212.000</td>
      <td>2144.000</td>
      <td>-0.049</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>214.000</td>
      <td>220.000</td>
      <td>208.000</td>
      <td>216.000</td>
      <td>2434.000</td>
      <td>0.019</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>216.000</td>
      <td>220.000</td>
      <td>200.000</td>
      <td>215.000</td>
      <td>2280.000</td>
      <td>-0.005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



---

## Example


```python
total_df = pd.concat([samsung_df, kodex_df], keys=['삼성', 'kodex200'], names=['종목명'])
total_df.head()
total_df.tail()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>종목명</th>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">삼성</th>
      <th>2009-01-02</th>
      <td>200</td>
      <td>234</td>
      <td>200</td>
      <td>234</td>
      <td>2122</td>
      <td>0.083</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>229</td>
      <td>234</td>
      <td>213</td>
      <td>223</td>
      <td>6890</td>
      <td>-0.047</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>210</td>
      <td>234</td>
      <td>210</td>
      <td>212</td>
      <td>2144</td>
      <td>-0.049</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>214</td>
      <td>220</td>
      <td>208</td>
      <td>216</td>
      <td>2434</td>
      <td>0.019</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>216</td>
      <td>220</td>
      <td>200</td>
      <td>215</td>
      <td>2280</td>
      <td>-0.005</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>종목명</th>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">kodex200</th>
      <th>2017-12-21</th>
      <td>29947</td>
      <td>30002</td>
      <td>29436</td>
      <td>29442</td>
      <td>9299734</td>
      <td>-0.019</td>
    </tr>
    <tr>
      <th>2017-12-22</th>
      <td>29518</td>
      <td>29646</td>
      <td>29444</td>
      <td>29584</td>
      <td>9212290</td>
      <td>0.005</td>
    </tr>
    <tr>
      <th>2017-12-26</th>
      <td>29643</td>
      <td>29821</td>
      <td>29458</td>
      <td>29464</td>
      <td>8257476</td>
      <td>-0.004</td>
    </tr>
    <tr>
      <th>2017-12-27</th>
      <td>29559</td>
      <td>29803</td>
      <td>29499</td>
      <td>29810</td>
      <td>13743517</td>
      <td>0.012</td>
    </tr>
    <tr>
      <th>2017-12-28</th>
      <td>29817</td>
      <td>30210</td>
      <td>29812</td>
      <td>30184</td>
      <td>8211476</td>
      <td>0.013</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
total_df = total_df.reset_index()
total_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목명</th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>삼성</td>
      <td>2009-01-02</td>
      <td>200</td>
      <td>234</td>
      <td>200</td>
      <td>234</td>
      <td>2122</td>
      <td>0.083</td>
    </tr>
    <tr>
      <th>1</th>
      <td>삼성</td>
      <td>2009-01-05</td>
      <td>229</td>
      <td>234</td>
      <td>213</td>
      <td>223</td>
      <td>6890</td>
      <td>-0.047</td>
    </tr>
    <tr>
      <th>2</th>
      <td>삼성</td>
      <td>2009-01-06</td>
      <td>210</td>
      <td>234</td>
      <td>210</td>
      <td>212</td>
      <td>2144</td>
      <td>-0.049</td>
    </tr>
    <tr>
      <th>3</th>
      <td>삼성</td>
      <td>2009-01-07</td>
      <td>214</td>
      <td>220</td>
      <td>208</td>
      <td>216</td>
      <td>2434</td>
      <td>0.019</td>
    </tr>
    <tr>
      <th>4</th>
      <td>삼성</td>
      <td>2009-01-08</td>
      <td>216</td>
      <td>220</td>
      <td>200</td>
      <td>215</td>
      <td>2280</td>
      <td>-0.005</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
total_df.pivot(index='Date', columns='종목명', values='Close')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>종목명</th>
      <th>kodex200</th>
      <th>삼성</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009-01-02</th>
      <td>NaN</td>
      <td>234.000</td>
    </tr>
    <tr>
      <th>2009-01-05</th>
      <td>NaN</td>
      <td>223.000</td>
    </tr>
    <tr>
      <th>2009-01-06</th>
      <td>NaN</td>
      <td>212.000</td>
    </tr>
    <tr>
      <th>2009-01-07</th>
      <td>NaN</td>
      <td>216.000</td>
    </tr>
    <tr>
      <th>2009-01-08</th>
      <td>NaN</td>
      <td>215.000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2017-12-21</th>
      <td>29442.000</td>
      <td>1050.000</td>
    </tr>
    <tr>
      <th>2017-12-22</th>
      <td>29584.000</td>
      <td>1050.000</td>
    </tr>
    <tr>
      <th>2017-12-26</th>
      <td>29464.000</td>
      <td>1060.000</td>
    </tr>
    <tr>
      <th>2017-12-27</th>
      <td>29810.000</td>
      <td>1095.000</td>
    </tr>
    <tr>
      <th>2017-12-28</th>
      <td>30184.000</td>
      <td>1065.000</td>
    </tr>
  </tbody>
</table>
<p>2229 rows × 2 columns</p>
</div>



---

## pivot()


```python
sample_data = pd.DataFrame(
    {
        "종목명":["삼성", "현대", "하이닉스", "삼성", "현대", "하이닉스"],
        "datetime":["2019-01-01", "2019-01-01", "2019-01-01", "2019-01-02", "2019-01-02", "2019-01-02"],
        "price":[1,2,3, 4,5,6]
    }
)
sample_data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목명</th>
      <th>datetime</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>삼성</td>
      <td>2019-01-01</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>현대</td>
      <td>2019-01-01</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>하이닉스</td>
      <td>2019-01-01</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>삼성</td>
      <td>2019-01-02</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>현대</td>
      <td>2019-01-02</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>하이닉스</td>
      <td>2019-01-02</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
sample_data.sort_values("종목명")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목명</th>
      <th>datetime</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>삼성</td>
      <td>2019-01-01</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>삼성</td>
      <td>2019-01-02</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>하이닉스</td>
      <td>2019-01-01</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>하이닉스</td>
      <td>2019-01-02</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>현대</td>
      <td>2019-01-01</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>현대</td>
      <td>2019-01-02</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
sample_data.pivot(index="datetime", columns="종목명", values="price")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>종목명</th>
      <th>삼성</th>
      <th>하이닉스</th>
      <th>현대</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-01-01</th>
      <td>1</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2019-01-02</th>
      <td>4</td>
      <td>6</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>



---

## join()


```python
left = pd.DataFrame({'A': ['A0', 'A1', 'A2'],
                     'B': ['B0', 'B1', 'B2']},
                      index=['K0', 'K1', 'K2']) 
left

right = pd.DataFrame({'C': ['C0', 'C2', 'C3'],
                    'D': ['D0', 'D2', 'D3']},
                      index=['K0', 'K2', 'K3'])
right
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>K0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>K1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>K2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>K0</th>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>K2</th>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>K3</th>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
left.join(right)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>K0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>K1</th>
      <td>A1</td>
      <td>B1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>K2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
left.join(right, how='outer')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>K0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>K1</th>
      <td>A1</td>
      <td>B1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>K2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>K3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>
</div>



---

## Example


```python
left = pd.DataFrame(
    {
        'A':['A0', 'A1', 'A2', 'A3'],
        'B':['B0', 'B1', 'B2', 'B3'],
        'key':['K0', 'K1', 'K0', 'K1'],
    }
)
right = pd.DataFrame(
    {
        'C':['C0', 'C1'],
        'D':['D0', 'D1'],
    },
    index=['K0', 'K1']
)
left
right
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>K0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>K1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>K0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>K1</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>K0</th>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>K1</th>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
left.join(right, on='key').set_index("key")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>K0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>K1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>K0</th>
      <td>A2</td>
      <td>B2</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>K1</th>
      <td>A3</td>
      <td>B3</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
left.set_index('key').join(right)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>K0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>K0</th>
      <td>A2</td>
      <td>B2</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>K1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>K1</th>
      <td>A3</td>
      <td>B3</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
a = pd.DataFrame([1,2,3], index=['a','b','c'], columns=['안녕'])
b = pd.DataFrame([4,2,6], index=['a','c','d'], columns=['안녕'])
a
b
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>안녕</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>안녕</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>4</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2</td>
    </tr>
    <tr>
      <th>d</th>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
a.join(b, lsuffix="_x", rsuffix="_y", how="inner")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>안녕_x</th>
      <th>안녕_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# default is outter
a.join(b, lsuffix="_x", rsuffix="_y")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>안녕_x</th>
      <th>안녕_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>4.000</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
      <td>2.000</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
a1_df = pd.read_csv("data/Small_and_Big.csv")
a_df = pd.read_csv("data/Small_and_Big.csv", index_col=[0])
a1_df.head()
a_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>date</th>
      <th>종목명</th>
      <th>PBR(IFRS-연결)</th>
      <th>베타 (M,5Yr)</th>
      <th>수익률(%)</th>
      <th>시가총액 (보통)(평균)(원)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2000-07-31</td>
      <td>BYC</td>
      <td>0.210</td>
      <td>0.479</td>
      <td>-0.580</td>
      <td>27786000000.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2000-07-31</td>
      <td>CJ</td>
      <td>0.510</td>
      <td>1.166</td>
      <td>-9.000</td>
      <td>1160889000000.000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2000-07-31</td>
      <td>CJ ENM</td>
      <td>6.560</td>
      <td>NaN</td>
      <td>17.400</td>
      <td>400467000000.000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2000-07-31</td>
      <td>CJ대한통운</td>
      <td>0.170</td>
      <td>1.314</td>
      <td>-7.960</td>
      <td>194962000000.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2000-07-31</td>
      <td>CJ씨푸드</td>
      <td>NaN</td>
      <td>0.227</td>
      <td>32.000</td>
      <td>1987000000.000</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>종목명</th>
      <th>PBR(IFRS-연결)</th>
      <th>베타 (M,5Yr)</th>
      <th>수익률(%)</th>
      <th>시가총액 (보통)(평균)(원)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-07-31</td>
      <td>BYC</td>
      <td>0.210</td>
      <td>0.479</td>
      <td>-0.580</td>
      <td>27786000000.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-07-31</td>
      <td>CJ</td>
      <td>0.510</td>
      <td>1.166</td>
      <td>-9.000</td>
      <td>1160889000000.000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-07-31</td>
      <td>CJ ENM</td>
      <td>6.560</td>
      <td>NaN</td>
      <td>17.400</td>
      <td>400467000000.000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-07-31</td>
      <td>CJ대한통운</td>
      <td>0.170</td>
      <td>1.314</td>
      <td>-7.960</td>
      <td>194962000000.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-07-31</td>
      <td>CJ씨푸드</td>
      <td>NaN</td>
      <td>0.227</td>
      <td>32.000</td>
      <td>1987000000.000</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
median_df = a_df.groupby(['date']).agg({'시가총액 (보통)(평균)(원)': 'median'})
median_df.columns = ['시가총액_median']
median_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>시가총액_median</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-07-31</th>
      <td>34947000000.000</td>
    </tr>
    <tr>
      <th>2000-08-31</th>
      <td>33684000000.000</td>
    </tr>
    <tr>
      <th>2000-09-30</th>
      <td>33684000000.000</td>
    </tr>
    <tr>
      <th>2000-10-31</th>
      <td>30523000000.000</td>
    </tr>
    <tr>
      <th>2000-11-30</th>
      <td>30798000000.000</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
joined_df = a_df.join(median_df, on="date")
joined_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>종목명</th>
      <th>PBR(IFRS-연결)</th>
      <th>베타 (M,5Yr)</th>
      <th>수익률(%)</th>
      <th>시가총액 (보통)(평균)(원)</th>
      <th>시가총액_median</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-07-31</td>
      <td>BYC</td>
      <td>0.210</td>
      <td>0.479</td>
      <td>-0.580</td>
      <td>27786000000.000</td>
      <td>34947000000.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-07-31</td>
      <td>CJ</td>
      <td>0.510</td>
      <td>1.166</td>
      <td>-9.000</td>
      <td>1160889000000.000</td>
      <td>34947000000.000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-07-31</td>
      <td>CJ ENM</td>
      <td>6.560</td>
      <td>NaN</td>
      <td>17.400</td>
      <td>400467000000.000</td>
      <td>34947000000.000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-07-31</td>
      <td>CJ대한통운</td>
      <td>0.170</td>
      <td>1.314</td>
      <td>-7.960</td>
      <td>194962000000.000</td>
      <td>34947000000.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-07-31</td>
      <td>CJ씨푸드</td>
      <td>NaN</td>
      <td>0.227</td>
      <td>32.000</td>
      <td>1987000000.000</td>
      <td>34947000000.000</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
joined_df[joined_df['date'] == "2000-08-31"].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>종목명</th>
      <th>PBR(IFRS-연결)</th>
      <th>베타 (M,5Yr)</th>
      <th>수익률(%)</th>
      <th>시가총액 (보통)(평균)(원)</th>
      <th>시가총액_median</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>573</th>
      <td>2000-08-31</td>
      <td>BYC</td>
      <td>0.220</td>
      <td>0.477</td>
      <td>3.500</td>
      <td>27221000000.000</td>
      <td>33684000000.000</td>
    </tr>
    <tr>
      <th>574</th>
      <td>2000-08-31</td>
      <td>CJ</td>
      <td>0.510</td>
      <td>1.165</td>
      <td>0.000</td>
      <td>1052967000000.000</td>
      <td>33684000000.000</td>
    </tr>
    <tr>
      <th>575</th>
      <td>2000-08-31</td>
      <td>CJ ENM</td>
      <td>6.730</td>
      <td>NaN</td>
      <td>2.680</td>
      <td>373822000000.000</td>
      <td>33684000000.000</td>
    </tr>
    <tr>
      <th>576</th>
      <td>2000-08-31</td>
      <td>CJ대한통운</td>
      <td>0.190</td>
      <td>1.312</td>
      <td>7.040</td>
      <td>189622000000.000</td>
      <td>33684000000.000</td>
    </tr>
    <tr>
      <th>577</th>
      <td>2000-08-31</td>
      <td>CJ씨푸드</td>
      <td>NaN</td>
      <td>0.222</td>
      <td>62.880</td>
      <td>2765000000.000</td>
      <td>33684000000.000</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# Hint: 아래와 같은 느낌으로 하시면 됩니다.
# cond1 = joined_df['시가총액(보통~~)'] <  joined_df['시가총액_median']
# joined_df.loc[cond1, "small_or_big"] = "small"
# joined_df.loc[~cond1, "small_or_big"] = "big"
```

---

## Merge()


```python
left = pd.DataFrame({'key1': ['K0', 'K0', 'K1', 'K2'],
                     'key2': ['K0', 'K1', 'K0', 'K1'],
                        'A': ['A0', 'A1', 'A2', 'A3'],
                        'B': ['B0', 'B1', 'B2', 'B3']})
    
right = pd.DataFrame({'key1': ['K0', 'K1', 'K1', 'K2'],
                               'key2': ['K0', 'K0', 'K0', 'K0'],
                                  'C': ['C0', 'C1', 'C2', 'C3'],
                                  'D': ['D0', 'D1', 'D2', 'D3']})

left
right
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K0</td>
      <td>K0</td>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K0</td>
      <td>K1</td>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>K2</td>
      <td>K1</td>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K0</td>
      <td>K0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K1</td>
      <td>K0</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K1</td>
      <td>K0</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>K2</td>
      <td>K0</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# default: inner join(교집합)
pd.merge(left, right, on=['key1', 'key2'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K0</td>
      <td>K0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# outer join(합집합)
pd.merge(left, right, how='outer', on=['key1', 'key2'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K0</td>
      <td>K0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K0</td>
      <td>K1</td>
      <td>A1</td>
      <td>B1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>K2</td>
      <td>K1</td>
      <td>A3</td>
      <td>B3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>K2</td>
      <td>K0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
pd.merge(left, right, how='right', on=['key1', 'key2'])
pd.merge(left, right, how='left', on=['key1', 'key2'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K0</td>
      <td>K0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>K2</td>
      <td>K0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K0</td>
      <td>K0</td>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K0</td>
      <td>K1</td>
      <td>A1</td>
      <td>B1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>K1</td>
      <td>K0</td>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>K2</td>
      <td>K1</td>
      <td>A3</td>
      <td>B3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
left = pd.DataFrame({'A':[1,2,], 'B':[2,2]})
right = pd.DataFrame({'A':[4,5,6], 'B':[2,2,2]})
left
right
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# left, right, inner, outer 결과가 다 같음
pd.merge(left, right, on="B", how='left')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A_x</th>
      <th>B</th>
      <th>A_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>2</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



---

## Example


```python
close_df = samsung_df['Close'].reset_index()
vol_df = samsung_df['Volume'].reset_index()
close_df.head()
vol_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Close</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>234</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-01-05</td>
      <td>223</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009-01-06</td>
      <td>212</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2009-01-07</td>
      <td>216</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2009-01-08</td>
      <td>215</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>2122</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-01-05</td>
      <td>6890</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009-01-06</td>
      <td>2144</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2009-01-07</td>
      <td>2434</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2009-01-08</td>
      <td>2280</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
vol_df.iloc[:2]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>2122</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-01-05</td>
      <td>6890</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# default is 'inner' join
pd.merge(close_df, vol_df.iloc[:2])   # 알아서 같은 column 이름끼리 맞춤
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Close</th>
      <th>Volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>234</td>
      <td>2122</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-01-05</td>
      <td>223</td>
      <td>6890</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# 'outer' join
pd.merge(close_df, vol_df.iloc[:2], how="outer").head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Close</th>
      <th>Volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2009-01-02</td>
      <td>234</td>
      <td>2122.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2009-01-05</td>
      <td>223</td>
      <td>6890.000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2009-01-06</td>
      <td>212</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2009-01-07</td>
      <td>216</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2009-01-08</td>
      <td>215</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



---

## join, merge 어디에 써야하나?

* join - index가 하나라도 관여
* merge - column에 맞춰야 한다면
    * merge를 사용할때 left_index, right_index를 사용하면 join과 같은 결과
    * join 사용시 reset_index 사용시 merge와 같은결과


```python
a = pd.DataFrame([1,2,3], index=['a','b','c'], columns=['안녕'])
b = pd.DataFrame([4,2,6], index=['a','c','d'], columns=['안녕'])
a
b
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>안녕</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>안녕</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>4</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2</td>
    </tr>
    <tr>
      <th>d</th>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
a.merge(b)
a.join(b, lsuffix="_x", rsuffix="_y", how="inner")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>안녕</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>안녕_x</th>
      <th>안녕_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
a.reset_index()
b.reset_index()
a.reset_index().merge(b.reset_index())
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>안녕</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>안녕</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>c</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>d</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>안녕</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



---


```python
a.merge(b, left_index=True, right_index=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>안녕_x</th>
      <th>안녕_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



---

## concat과 join, merge


```python
a = pd.DataFrame({"a": [1,2,3],}, index=[1,2,3])
b = pd.DataFrame({"b": [1,4,5],}, index=[1,4,5])
a
b
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
pd.concat([a, b], axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1.000</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>4.000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>5.000</td>
    </tr>
  </tbody>
</table>
</div>




```python
a = pd.DataFrame({"a": [1,2,3],}, index=[1,2,2])
b = pd.DataFrame({"b": [1,4,5],}, index=[1,4,5])
a
b
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# pd.concat([a, b], axis=1)
# error 발생! => concat()을 cartesian product가 불가능하기 때문에, 중복 index 혹은 column이 있는 경우 작동하지 못함
```

## Example


```python
product_df = pd.read_csv("data/product.csv", index_col=0)
review_df = pd.read_csv("data/review.csv", index_col=0)
product_df.head(2)
review_df.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>brand</th>
      <th>title</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>384</td>
      <td>apple</td>
      <td>apple iphone 6 (space grey, 32 gb)</td>
      <td>23999.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>385</td>
      <td>apple</td>
      <td>apple iphone 6s (space grey, 32 gb)</td>
      <td>33999.000</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product__id</th>
      <th>author</th>
      <th>rating</th>
      <th>title</th>
      <th>content</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>351</td>
      <td>Subhankar Mishra</td>
      <td>5.000</td>
      <td>AnyOne has ordered yet ?</td>
      <td>Has anyone ordered yet ? Please tell us your e...</td>
      <td>2011-07-22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>351</td>
      <td>Chinmay Chopade</td>
      <td>4.000</td>
      <td>It does what it says !!!</td>
      <td>I bought this phone and been using for last we...</td>
      <td>2011-08-23</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
flipkart_df = pd.merge(
    product_df, 
    review_df, 

    left_on="id",
    right_on='product__id',
    
    how='right',    # Review에 있는 id, 즉 product__id를 기준으로 데이터를 생성합니다. 만약 "product" 정보가 반드시 존재하는 review들로만 데이터를 구성하고 싶으면 "left"로 하시면 됩니다.
)  
flipkart_df.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>brand</th>
      <th>title_x</th>
      <th>price</th>
      <th>product__id</th>
      <th>author</th>
      <th>rating</th>
      <th>title_y</th>
      <th>content</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>351</td>
      <td>micromax</td>
      <td>micromax a70 (cocoa brown, 160 mb)</td>
      <td>7005.000</td>
      <td>351</td>
      <td>Subhankar Mishra</td>
      <td>5.000</td>
      <td>AnyOne has ordered yet ?</td>
      <td>Has anyone ordered yet ? Please tell us your e...</td>
      <td>2011-07-22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>351</td>
      <td>micromax</td>
      <td>micromax a70 (cocoa brown, 160 mb)</td>
      <td>7005.000</td>
      <td>351</td>
      <td>Chinmay Chopade</td>
      <td>4.000</td>
      <td>It does what it says !!!</td>
      <td>I bought this phone and been using for last we...</td>
      <td>2011-08-23</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
# column을 제거 하기 위해서는 drop([컬럼1, 컬럼2, ..], axis=1)과 같은 방식으로 진행합니다
flipkart_df = flipkart_df.drop(['id', 'product__id', 'author'], axis=1)
flipkart_df.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>brand</th>
      <th>title_x</th>
      <th>price</th>
      <th>rating</th>
      <th>title_y</th>
      <th>content</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>micromax</td>
      <td>micromax a70 (cocoa brown, 160 mb)</td>
      <td>7005.000</td>
      <td>5.000</td>
      <td>AnyOne has ordered yet ?</td>
      <td>Has anyone ordered yet ? Please tell us your e...</td>
      <td>2011-07-22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>micromax</td>
      <td>micromax a70 (cocoa brown, 160 mb)</td>
      <td>7005.000</td>
      <td>4.000</td>
      <td>It does what it says !!!</td>
      <td>I bought this phone and been using for last we...</td>
      <td>2011-08-23</td>
    </tr>
  </tbody>
</table>
</div>



---

## Example-2


```python
amazon_df = pd.read_csv("data/amazon_review1.csv", index_col=0)
amazon_df.head(2)
amazon_df.shape
flipkart_df.shape
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>brand</th>
      <th>title_x</th>
      <th>price</th>
      <th>title_y</th>
      <th>content</th>
      <th>rating</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-06-25</th>
      <td>apple</td>
      <td>apple iphone 5 (black-slate, 16gb)</td>
      <td>14499.000</td>
      <td>well an iphone is an iphone!</td>
      <td>Piece of art you like to keep holding onto, th...</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2013-06-25</th>
      <td>samsung</td>
      <td>samsung galaxy s4 gt-i9500 (white frost, 16gb)</td>
      <td>19439.000</td>
      <td>really a life companion device</td>
      <td>I got my S4 few days back n this device is awe...</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>






    (42190, 6)






    (27008, 7)



---


```python
df = pd.concat([amazon_df, flipkart_df], axis=0)   # `keys` argument를 활용하셔서 site를 구분하셔도 됩니다
df.shape
```




    (69198, 7)



---


```python
df['date'] = pd.to_datetime(df['date'])
df['price'] = df['price'].astype(float)

df.set_index('date', inplace=True)
df = df.loc[:"2017-12-31"]   # 비록 DatetimeIndex이지만, 날짜를 문자열 string으로 표현하여 loc을 이용한 range indexing이 가능합니다.

df.rename(columns={'title_x':'name', 'title_y':'title'}, inplace=True)

df['price_grp'] = pd.cut(df['price'], [0, 5000, 15000, 200000], labels=["저가", "중가", "고가"])
```

---


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>brand</th>
      <th>name</th>
      <th>price</th>
      <th>title</th>
      <th>content</th>
      <th>rating</th>
      <th>price_grp</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2011-07-22</th>
      <td>micromax</td>
      <td>micromax a70 (cocoa brown, 160 mb)</td>
      <td>7005.000</td>
      <td>AnyOne has ordered yet ?</td>
      <td>Has anyone ordered yet ? Please tell us your e...</td>
      <td>5.000</td>
      <td>중가</td>
    </tr>
    <tr>
      <th>2011-08-23</th>
      <td>micromax</td>
      <td>micromax a70 (cocoa brown, 160 mb)</td>
      <td>7005.000</td>
      <td>It does what it says !!!</td>
      <td>I bought this phone and been using for last we...</td>
      <td>4.000</td>
      <td>중가</td>
    </tr>
    <tr>
      <th>2011-08-23</th>
      <td>micromax</td>
      <td>micromax a70 (cocoa brown, 160 mb)</td>
      <td>7005.000</td>
      <td>Value for money</td>
      <td>Excellent phone altogether. Only negative poin...</td>
      <td>5.000</td>
      <td>중가</td>
    </tr>
    <tr>
      <th>2011-08-23</th>
      <td>micromax</td>
      <td>micromax a70 (cocoa brown, 160 mb)</td>
      <td>7005.000</td>
      <td>Good for Price and delivery speed....</td>
      <td>Worth for the money..... How much you are payi...</td>
      <td>5.000</td>
      <td>중가</td>
    </tr>
    <tr>
      <th>2011-09-15</th>
      <td>micromax</td>
      <td>micromax a70 (cocoa brown, 160 mb)</td>
      <td>7005.000</td>
      <td>FLIPKART ROCKS</td>
      <td>i am a regular user of ebay india, and i usual...</td>
      <td>5.000</td>
      <td>중가</td>
    </tr>
  </tbody>
</table>
</div>



---

## Example-3


```python
# 아래에서 보이시는 것처럼 groupby()의 인자에는 반드시 'column명'이 아니어도 됩니다.
# 아래 예제처럼 df라는 object로부터 추출할 수 있는(여기서는 df.index에서 추출한) categorical 변수들을 사용해도 됩니다.
df.groupby([df.index.year, df.index.quarter]).agg({'price':'mean'})
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>price</th>
    </tr>
    <tr>
      <th>date</th>
      <th>date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2011</th>
      <th>3</th>
      <td>7005.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6564.214</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">2012</th>
      <th>1</th>
      <td>5837.250</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4456.945</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5203.164</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8851.987</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">2013</th>
      <th>1</th>
      <td>8228.694</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13098.951</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10574.770</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10106.358</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">2014</th>
      <th>1</th>
      <td>8955.434</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8895.550</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8969.058</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12091.026</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">2015</th>
      <th>1</th>
      <td>10409.730</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17200.320</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16498.556</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18839.613</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">2016</th>
      <th>1</th>
      <td>21684.773</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19896.658</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17594.872</td>
    </tr>
    <tr>
      <th>4</th>
      <td>23765.043</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">2017</th>
      <th>1</th>
      <td>17576.598</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19595.137</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17528.829</td>
    </tr>
    <tr>
      <th>4</th>
      <td>27268.716</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
df.groupby([df.index.year, df.index.quarter]).agg({'price':'mean'}).plot(kind='bar')

'''
ax = df.resample("Q")['price'].mean().plot();

ax.set_title("기간별 제품 평균가격");
ax.set_xlabel("기 간");
ax.set_ylabel("가 격");
'''
```

---

## Example-4


```python
df.groupby(['brand']).agg({'name':'count'})

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
    </tr>
    <tr>
      <th>brand</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>apple</th>
      <td>5399</td>
    </tr>
    <tr>
      <th>mi</th>
      <td>1558</td>
    </tr>
    <tr>
      <th>micromax</th>
      <td>8078</td>
    </tr>
    <tr>
      <th>samsung</th>
      <td>7284</td>
    </tr>
  </tbody>
</table>
</div>



---


```python
df.groupby(['brand']).agg({'name':'count'}).plot(kind='bar', figsize=(8,5));
```


    
![png](output_170_0.png)
    

