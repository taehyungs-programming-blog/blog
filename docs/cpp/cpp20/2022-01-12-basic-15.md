---
layout: default
title: 15. std-span
parent: (C++20)
grand_parent: C++
nav_order: 2
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

ğŸ˜º `std::span`ì´ë€? ğŸ‘‰ Cë°°ì—´, `std::array`, `std::vector`, `std::string` ... ë“±ì˜ ì—°ì´ì€ ê°ì²´ ì‹œí€€ìŠ¤ (contiguous sequence of objects)ë¥¼ ì°¸ì¡°(refer)ì§€ì›

```cpp
// Cíƒ€ì… ë°°ì—´
int arr[] = {1,2,3,4,5};
const int size = sizeof(arr);               // 20(5*4) -> 20ë°”ì´íŠ¸
const int len = sizeof(arr) / sizeof(int);  // 5 -> ë°ì´í„°ê°€ 5ê°œ
//PrintArray(arr, len);                     // ë¬¸ì œëŠ” ì—¬ê¸°ì„œ ë°œìƒ, í¬ì¸í„°ë¡œ ë„˜ê¸°ê¸°ì— ë°°ì—´ì˜ ì •ë³´ë¥¼ ë„˜ê¸¸ìˆ˜ ì—†ë‹¤ / ë”°ë¼ì„œ ë°°ì—´ì˜ ê¸¸ì´ê¹Œì§€ ë„˜ê¸°ê²Œ ëœë‹¤

// ...

void PrintArray(int* arr, int len)
{
	cout << "array size() = " << len << endl;
	for (int i = 0; i < len; i++)
		cout << arr[i] << endl;
        // arr[i] = 10; // overwriteì˜ ìœ„í—˜ì´ë‚˜
        // ë©”ëª¨ë¦¬ ì˜¤ì ‘ê·¼ì˜ ìœ„í—˜ë˜í•œ ìˆìŒ.
}
```

<br>

ğŸ˜º std::spanìœ¼ë¡œ í•´ê²°í•´ë³´ì

```cpp
void Print(std::span<int> container)
{
	cout << "container size() = " << container.size() << endl;
	for (int i = 0; i < container.size(); i++)
		cout << container[i] << endl;
}

// ...

int arr[] = {1,2,3,4,5};
Print(arr);
```

<br>

ğŸ˜º ì°¸ê³ ë¡œ spanì€ ë‘ ê°€ì§€ ì¢…ë¥˜ê°€ ìˆë‹¤

* std::span
    - static_extent : ì»´íŒŒì¼ íƒ€ì„ì— í¬ê¸°ê°€ ì •í•´ì§
    - dynamic_extent : í¬ì¸í„° + í¬ê¸°
    - spanì˜ ì›í˜• : `<type T, size_t Extent = dynamic_extent>`

```cpp
vector<int> myVec{1,2,3,4,5};
vector<int> myVec2{6,7,8,9,10};

// dynamic ë°©ì‹
std::span<int> dynamicSpan(myVec);

// static ë°©ì‹
std::span<int, 5/*í¬ê¸°ë¥¼ ì§€ì •*/> staticSpan(myVec2);


// dynamicì— staticì„ ë„£ì„ìˆœ ìˆìœ¼ë‚˜
dynamicSpan = staticSpan;

// staticì— dynamicì„ ë„£ì„ìˆœ ì—†ë‹¤
// staticSpan = dynamicSpan; // ERROR
```

<br>

ğŸ˜º spanì„ ìƒì„±í•˜ëŠ” ë‹¤ì–‘í•œ ë°©ë²•

```cpp
// í¬ì¸í„°/ì‚¬ì´ì¦ˆë¥¼ ì´ìš©í•´ì„œ span ìƒì„±
std::span<int> span1(myVec.data(), myVec.size());
Print(span1);

// ë¶€ë¶„ì ìœ¼ë¡œ ì˜ë¼ì„œ ë§Œë“¤ê¸°
std::span<int> span2(span1.subspan(1, span1.size() - 3));
Print(span2);

// 1~2 ë²”ìœ„ ëŒ€ìƒìœ¼ë¡œ, 4í•¨ìˆ˜ ì‹¤í–‰í•œ ë‹¤ìŒ, 3ì— ê¸°ë¡
std::transform(span1.begin(), span1.end(), span1.begin(), [](int i) { return i*i; });
Print(span1);
Print(myVec); // ì›ë³¸ ë°ì´í„°ê°€ ìˆ˜ì •ë¨!
```