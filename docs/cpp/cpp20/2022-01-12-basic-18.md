---
layout: default
title: "18. ë¹„íŠ¸ì—°ì‚°"
parent: (C++20)
grand_parent: C++
nav_order: 2
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

ğŸ˜º ë¹„íŠ¸ì—°ì‚°ì€ ì–¸ì œì‚¬ìš©í•˜ë©´ ì¢‹ì„ê¹Œ? ğŸ‘‰ ì˜ˆë¡œì„œ ì„¤ëª…

```cpp
// í”¼ìì§‘ : í”¼ì ì£¼ë¬¸í•˜ëŠ”ë°, 0~19ë²ˆ ìŠ¤ë¬´ê°€ì§€ì˜ í† í•‘ì´ ì¡´ì¬

// ë°°ì—´ë¡œ ì²˜ë¦¬í•œë‹¤?
// bool toppings[20];   // í† í•‘ì´ 20ê°œë¼ì„œ ë‹¤í–‰ì´ì§€ 1000ê°œ 10000ê°œë¼ë©´?? ì—„ì²­ë‚œ ë©”ëª¨ë¦¬ ë‚­ë¹„ì´ë‹¤.

// bitì—°ì‚°ìœ¼ë¡œ í•´ê²°í•´ ë³´ì
// ëª¨ë“  í† í•‘ì„ ë‹¤ ë„£ì–´ë‹¬ë¼
unsigned int fullPizza = (1 << 20) - 1; // 0111111... ì´ ë˜ê²Œ ë¨.

// ì¶”ê°€
enum { PEPPERONI = 3 };
unsigned int toppings = 0;
toppings |= (1 << PEPPERONI); // 3ë²ˆ í† í•‘ ì¶”ê°€

// í¬í•¨ ì—¬ë¶€ í™•ì¸
bool added = (toppings & (1 << PEPPERONI));

// ì‚­ì œ
toppings &= ~(1 << PEPPERONI);

// í† ê¸€
toppings ^= (1 << PEPPERONI);

// ê°œìˆ˜ êµ¬í•˜ê¸°
int count = BitCount(toppings);

unsigned int BitCount(unsigned int flag)
{
	if (flag == 0)
		return 0;
    // /2ë¥¼ í•œë‹¤ëŠ”ê²Œ 2ì§„ìˆ˜ì˜ ë§ˆì§€ë§‰ ìë¦¬ë¥¼ ì œê±°í•˜ëŠ” ê²ƒì´ë‹¤.
    // 0b1010 / 2
    // 0b101 / 2
    // 0b10 / 2
    // 0b1
    // ë­ ì´ëŸ°ì‹
	return flag % 2 + BitCount(flag / 2);
}


// ìµœì†Œ ì›ì†Œ ì°¾ê¸°
// (ëì— ë¶™ì–´ìˆëŠ” 0ì€ ëª‡ê°œì¸ê°€?)
// Visual C++ : _BitScanForward(&index, toppings)
// gcc : __builtin_ctz(toppings);
```

<br>

ğŸ˜º C++20ì—ì„œëŠ” ì–´ë–»ê²Œ ë³€í–ˆì„ê¹Œ?

```cpp
// ì—”ë””ì•ˆì²´í¬ê°€ ê°€ëŠ¥í•´ ì¡Œë‹¤
int b = 0x11223344;
// [44 33 22 11] little
// [11 22 33 44] big

// ë„¤íŠ¸ì›Œí¬, íŒŒì¼ ì…ì¶œë ¥
if (std::endian::native == std::endian::big)
{
    cout << "big" << endl;
}
else
{
    cout << "little" << endl;
}
```

```cpp
float n1 = 1.0f;
int n2 = static_cast<int>(n1);
int n3 = bit_cast<int>(n1);

// bit_cast : ìƒˆë¡œìš´ ìºìŠ¤íŒ…
// has_single_bit	: ì–´ë–¤ ìˆ«ìê°€ 2^n í˜•íƒœì¸ì§€ (2ì˜ ê±°ë“­ì œê³±)
// popcount : unsigned int ìˆ«ìì—ì„œ 1ì˜ ê°œìˆ˜
// bit_ceil : í•´ë‹¹ ê°’ë³´ë‹¤ ì‘ì§€ ì•Šì€ (2ì˜ ê±°ë“­ì œê³±)ì¤‘ ì œì¼ ì‘ì€ ê²ƒ (floor < num < ceil)
// bit_floor : í•´ë‹¹ ê°’ë³´ë‹¤ í¬ì§€ ì•Šì€ (2ì˜ ê±°ë“­ì œê³±)ì¤‘ ì œì¼ í° ê²ƒ (floor < num < ceil)
// bit_width : í•´ë‹¹ ê°’ì„ í‘œí˜„í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ìµœì†Œ ë¹„íŠ¸ ê°œìˆ˜
// rotl : bitwise left-rotation
// rotr : bitwise right-rotation
// countl_zero : ì œì¼ í° ë¹„íŠ¸ë¶€í„° ì‹œì‘í•´ì„œ, ì—°ì†ëœ 0ì˜ ê°œìˆ˜
// countl_one : ì œì¼ í° ë¹„íŠ¸ë¶€í„° ì‹œì‘í•´ì„œ, ì—°ì†ëœ 1ì˜ ê°œìˆ˜
// countr_zero : ì œì¼ ì‘ì€ ë¹„íŠ¸ë¶€í„° ì‹œì‘í•´ì„œ, ì—°ì†ëœ 0ì˜ ê°œìˆ˜
// countr_one : ì œì¼ ì‘ì€ ë¹„íŠ¸ë¶€í„° ì‹œì‘í•´ì„œ, ì—°ì†ëœ 1ì˜ ê°œìˆ˜

std::uint8_t num = 0b00110010;
cout << boolalpha;

cout << std::has_single_bit(num) << endl; // false
cout << popcount(num) << endl; // 3
cout << std::bitset<8>(std::bit_ceil(num)) << endl; // 0b01000000
cout << std::bitset<8>(std::bit_floor(num)) << endl; // 
cout << std::bit_width(5u) << endl; // width(0x000101) = 3
cout << std::bitset<8>(std::rotl(num, 2)) << endl; // 0b11001000
cout << std::bitset<8>(std::rotr(num, 2)) << endl; // 0b10001100
cout << countl_zero(num) << endl; // 2
cout << countl_one(num) << endl; // 0
cout << countr_zero(num) << endl; // 1
cout << countr_one(num) << endl; // 0
```