---
layout: default
title: 8. consteval, constinit
parent: (C++20)
grand_parent: C++
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

ğŸ˜º ì•„ë˜ ì…‹ì˜ ì°¨ì´ì ì´ ë­˜ê¹Œ?

```cpp
int SqrRunTime(int n)
{
    return n * n;
}

// C++11
constexpr int SqrRunOrCompileTime(int n)
{
    return n * n;
}

// C++20
consteval int SqrCompileTime(int n)
{
    return n * n;
}

int val1 = SqrRunTime(10);          // í•­ìƒ run-timeì— ê³„ì‚°ì´ ëœë‹¤.
int val2 = SqrRunOrCompileTime(10); // Compile-time í˜¹ì€ run-time(ì—¬ê¸°ì„œëŠ” run-time)
constexpr int val2-2 = SqrRunOrCompileTime(10); // ì´ê±´ compile-time
int val3 = SqrCompileTime(10);      // ë¬´ì¡°ê±´ Compile-timeì— ê°•ì œí•´ë‹¬ë¼
```

<br>

* consteval íŠ¹ì§•(ê·¸ëƒ¥ ì•Œì•„ë§Œ ë‘ì)
    - ì¡°ê±´ë¶€(ifë¬¸), jump, loop ê°€ëŠ¥
    - ë‹¤ìˆ˜ì˜ ëª…ë ¹ì–´ë¡œ êµ¬ì„± ê°€ëŠ¥
    - ë‚´ë¶€ì—ì„œ ë‹¤ì‹œ constexpr í•¨ìˆ˜ í˜¸ì¶œ ê°€ëŠ¥
    - static, thread_local ì•ˆ ë¨
    - try, goto ì•ˆ ë¨
    - non-consteval í•¨ìˆ˜ í˜¸ì¶œ ì•ˆ ë¨
    - non-constexpr ë°ì´í„° ì‚¬ìš© ì•ˆ ë¨

ğŸ˜º ë³€ìˆ˜ì—ë„ `consteval`ì´ ì‚¬ìš©ê°€ëŠ¥í• ê¹Œ?

* const, constexpr, constinit ì°¨ì´ì 
    * const - compile, run timeì€ ìƒê´€ì—†ì´ constness(ìƒìˆ˜ì„±)ë§Œ ìˆìœ¼ë©´ ë¨.
        * `const int constIntVal = SqrRunTime(10); /*SqrRunTime : ëŸ°íƒ€ì„ ì‹¤í–‰*/` ì´ëŸ°ê²Œ ê°€ëŠ¥í•˜ë‹¤
        * ëŸ°íƒ€ì„ì—ë„ constì„ ì–¸ì´ ê°€ëŠ¥í•˜ë‹¤ê°€ í•µì‹¬.
    * constexpr - ì˜¤ì§ compile-timeì— ì„ ì–¸ì´ ë˜ì–´ì•¼ í•œë‹¤ + ìƒìˆ˜ì„±ì´ ë³´ì¥ë˜ì–´ì•¼ í•œë‹¤
        * `constexpr int constExprVal = SqrCompileTime(10);` - Okay
        * `constexpr int constIntVal = SqrRunTime(10);` - Error
    * constinit - compile-timeì— ì„ ì–¸ë˜ì–´ì•¼ í•˜ë©° + ìƒìˆ˜ì„±ì€ ì—†ì–´ë„ ëœë‹¤. + static/thread_localì— ì‚¬ìš©ëœë‹¤.
        * global ë³€ìˆ˜, static ë³€ìˆ˜, thread_local ë³€ìˆ˜ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì‚¬ìš©
            * í”„ë¡œê·¸ë¨ ì‹œì‘ ì‹œ ë©”ëª¨ë¦¬ í• ë‹¹, í”„ë¡œê·¸ë¨ì´ ëë‚˜ë©´ ë©”ëª¨ë¦¬ í•´ì œ
            * thread_local ë³€ìˆ˜ëŠ” threadì— ì¢…ì†ì . íŠ¹ì • threadê°€ í•´ë‹¹ ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ë•Œ ìƒì„±ë¨.
        * `constinit thread_local int constInitVal = SqrCompileTime(10);`
        * `constInitVal++;` - Okay