---
layout: default
title: "10. ixwebsocket vs curl"
parent: "(OpenSource ğŸ‘¨â€ğŸ’»)"
grand_parent: (C++)
nav_order: 2
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

```
-G "Visual Studio 17 2022" -DCMAKE_TOOLCHAIN_FILE=%USERPROFILE%/scoop/apps/vcpkg/current/scripts/buildsystems/vcpkg.cmake
```

```makefile
cmake_minimum_required(VERSION 3.10)
project(https_request_test)

# VS2022ìš© UTF-8 ì„¤ì •
if(MSVC)
    add_compile_options(/utf-8)
endif()

find_package(CURL REQUIRED)
find_package(ixwebsocket REQUIRED)

add_executable(main main.cpp)
if(WIN32)
    target_link_libraries(main PRIVATE 
        CURL::libcurl
        ixwebsocket::ixwebsocket
        bcrypt
    )
else()
    target_link_libraries(main PRIVATE 
        CURL::libcurl
        ixwebsocket::ixwebsocket
    )
endif()
```

* í™•ì¸í•˜ê³ ì í•˜ëŠ”ê±´ ixwebsocketì—ì„œ ê¸°ë³¸(ì‹œìŠ¤í…œê¸°ë³¸) ì¸ì¦ì„œë¥¼ ì‚¬ìš©ê°€ëŠ¥í•œì§€ ì—¬ë¶€ì´ë‹¤.
    * **ê²°ë¡ ** : ì•ˆëœë‹¤.

```cpp
#include <ixwebsocket/IXHttpClient.h>
#include <curl/curl.h>
#include <iostream>
#include <string>
#include <windows.h>

// ì½˜ì†” í•œê¸€ ì¶œë ¥ì„ ìœ„í•œ ì„¤ì •
void setConsoleOutputCP() {
    SetConsoleOutputCP(CP_UTF8);
    std::cout.imbue(std::locale("Korean"));
}

// CURL ì‘ë‹µ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ ì½œë°± í•¨ìˆ˜
size_t WriteCallback(void* contents, size_t size, size_t nmemb, std::string* userp) {
    userp->append((char*)contents, size * nmemb);
    return size * nmemb;
}

// CURLì„ ì‚¬ìš©í•œ HTTPS ìš”ì²­
void testCurlRequest() {
    std::cout << "\n=== CURL HTTPS ìš”ì²­ í…ŒìŠ¤íŠ¸ ===" << std::endl;
    
    CURL* curl = curl_easy_init();
    if (curl) {
        std::string response_string;
        struct curl_slist* headers = NULL;
        headers = curl_slist_append(headers, "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)");
        
        // CURL ì˜µì…˜ ì„¤ì •
        curl_easy_setopt(curl, CURLOPT_URL, "https://api.github.com/users/octocat");
        curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, WriteCallback);
        curl_easy_setopt(curl, CURLOPT_WRITEDATA, &response_string);
        curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);
        
        // SSL ì¸ì¦ì„œ ê²€ì¦ ì„¤ì •
        curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 1L);
        curl_easy_setopt(curl, CURLOPT_SSL_VERIFYHOST, 2L);
        
        #ifdef _WIN32
        curl_easy_setopt(curl, CURLOPT_SSL_OPTIONS, CURLSSLOPT_NATIVE_CA);
        #endif
        
        // HTTPS ìš”ì²­ ì‹¤í–‰
        CURLcode res = curl_easy_perform(curl);
        
        if (res == CURLE_OK) {
            long response_code;
            curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, &response_code);
            std::cout << "ìƒíƒœ ì½”ë“œ: " << response_code << std::endl;
            std::cout << "ì‘ë‹µ ë°ì´í„°: " << response_string.substr(0, 100) << "..." << std::endl;
        } else {
            std::cout << "ìš”ì²­ ì‹¤íŒ¨: " << curl_easy_strerror(res) << std::endl;
        }
        
        curl_slist_free_all(headers);
        curl_easy_cleanup(curl);
    }
}

// IXWebSocketì„ ì‚¬ìš©í•œ HTTPS ìš”ì²­
void testIXWebSocketRequest() {
    std::cout << "\n=== IXWebSocket HTTPS ìš”ì²­ í…ŒìŠ¤íŠ¸ ===" << std::endl;
    
    ix::HttpClient httpClient;
    
    // SSL ì˜µì…˜ ì„¤ì •
    ix::SocketTLSOptions tlsOptions;
    #ifdef _WIN32
    tlsOptions.caFile = ""; // Windowsì—ì„œëŠ” ì‹œìŠ¤í…œ ì¸ì¦ì„œ ì‚¬ìš©
    tlsOptions.tls = true;
    #endif
    httpClient.setTLSOptions(tlsOptions);
    
    // HTTP í—¤ë” ì„¤ì •
    ix::HttpRequestArgsPtr args = std::make_shared<ix::HttpRequestArgs>();
    args->extraHeaders["User-Agent"] = "Mozilla/5.0 (Windows NT 10.0; Win64; x64)";
    
    // HTTPS ìš”ì²­ ì‹¤í–‰
    auto response = httpClient.get("https://api.github.com/users/octocat", args);
    
    if (response->statusCode == 200) {
        std::cout << "ìƒíƒœ ì½”ë“œ: " << response->statusCode << std::endl;
        std::cout << "ì‘ë‹µ ë°ì´í„°: " << response->body.substr(0, 100) << "..." << std::endl;
    } else {
        std::cout << "ìš”ì²­ ì‹¤íŒ¨: " << response->errorMsg << std::endl;
        std::cout << "ì—ëŸ¬ ì½”ë“œ: " << response->statusCode << std::endl;
    }
}

int main() {
    // ì½˜ì†” í•œê¸€ ì¶œë ¥ ì„¤ì •
    setConsoleOutputCP();
    
    // CURL ì´ˆê¸°í™”
    curl_global_init(CURL_GLOBAL_DEFAULT);
    
    // CURL í…ŒìŠ¤íŠ¸
    testCurlRequest();
    
    // IXWebSocket í…ŒìŠ¤íŠ¸
    testIXWebSocketRequest();
    
    // CURL ì •ë¦¬
    curl_global_cleanup();
    
    return 0;
}
```