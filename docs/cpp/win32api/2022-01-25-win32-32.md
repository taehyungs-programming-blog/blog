---
layout: default
title: "32. DShow(Direct Show)"
parent: (Windows API)
grand_parent: C++
nav_order: 4
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

## DShow Best Example

* [Github ğŸŒ(VS2019ì—ì„œ ë¹Œë“œê°€ëŠ¥í•˜ê²Œ ì‹œë‚˜ë¦¬ì˜¤ êµ¬ì„±ë¨)](https://github.com/roman380/Windows-classic-samples/tree/directshow)

---

## Filter, Pin, Filter graph

* [ì°¸ê³ ì‚¬ì´íŠ¸ ğŸŒ](https://blog.naver.com/netrance/110049276005)

* Filter : ë©€í‹°ë¯¸ë””ì–´ ì‘ì—…ì˜ ë¶€ë¶„(Set)ì„ ì˜ë¯¸
* Pin : Filterì™€ Filterì˜ ì—°ê²°ì— ì‚¬ìš©ë˜ëŠ” ê°ì²´
* Filter graph : Filterì˜ ì§‘í•©

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/cpp/win32api/win32-32-1.png" style="border-radius:5%;border:1px solid #e6e1e8"/>
</p>

<br>

### ìœ„ ì„¤ëª…ìœ¼ë¡œ ì´í•´ê°€ ì•ˆë ìˆ˜ ìˆìœ¼ë‹ˆ ì˜ˆì‹œë¡œ ì„¤ëª…í•˜ìë©´

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/cpp/win32api/win32-32-2.png" style="border-radius:5%;border:1px solid #e6e1e8"/>
</p>

<br>

* **ì†ŒìŠ¤ í•„í„° (source filter)** - í•„í„° ê·¸ë˜í”„ì˜ ì‹œì‘ì ì— í•´ë‹¹ë˜ë©°, ë©€í‹°ë¯¸ë””ì–´ ì‘ì—…ì„ ì§„í–‰í•˜ê¸° ìœ„í•´ íŒŒì¼ì„ ì½ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ìœ„ ê·¸ë¦¼ì—ì„œëŠ” ì œì¼ ì™¼ìª½ì— ìˆëŠ” í•„í„°ê°€ ì†ŒìŠ¤ í•„í„°ì— í•´ë‹¹ë©ë‹ˆë‹¤.
* **ìŠ¤í”Œë¦¬í„° í•„í„° (splitter filter)** - 2ì¢…ë¥˜ ì´ìƒì˜ ë°ì´í„°ë“¤ì„ êµ¬ë³„í•˜ëŠ” ì—­í• ì„ ë§¡ìŠµë‹ˆë‹¤. ì…ë ¥ í•€ìœ¼ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ê³ , ì¢…ë¥˜ë¥¼ êµ¬ë³„í•œ í›„ 2ê°œ ì´ìƒì˜ ì¶œë ¥ í•€ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë‚´ë³´ëƒ…ë‹ˆë‹¤. ì´ í•„í„°ëŠ” ì£¼ë¡œ ë™ì˜ìƒ íŒŒì¼ì„ ì¬ìƒí•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì˜ìƒê³¼ ìŒì„± ë°ì´í„°ë¥¼ êµ¬ë³„í•˜ê¸° ìœ„í•´ì„œì£ . ì˜ˆë¥¼ ë“¤ì–´, MPG íŒŒì¼ ì¬ìƒì‹œ ìŠ¤í”Œë¦¬í„° í•„í„°ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.
* **íŠ¸ëœìŠ¤í¼ í•„í„° (transform filter)** - ì…ë ¥ í•€ìœ¼ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì•„ ì²˜ë¦¬í•œ í›„ ì¶œë ¥ í•€ìœ¼ë¡œ ë³´ë‚´ëŠ” ì—­í• ì„ ë§¡ìŠµë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì¸ì½”ë”©/ë””ì½”ë”© ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆìœ¼ë©°, ì´ ë•Œ ì¸ì½”ë”/ë””ì½”ë”ë¼ ë¶€ë¥´ê¸°ë„ í•©ë‹ˆë‹¤. ìœ„ ê·¸ë¦¼ì—ì„œëŠ” WMAudio Decoder DMO, WMVideo Decoder DMO í•„í„°ë“¤ì´ ì´ì— í•´ë‹¹ë©ë‹ˆë‹¤.
* **ë Œë”ëŸ¬ í•„í„° (renderer filter)** - ì…ë ¥ í•€ìœ¼ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì•„ ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì£¼ëŠ” ì—­í• ì„ ë§¡ëŠ” í•„í„°ì…ë‹ˆë‹¤. ìœ„ ê·¸ë¦¼ì—ì„œëŠ” Default DirectSound Device, Video Renderer í•„í„°ë“¤ì´ ì´ì— í•´ë‹¹ë©ë‹ˆë‹¤.

---

## Capture graph, Capture graph builder

* [ì°¸ê³ ì‚¬ì´íŠ¸ ğŸŒ](https://blog.naver.com/netrance/110084545346)

* Capture graph : ìº¡ì²˜ ê·¸ë˜í”„ëŠ” í•„í„° ê·¸ë˜í”„ì˜ ì¼ì¢…ì´ë©°, ë¹„ë””ì˜¤ë‚˜ ì˜¤ë””ì˜¤ë¥¼ ìº¡ì²˜í•˜ëŠ” ê¸°ëŠ¥ì„ í•©ë‹ˆë‹¤. ë¯¸ë””ì–´ íŒŒì¼ì„ ì¬ìƒí•˜ëŠ” í•„í„° ê·¸ë˜í”„ì™€ëŠ” í˜•íƒœê°€ ë‹¤ë¥´ë©°, ë³´ë‹¤ ë³µì¡í•˜ê¸° ë•Œë¬¸ì— ì´ë¦„ì„ ë”°ë¡œ ë¶™ì¸ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.

### Capture Graph Builder, Graph Builder

* [ì°¸ê³ ì‚¬ì´íŠ¸(MSDN) ğŸŒ](https://docs.microsoft.com/en-us/windows/win32/directshow/about-the-capture-graph-builder)

* ì´ë¦„ì´ ë¹„ìŠ·í•´ì„œ í—·ê°ˆë¦´ìˆ˜ ìˆëŠ”ë° ì•„ë˜ë¥¼ ì°¸ê³ 

```cpp
HRESULT InitCaptureGraphBuilder(
  IGraphBuilder **ppGraph,  // Receives the pointer.
  ICaptureGraphBuilder2 **ppBuild  // Receives the pointer.
)
{
    if (!ppGraph || !ppBuild)
    {
        return E_POINTER;
    }
    IGraphBuilder *pGraph = NULL;
    ICaptureGraphBuilder2 *pBuild = NULL;

    // Create the Capture Graph Builder.
    HRESULT hr = CoCreateInstance(CLSID_CaptureGraphBuilder2, NULL, 
        CLSCTX_INPROC_SERVER, IID_ICaptureGraphBuilder2, (void**)&pBuild );
    if (SUCCEEDED(hr))
    {
        // Create the Filter Graph Manager.
        hr = CoCreateInstance(CLSID_FilterGraph, 0, CLSCTX_INPROC_SERVER,
            IID_IGraphBuilder, (void**)&pGraph);
        if (SUCCEEDED(hr))
        {
            // Initialize the Capture Graph Builder.
            // CaptureGraphBuilerì™€ GraphBuilderë¥¼ ë”°ë¡œë§Œë“¤ê³ 
            // GraphBuilderë¥¼ ì—°ê²°í•¨ì„ í™•ì¸
            pBuild->SetFiltergraph(pGraph);

            // Return both interface pointers to the caller.
            *ppBuild = pBuild;
            *ppGraph = pGraph; // The caller must release both interfaces.
            return S_OK;
        }
        else
        {
            pBuild->Release();
        }
    }
    return hr; // Failed
}
```