---
layout: default
title: "46. Unicode"
parent: (IOCP)
grand_parent: C++
nav_order: 5
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

ğŸ‘€ ë¬¸ìì—´(string, wsring)ì€ ì–´ë–»ê²Œ ë³´ë‚¼ê¹Œ?

```cpp
// ìš°ì„  ë“¤ì–´ê°€ê¸° ì „ ë‹¤ìŒì˜ ì°¨ì´ë¥¼ ì´í•´í•´ ë³´ì.

char snedData[1000] = "ê°€";
char snedData[1000] = u8"ê°€";
WCHAR snedData[1000] = L"ê°€";
TCHAR snedData[1000] = _T("ê°€");

// ê°€ë³€ê¸¸ì´ ë¬¸ìì—´ì€ ìœ„ì™€ê°™ì´ ë‹¤ì–‘í•˜ê²Œ í‘œê¸°ê°€ ê°€ëŠ¥í•œë° ë¬´ìŠ¨ì°¨ì¼ê¹Œ?
// ì„œë²„ì™€ í´ë¼ëŠ” ì´ëŸ° ë³µì¡í•œ ë¬¸ìì—´ì„ ì–´ë–»ê²Œ ë§ì¶°ì•¼í• ê¹Œ?
```

## ë¬¸ì(Character)

### ASCII Codeì™€ Unicodeì˜ ë“±ì¥

ğŸ‘€ ì²˜ìŒì€ **ASCII Code(ë¬¸ìì§‘í•©)**ë¡œ ë¬¸ìë¥¼ í‘œí˜„ (Ex> A == 0x41(65))<br>
ğŸ‘€ ë‹¨, ì„œë¡œ ë‹¤ë¥¸ ë¬¸ìì§‘í•©ì„ ì‚¬ìš©í•  ê²½ìš° ë¬¸ì œê°€ ë°œìƒí•¨. (Ex> ì˜ì–´ë¥¼ ë¬¸ìì§‘í•©ìœ¼ë¡œ ì“°ëŠ” Aë¼ëŠ” ì»´í“¨í„°ì—ì„œ í•œê¸€ì„ ë¬¸ìì§‘í•©ìœ¼ë¡œ ì“°ëŠ” Bë¼ëŠ” ì»´í“¨í„°ì—ì„œ ì‘ì„±ëœ ë¬¸ì„œë¥¼ ì½ì„ê²½ìš° ê¹¨ì§„ ë¬¸ìë¡œ ë‚˜íƒ€ë‚˜ê²Œ ëœë‹¤.)<br>
ğŸ‘€ ë¬¸ìì§‘í•©ì„ ë¯¸ë¦¬ ì•Œì•„ì•¼ í•œë‹¤ëŠ” ë§ì¸ë° ... ë¬¸ìì§‘í•© êµ¬ë¶„ì´ ì—†ëŠ” ë¬¸ì ì²´ê³„ë¥¼ ì¨ë³´ì. ğŸ‘‰ **UNICODE** ë“±ì¥

### Encodingì˜ ë“±ì¥

ğŸ‘€ Unicodeë¼ê³  ì¥ì ë§Œ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.<br>
ğŸ‘€ ì˜ì–´ë§Œ ì£¼ë¡œ ì“°ëŠ” í™˜ê²½ì—ì„œ UNICODEëŠ” ë³´í†µ 2ë°”ì´íŠ¸ë¥¼ ì“°ëŠ”ë° ì´ê²Œ ê³¼ì—° íš¨ìœ¨ì ì¸ê°€??<br>
ğŸ‘€ ê·¸ëƒ¥ 8 bitsì¸ ASCIIë¥¼ ì“°ëŠ”ê²Œ íš¨ìœ¨ì ì´ì§€ ì•Šë‚˜?<br>
ğŸ‘€ ê·¸ë˜ì„œ ë‚˜ì˜¨ê²Œ **ENCODING**! ğŸ‘‰ ë§Œì•½ ì˜ì–´ë§Œ ì“´ë‹¤ë©´ UTF-8ë¡œ ENCODINGì„ í•´ì¤„ê»˜!<br>
    Ex) ì œì¼ ì• ë¹„íŠ¸ë¥¼ 0ìœ¼ë¡œ ë‘ë©´ UTF-8ì´ë¼ ê°€ì •í•œë‹¤(Ex> 0xxxxxxx)<br>
ğŸ‘€ ë§Œì•½ í•œê¸€ì´ë¼ë©´ 3ë°”ì´íŠ¸ë¥¼ ì“°ê³ (1110xxxx 10xxxxxx 10xxxxxx) ì´ë ‡ê²Œ ë“¤ì–´ê°€ ìˆìœ¼ë©´ UTF-8 í•œê¸€

### UTF-16ì´ë€?

ğŸ‘€ ê·¸ëŸ°ë° í•œê¸€ì€ ê½¤ ë„ë¦¬ ì“°ì´ëŠ”ë° 3ë°”ì´íŠ¸ë‚˜ ì“°ìê³ ?? ğŸ‘‰ **UTF-16**ì˜ íƒ„ìƒ<br>
ğŸ‘€ UTF-16ì€ ê±°ì˜ Unicodeë¥¼ ê·¸ëŒ€ë¡œ ì“´ë‹¤

---

## ë©€í‹°ë°”ì´íŠ¸ ë¬¸ìì§‘í•© Vs ìœ ë‹ˆì½”ë“œ ë¬¸ìì§‘í•©

* ë©€í‹°ë°”ì´íŠ¸ ë¬¸ìì§‘í•© / MBCS(Multi Byte Character Set) : (char) ê°œë³„ ë¬¸ìë¥¼ ë‹¤ìˆ˜ì˜ ë°”ì´íŠ¸ë¡œ í‘œí˜„(ì‹œìŠ¤í…œ ë¡œìº˜ì„ ë°”íƒ•ìœ¼ë¡œ ë¬¸ìì§‘í•©ì„ ê¸°ì¤€ìœ¼ë¡œ ë¬¸ìë¥¼ íŒŒì‹±)
* ìœ ë‹ˆì½”ë“œ ë¬¸ìì§‘í•© / WBCS(Wide Byte Character Set) : (wchar) ìœ ë‹ˆì½”ë“œ ê¸°ë°˜ì˜ character set(UTF-16)

* [ì°¸ê³ ì‚¬ì´íŠ¸ ğŸŒ](https://taehyungs-programming-blog.github.io/blog/docs/cpp/win32api/2022-01-13-win32-7/#unicode%EC%97%90-%EA%B4%80%ED%95%98%EC%97%AC)

```cpp
char snedData[1000] = "ê°€";         // ì‹œìŠ¤í…œ ë¡œìº˜ í•œê¸€ê¸°ì¤€ / CP949 (í•œê¸€2ë°”ì´íŠ¸, ë¡œë§ˆì1ë°”ì´íŠ¸)
char snedData[1000] = u8"ê°€";       // UTF8 (Unicode)
WCHAR snedData[1000] = L"ê°€";       // UTF16 (Unicode)
TCHAR snedData[1000] = _T("ê°€");
```

---

## ê°€ë³€ ë¬¸ìì—´ ë°›ê¸°/ë³´ë‚´ê¸°

```cpp
WCHAR sendData3[1000] = L"ê°€"; // UTF16 = Unicode (í•œê¸€/ë¡œë§ˆ 2ë°”ì´íŠ¸)

while (true)
{
    vector<BuffData> buffs{ BuffData {100, 1.5f}, BuffData{200, 2.3f}, BuffData {300, 0.7f } };
    SendBufferRef sendBuffer = ServerPacketHandler::Make_S_TEST(1001, 100, 10, buffs, L"ì•ˆë…•í•˜ì„¸ìš”");
    GSessionManager.Broadcast(sendBuffer);

    this_thread::sleep_for(250ms);
}
```

```cpp
SendBufferRef ServerPacketHandler::Make_S_TEST(uint64 id, uint32 hp, uint16 attack, vector<BuffData> buffs, wstring name)
{
	SendBufferRef sendBuffer = GSendBufferManager->Open(4096);

	BufferWriter bw(sendBuffer->Buffer(), sendBuffer->AllocSize());

	PacketHeader* header = bw.Reserve<PacketHeader>();
	// id(uint64), ì²´ë ¥(uint32), ê³µê²©ë ¥(uint16)
	bw << id << hp << attack;

	// ê°€ë³€ ë°ì´í„°
	bw << (uint16)buffs.size();
	for (BuffData& buff : buffs)
	{
		bw << buff.buffId << buff.remainTime;
	}

	bw << (uint16)name.size();
	bw.Write((void*)name.data(), name.size() * sizeof(WCHAR));

	header->size = bw.WriteSize();
	header->id = S_TEST; // 1 : Test Msg

	sendBuffer->Close(bw.WriteSize());

	return sendBuffer;
}
```

```cpp
void ClientPacketHandler::Handle_S_TEST(BYTE* buffer, int32 len)
{
	BufferReader br(buffer, len);

	PacketHeader header;
	br >> header;

	uint64 id;
	uint32 hp;
	uint16 attack;
	br >> id >> hp >> attack;

	cout << "ID: " << id << " HP : " << hp << " ATT : " << attack << endl;

	vector<BuffData> buffs;
	uint16 buffCount;
	br >> buffCount;

	buffs.resize(buffCount);
	for (int32 i = 0; i < buffCount; i++)
	{
		br >> buffs[i].buffId >> buffs[i].remainTime;
	}

	cout << "BufCount : " << buffCount << endl;
	for (int32 i = 0; i < buffCount; i++)
	{
		cout << "BufInfo : " << buffs[i].buffId << " " << buffs[i].remainTime << endl;
	}

	wstring name;
	uint16 nameLen;
	br >> nameLen;
	name.resize(nameLen);

	br.Read((void*)name.data(), nameLen * sizeof(WCHAR));

	wcout.imbue(std::locale("kor"));
	wcout << name << endl;
}
```