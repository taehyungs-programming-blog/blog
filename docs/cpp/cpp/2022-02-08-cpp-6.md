---
layout: default
title: "6. ë‹¤ì–‘í•œ ìºìŠ¤íŒ… ì •ë¦¬"
parent: "(C++) ë¬¸ë²•"
grand_parent: (C++)
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

* [ì°¸ê³ ì‚¬ì´íŠ¸ ğŸŒ](https://ence2.github.io/2020/11/c-%EC%BA%90%EC%8A%A4%ED%8C%85-%EC%B4%9D%EC%A0%95%EB%A6%AC%EC%8A%A4%EB%A7%88%ED%8A%B8%ED%8F%AC%EC%9D%B8%ED%84%B0-%EC%BA%90%EC%8A%A4%ED%8C%85-%ED%8F%AC%ED%95%A8/)

* ìºìŠ¤íŒ… ì¢…ë¥˜
    * `static_cast` - ê°€ì¥ ê¸°ë³¸ì  í˜•ë³€í™˜, ì»´íŒŒì¼ íƒ€ì„ì— í˜•ë³€í™˜ ì§„í–‰
    * `const_cast` - ìƒìˆ˜ì„±, [volatile](https://taehyungs-programming-blog.github.io/blog/docs/cpp/cpp/2022-02-08-cpp-7/) ì—†ì• ëŠ”ë° ì‚¬ìš©ë˜ëŠ” í˜•ë³€í™˜
    * `reinterpret_cast` - ì„œë¡œ ë‹¤ë¥¸ íƒ€ì…ì˜ í˜•ë³€í™˜(í¬ì¸í„° -> ì •ìˆ˜ ì´ëŸ°ê²½ìš°ë„ ê°€ëŠ¥)
    * `dynamic_cast` - ìƒì† ê´€ê³„ë¥¼ ê°€ë¡œì§€ë¥´ê±°ë‚˜, ë‹¤ìš´ ìºìŠ¤íŒ…(ê¸°ë°˜ í´ë˜ìŠ¤ì—ì„œ íŒŒìƒí´ë˜ìŠ¤ë¡œ), ë‹¨ ëŸ°íƒ€ì„ í˜•ë³€í™˜ ì´ê¸°ì— ì˜¤ë²„í—¤ë“œ ì¡´ì¬
        * ğŸ± `static_cast`ë„ ë‹¤ìš´ ìºìŠ¤íŒ…ì´ ê°€ëŠ¥í•œë°? -> ë³€í™˜í•˜ëŠ” íƒ€ì…ì„ ëª…í™•íˆ ì•Œê³ ìˆì„ ê²½ìš° `static_cast`ë¥¼ ì‚¬ìš©í•˜ê³  ëŸ°íƒ€ì„ì— íƒ€ì…ì´ ê²°ì •ë‚˜ë©° RTTIë¥¼ í™•ì¸í•´ì•¼ í•  ê²½ìš° `dynamic_cast`ë¥¼ ì‚¬ìš©í•˜ì
    * `static_pointer_cast` - ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ìš© `static_cast`
    * `dynamic_pointer_cast` - ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ìš© `dynamic_cast`
    * `const_pointer_cast` - ìŠ¤ë§ˆíŠ¸ í¬ì¸í„°ìš© `const_cast`

---

## static_cast

```cpp
float fdd = static_cast(intVal);                //ì»´íŒŒì¼ ê°€ëŠ¥
char dd = static_cast(intVal);                  //ì»´íŒŒì¼ ê°€ëŠ¥
char* dd1 = static_cast<char*>(intVal);         //ì»´íŒŒì¼ ì—ëŸ¬
```

---

## const_cast

```cpp
// ìƒìˆ˜ì„± ë¶€ì—¬
char chArray[] = "Hello";
const char* chPointer = chArray;
const char* chPointer = const_cast<const char*>(chArray);

// ìƒìˆ˜ì„± ì œê±°
const char* target = chArray;
char* removedCastValue = const_cast<char*>(target);
char* cStyle = (char*)target; // ì´ê²ƒë„ OKì´ì§€ë§Œ, C ìŠ¤íƒ€ì¼ ìºìŠ¤íŠ¸ëŠ” ì§€ì–‘
```

---

## reinterpret_cast

```cpp
// í¬ì¸í„°ì˜ ì£¼ì†Œì— ê¸°ë°˜í•˜ì—¬ í•´ë‹¹ ê°’ì„ í•´ì‰¬ë¡œ ì •ì˜í•˜ì—¬ ê°’ì„ ë°˜í™˜í•¨.
unsigned short Hash( void *p ) 
{
	// reinterpret_castë¡œ void* -> int í˜•ë³€í™˜
	// C ìŠ¤íƒ€ì¼ ìºìŠ¤íŒ… : val = (unsigned int)p;
	unsigned int val = reinterpret_cast<unsigned int>( p ); 
	return ( unsigned short )( val ^ (val >> 16) ); 
}
```

---

## dynamic_cast

```cpp
class BaseClass {...};
class DerivedClass : public BaseClass {...};

BaseClass* pBC = new DerivedClass;

// ì •ì ìœ¼ë¡œ í˜•ë³€í™˜. í˜•ë³€í™˜ ìì²´ë§Œ ìˆ˜í–‰
DerivedClass* pSDC = static_cast<DerivedClass*>(pBC);
/* Disassembly
	mov		eax, dword ptr [ebp - 14h] 
	mov		dword ptr [ebp - 20h], eax
*/

// ëŸ°íƒ€ì„ì— ë™ì ìœ¼ë¡œ í˜•ë³€í™˜ ë° RTTI ì²´í¬
DerivedClass* pSDC = dynamic_cast<DerivedClass*>(pBC);
/* Disassembly
	push 	0
	push 	offset DerivedClass 'RTTI Type Descriptor' (0C7A01Ch)
	push 	offset BaseClass 'RTTI Type Descriptor' (0C7A094h)
	push 	0
	mov		eax, dword ptr [ebp - 14h]
	push		eax
	call		@ILT+715(___RTDynamicCast) (0C712D0h)
	add		esp, 14h
	mov		dword ptr [ebp - 2Ch], eax
*/
```

---

## smart pointer í˜•ë³€í™˜

```cpp
vector<shared_ptr<MediaAsset>> assets;

assets.push_back(shared_ptr<Song>(new Song(L"Himesh Reshammiya", L"Tera Surroor")));
assets.push_back(shared_ptr<Song>(new Song(L"Penaz Masani", L"Tu Dil De De")));
assets.push_back(shared_ptr<Photo>(new Photo(L"2011-04-06", L"Redmond, WA", L"Soccer field at Microsoft.")));

vector<shared_ptr<MediaAsset>> photos;

copy_if(assets.begin(), assets.end(), back_inserter(photos), [] (shared_ptr<MediaAsset> p) -> bool
{
    // Use dynamic_pointer_cast to test whether
    // element is a shared_ptr<Photo>.
    shared_ptr<Photo> temp = dynamic_pointer_cast<Photo>(p);		
    return temp.get() != nullptr;
});

for (const auto&  p : photos)
{
    // We know that the photos vector contains only 
    // shared_ptr<Photo> objects, so use static_cast.
    wcout << "Photo location: " << (static_pointer_cast<Photo>(p))->location_ << endl;
}
```