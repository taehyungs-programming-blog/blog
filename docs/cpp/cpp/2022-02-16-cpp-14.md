---
layout: default
title: "14. type deduction"
parent: "(C++) ë¬¸ë²•"
grand_parent: (C++)
nav_order: 2
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

```cpp
int main() 
{ 
	int n = 10; 
	const int& r = n;

        // ì»´íŒŒì¼ëŸ¬ê°€ ì•Œì•„ì„œ typeì„ ì •ì˜í•´ ì¤€ë‹¤
	auto a1 = n; // int a1 = n 
	auto a2 = r; // int a2 = r -> (ì£¼ì˜) constë¥¼ ì œê±°í•˜ê³  intë¡œ typeì„ ì •ì˜í•¨. 
}
```

```cpp
// ì¶”ë¡ ëœ ë°ì´í„° íƒ€ì…ì„ ì¶œë ¥í•˜ëŠ” ë°©ë²•.

#include <iostream> 
#include <typeinfo>

template<class T> void foo(T arg) 
{  
	std::cout << typeid(T).name() << std::endl; 
        // typeid - const/volatile/reference ì •ë³´ëŠ” ìƒëµë¨
            // T = const int& -> intë¡œ ì¶œë ¥ëœë‹¤.

        // __FUNCTION__ : í˜„ì¬ í•¨ìˆ˜ì˜ ì´ë¦„ì„ ë¦¬í„´
        std::cout << __FUNCTION__ << std::endl; // foo

        // __PRETTY_FUNCTION__ : í•¨ìˆ˜ì˜ ì´ë¦„ë¿ ì•„ë‹ˆë¼ íƒ€ì…ê¹Œì§€ ë¦¬í„´
        std::cout << __PRETTY_FUNCTION__ << std::endl;    // void foo(int arg)
        std::cout << __FUNCSIG__ << std::endl;            // Visual C++ ìš©
}

int main() 
{ 
//	foo<int>(10); 
//	foo(10); 
//	foo(3.4); 
	foo<const int&>(10); 
}
```

```cpp
/*
    * Template type deductionì˜ ë„¤ ê°€ì§€ ì¢…ë¥˜
        * T arg : ì¸ìë¥¼ ê°’ìœ¼ë¡œ ë°›ìŒ
        * T& arg : ì¸ìë¥¼ l-value refë¡œ ë°›ìŒ
        * T&& arg : ì¸ìë¥¼ r-value refë¡œ ë°›ìŒ
        * ì¸ìë¥¼ ë°°ì—´ë¡œ ë°›ìŒ
*/

// 1. ì¸ìë¥¼ ê°’ìœ¼ë¡œ ë°›ìŒ.
template<typename T> void foo(T arg)
{
    while(--arg > 0) {}
}

int main()
{
    int n = 10;
    int& r = n;
    const int c = 10;
    const int& cr = c;

    foo(n);        // T - int
    foo(r);        // T - int -> referenceë¥¼ ì‹¤ìˆ˜ë¡œ ë³´ëƒˆëŠ”ë° ì›ë³¸ê°’ì´ ë³€ê²½ë˜ëŠ” ê±¸ ë°©ì§€í•˜ê¸° ìœ„í•´ Call by valueë¡œ ë™ì‘
    foo(c);        // T - int -> ì—­ì‹œ call by valueì´ê¸°ì— constë¥¼ ìƒëµí•˜ëŠ”ê²Œ ë§ìŒ
    foo(cr);        // T - int

// (ê²°ë¡ ) reference, volatile, constëŠ” ìƒëµëœë‹¤. (Call by value ë³µì‚¬ë³¸ìœ¼ë¡œ ë™ì‘í•œë‹¤ê³  ìƒê°í•˜ì)
}
```

```cpp
template<typename T> void foo(T arg)
{
     std::cout << __FUNCSIG__ << std::endl;
}

int main()
{
    const char* const s = "hello";    // const char * -> "hello"ê°€ ìƒìˆ˜ì¸ ê²ƒì€ ë³€í•¨ì´ ì—†ìŒ.
    // const char* -> "hello"ëŠ” ìƒìˆ˜ì´ë‹¤
    // const s -> sì˜ ì£¼ì†Œê°’ì€ ìƒìˆ˜ì´ë‹¤.

    const char* s = "hello";        // T - const char*
    const int s = 10;               // T - int
    cosnt int* s = new int[10];     // T - const int*

    foo(s);
}
```

```cpp
// 2. ì¸ìë¥¼ l-value refë¡œ ë°›ì„ ë•Œ 
template<typename T> void foo(T& arg) 
{ 
    while(--arg > 0) {} 
}

int main() 
{ 
    int n = 10; 
    int& r = n; 
    const int c = 10; 
    const int& cr = c;

    foo(n);        // T - int,       arg - int& 
    foo(c);        // T - const int, arg - const int& -> const int&ì„ ë°›ê¸°ìœ„í•´ì„  const intì—¬ì•¼ í•˜ê¸°ì— TëŠ” const intë¡œ ê°•ì œëœë‹¤.
    foo(r);        // T - int      , arg - int& -> referenceë¥¼ ì‹¤ìˆ˜ë¡œ ë³´ëƒˆëŠ”ë° ì›ë³¸ê°’ì´ ë³€ê²½ë˜ëŠ” ê±¸ ë°©ì§€í•˜ê¸° ìœ„í•´ Call by valueë¡œ ë™ì‘ 
    foo(cr);       // T - const int, arg - const int&
// (ê²°ë¡ ) referenceëŠ” ì œê±°ë˜ê³  Tì˜ íƒ€ì…ì„ ê²°ì •, ë‹¨ const, volatileì€ ìœ ì§€ëœë‹¤. 
} 
```

3. ì¸ìë¥¼ r-value refë¡œ ë°›ì„ ë•Œ

    ì´í›„ forwarding reference ê°•ì˜ ì°¸ì¡°

```cpp
// 4. ë°°ì—´ë¡œ ì¸ìë¥¼ ë°›ì„ ê²½ìš° 
template<typename T> void foo(T arg)  // T arg = x
{ 
    std::cout << __FUNCSIG__ << std::endl;
}

template<typename T> void goo(T& arg)  // T& arg = x
{ 
    std::cout << __FUNCSIG__ << std::endl; 
}

int main() 
{
    int x[3] = {1, 2, 3};

    foo(x);        
    // T - int* (í¬ì¸í„°ë¡œ ì¶”ë¡ )
        // í¬ì¸í„°ë¡œ ë°›ëŠ”ê²Œ ìµœì„ ì¸ê°€? ë°°ì—´ì€ ëª»ë°›ë‚˜?
        // int arg[3] = x; // ì´ëŸ°ì—°ì‚°ì´ ë¶ˆê°€ëŠ¥ ë”°ë¼ì„œ ë°°ì—´ë¡œ ë„˜ê¸°ëŠ”ê²Œ ë¶ˆê°€ëŠ¥, í¬ì¸í„°ë¡œ ë„˜ê¸°ëŠ”ê²Œ ìµœì„ ì´ë‹¤(ê·¸ë˜ì„œ ì»´íŒŒì¼ëŸ¬ê°€ ê·¸ë ‡ê²Œ ì„¤ê³„ëœë“¯?)

    goo(x);        
    // T - int[3](TëŠ” ë°°ì—´ë¡œ ì¶”ë¡ ), arg - int(&)[3](argëŠ” ë°°ì—´ì„ ê°€ë¦¬í‚¤ëŠ” ì°¸ì¡°ë¡œ ì¶”ë¡ )
        // int(&)[3] - ë°°ì—´ì„ ê°€ë¦¬í‚¤ëŠ” ì°¸ì¡°ë¥¼ ì´ë ‡ê²Œ í‘œí˜„í•¨.
        // ì´ë ‡ê²Œ í•  ìˆ˜ ë°–ì— ì—†ëŠ”ê²Œ T& ì´ë‹ˆ Tì˜ ì°¸ì¡°í˜• TëŠ” ë°°ì—´ int[3]ì´ì—¬ì•¼ í•˜ê¸°ë•Œë¬¸.
}
```

ğŸ˜º ì˜ ì´í•´í–ˆë‚˜ í™•ì¸í•´ë³´ì

```cpp
template<typename T> void foo(T s1, T s2)
{
}
template<typename T> void goo(T& s1, T& s2)
{
}

int main()
{
    foo("orange", "apple");    // T - const char*
    // foo( const char[7], const char[6])

    goo("orange", "apple");    // error
    // T - char[7]
    // goo( const char[7], const char[6])    // ë‹¤ë¥¸ íƒ€ì…ì´ë¼ Tí•˜ë‚˜ë¡œ ë°›ì„ ìˆœ ì—†ë‹¤.
}
```

ğŸ˜º autoëŠ” ì–´ë–»ê²Œ tpyeì„ ì¶”ë¡ í• ê¹Œ?

```cpp
int n = 10;
int& r = n;
const int c = 10;
const int& cr = c;

// templateê³¼ ë™ì¼í•œ ê·œì¹™ì´ ì ìš©ë¨ const, volatile, reference ì œê±°ë¨
auto a1 = n1;        // int
auto a2 = r;         // int
auto a3 = c;         // int
auto a4 = cr;        // int

auto& a5 = n1;         // auto - int / a5 - int&
auto& a6 = r;          // auto - int / a6 - int&
auto& a7 = c;          // auto - const int / a7 - const int&
auto& a8 = cr;         // auto - const int / a8 - const int&

int x[3] = {1, 2, 3};
auto a = x;            // auto - int*
auto& b = x;           // auto - int[3] / b = int(&)[3]

// ê²°ë¡ ì ìœ¼ë¡œ templateê³¼ ë™ì¼í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤
```


ğŸ˜º autoì˜ ìœ ì˜ì‚¬í•­

```cpp
auto a1 = 1;    // auto - int
auto a2 = {1};  // auto - int ì¼ê¹Œ?
auto a3{1};     // auto - int ì¼ê¹Œ?

std::cout << typeid(a1).name() << std::endl;    // int
std::cout << typeid(a2).name() << std::endl;    // initializer_list<int> - ì£¼ì˜í•  ê²ƒ.
std::cout << typeid(a3).name() << std::endl;    // int

/* ****************** */

std::vector<int> v1(10, 0);
std::vector<bool> v2(10, false);

auto a4 = v1[0];    // auto - int
auto a5 = v2[0];    // auto - "proxy ê°ì²´" - ìµœì í™”ë¥¼ ìœ„í•´ vectorì˜ boolì€ proxyê°ì²´ê°€ ë‚˜ì˜´ ì£¼ì˜!
```

