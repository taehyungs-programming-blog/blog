---
layout: default
title: "4. ì„ì‹œê°ì²´(temporary)"
parent: "(C++) ë¬¸ë²•"
grand_parent: (C++)
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

## ì„ì‹œê°ì²´ì˜ ìƒì„±ìˆœì„œ

```cpp
#include <iostream>

// í•µì‹¬ 1. ì„ì‹œê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²• - "í´ë˜ìŠ¤ì´ë¦„(ìƒì„±ìì¸ì)"
//      2. ì„ì‹œê°ì²´ì˜ ìˆ˜ëª… - ë¬¸ì¥ì˜ ë.

struct Point
{
	int x, y;
	Point(int a = 0, int b = 0) { std::cout << "Point()"  << std::endl; }
	~Point()					{ std::cout << "~Point()" << std::endl; }
};

int main()
{
//	Point p1(1, 2);	//  named object.
    /*
        Point()
        ----------
        ~Point()
    */

//	Point(1, 2);	// unamed object. <- ì„ì‹œê°ì²´(temporary)
    /*
        Point()
        ~Point()
        ----------
    */

	Point(1, 2), std::cout << "X" << std::endl;

	std::cout << "----------" << std::endl;
}
```

---

## temporaryì˜ íŠ¹ì§•

```cpp
#include <iostream>
using namespace std;

struct Point
{
	int x, y;
	Point(int a = 0, int b = 0) { cout << "Point()" << endl; }
	~Point()					{ cout << "~Point()" << endl; }
};

int main()
{
	Point p1;	// ì„ì‹œê°ì²´ ì•„ë‹˜. ì´ë¦„ìˆëŠ” ê°ì²´

	// í•µì‹¬ 1. ì„ì‹œê°ì²´ëŠ” ë“±í˜¸(=)ì˜ ì™¼ìª½ì— ì˜¬ìˆ˜ ì—†ë‹¤.
	p1.x = 10;		// ok
	//Point().x = 10;	// error - temporaryëŠ” r-valueì´ë‹¤.

	// í•µì‹¬ 2. ì„ì‹œê°ì²´ëŠ” ì£¼ì†Œë¥¼ êµ¬í• ìˆ˜ ì—†ë‹¤.
	Point* pp1 = &p1;		// ok
	Point* pp2 = &Point();	// error - temporaryëŠ” ì£¼ì†Œë¥¼ ë°›ì„ ìˆ˜ ì—†ë‹¤

	// í•µì‹¬ 3. non-const reference ëŠ” ì„ì‹œê°ì²´ë¥¼ ì°¸ì¡°í•  ìˆ˜ ì—†ë‹¤.
	//         const     reference ëŠ” ì„ì‹œê°ì²´ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤.
	Point& r1 = p1;			// ok
	Point& r2 = Point();	// error - ì°¸ì¡°ì—­ì‹œ ë¶ˆê°€

	const Point& r3 = p1;		// ok
	const Point& r4 = Point();	// ok - ë‹¨, ìƒìˆ˜ì°¸ì¡°ëŠ” ê°€ëŠ¥(ì´ë¦„ì„ ë¶€ì—¬í•œë‹¤ê³  ë°›ì•„ë“¤ì¸ë‹¤)

	r4.x = 10; // error - ìƒìˆ˜ì„±ì´ ë¶€ì—¬ëê¸°ì— ì—ëŸ¬ë¦¬í„´

	// C++11 : rvalue referenceëŠ” ìƒìˆ˜ì„± ì—†ì´ rvalueë¥¼ ê°€ë¦¬í‚¬ìˆ˜ìˆë‹¤.
	Point&& r5 = p1;        // error, rvalue reference ëŠ” rvalueë§Œ ê°€ë¦¬í‚¬ìˆ˜ ìˆë‹¤.
	Point&& r6 = Point();   // ok - moveë¡œ ì´ë™ë˜ì—ˆìŒ.
}
```

---

## temporaryì™€ í•¨ìˆ˜ì¸ì

ğŸ˜º ê°ì²´ë¥¼ í•¨ìˆ˜ì˜ ì¸ìë¡œë§Œ ì‚¬ìš©í•œë‹¤ë©´ temporaryë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ íš¨ìœ¨ì ì¼ ìˆ˜ ìˆìŒ.

```cpp
struct Point
{
	int x, y;
	Point(int a = 0, int b = 0) { cout << "Point()" << endl; }
	~Point()					{ cout << "~Point()" << endl; }
};

// ì„ì‹œê°ì²´ì™€ í•¨ìˆ˜ ì¸ì
void foo(const Point& p)    // const &ë¡œ ë°›ê¸°ì— ì„ì‹œê°ì²´ temporaryë„ ë°›ì„ ìˆ˜ ìˆìŒ.
{
}

int main()
{
	Point p(1,1);
	foo(p);                 // ok

	foo(Point(1, 1));       // ok
    // foo({1, 2});         // ok - ì´ë ‡ê²Œ ì¨ë„ ì»´íŒŒì¼ëŸ¬ì— ì˜í•´ì„œ temporaryë¡œ ë³´ë‚´ì§„ë‹¤.
    /*
        fooì— ë“¤ì–´ê°€ë©° Point(1, 1)ì´ ìƒì„±ë˜ê³ 
        fooë¥¼ ë‚˜ì˜¤ë©° Point(1, 1)ì´ ì†Œë©¸ëœë‹¤.
    */

	// STLì—ì„œ ì„ì‹œê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°
    //	sort(x, x + 10, less<int>());

	cout << "end" << endl;

}
```

### ì¶”ê°€) stringì„ ì½ê¸°ë§Œ í•˜ëŠ” í•¨ìˆ˜ì˜ ì¸ìë¡œ ë³´ë‚¼ê²½ìš°

* C++17 ê¸°ìˆ ì„ì„ ê¸°ì–µ.

```cpp
void goo(const std::string& s)
{
    // ...
    // temporaryë¥¼ ë°›ì„ ê²½ìš° stringì˜ ìƒì„±ìë¥¼ í˜¸ì¶œ í•˜ê³  ì½ì€ í›„ ì†Œë©¸ì ê¹Œì§€ ê³¼ì •ì´ ìˆìŒ.
}

void goo2(std::string_view s)
{
    // ...
    // temporaryë¥¼ ë°›ë”ë¼ë„ string_viewë¥¼ ìƒì„±í•˜ëŠ”ë°
    // string_viewëŠ” [ë¬¸ìì—´ ì£¼ì†Œ, ë¬¸ìì—´ ê¸¸ì´]ë§Œ ê°–ê¸°ì— ë©”ëª¨ë¦¬ ìì²´ë„ ì‘ê³ 
    // ë¬¸ìì—´ ì£¼ì†Œë¡œ ê°–ê¸°ì— ê¸°ì¡´ì˜ ìƒìˆ˜ ë¬¸ìì—´ ì£¼ì†Œë§Œ ê°–ê³ ìˆìŒìœ¼ë¡œ íš¨ìœ¨ì´ ì¢‹ìŒ.
}
```

---

## return by reference, value

```cpp
struct Point
{
	int x, y;
	Point(int a = 0, int b = 0) { cout << "Point()" << endl; }
	~Point()					{ cout << "~Point()" << endl; }
};

void f1(Point p1) {}
void f2(Point& p2) {}

int main()
{
    Point pt(1, 2);
    f1(pt);         // Pointë¥¼ ë³µì‚¬(call by value)
    f2(pt);         // Pointì˜ ì°¸ì¡°ë§Œ ì‚¬ìš©(call by reference)
}
```

```cpp
// ì „ì—­ìœ¼ë¡œ ptë¥¼ ë§Œë“¤ê³ 
Point pt(1, 2);

Point f3()
{
    return pt;  // ptë¥¼ ë¦¬í„´í• ë•Œ, return by valueë¡œ ë¦¬í„´ì´ ë ê¹Œ referenceë¡œ ë¦¬í„´ì´ ë ê¹Œ?
    // ì •ë‹µì€ return by value
}

int main()
{
    f3();   // ë¦¬í„´ìš© temporaryê°€ ë¦¬í„´ëœë‹¤.

    f3().x = 10; // temporaryì´ê¸°ì— =ì˜ ì™¼ìª½ì— ì˜¬ìˆ˜ ì—†ìŒ(r-value)
}
```

```cpp
Point& f4()
{
    return pt;  // return by reference
}

int main()
{
    f4().x = 10;        // okay!
}
```

### Example

ğŸ˜º ì•„ë˜ ì½”ë“œì˜ ë¬¸ì œì ì„ ë¶„ì„í•´ ë³´ì.

```cpp
class Counter
{
    int count{0};
public:
    Counter increment()
    {
        ++count;
        return *this;
    }
    int get() const { return count; }
};

int main()
{
    Counter c;
    c.increment().increment().increment();

    std::cout << c.get() << std::endl;      // 1 ???
}
```

```cpp
class Counter
{
    int count{0};
public:
    // valueë¡œ ë¦¬í„´í•˜ëŠ”ê²Œ ë¬¸ì œ
    Counter increment()
    {
```

```cpp
class Counter
{
    int count{0};
public:
    Counter& increment()
    {
        ++count;
        return *this;
    }
    int get() const { return count; }
};
```

---

## temporaryì™€ casting

```cpp
struct Base
{
	int v = 10;
};

struct Derived : public Base
{
	int v = 20;
};

int main()
{
    // ì—¬ê¸°ê¹Œì§„ ìµìˆ™í•˜ë‹¤
	Derived d;
	cout << d.v << endl;        // 20
	cout << d.Base::v << endl;  // 10

	// ìºìŠ¤íŒ…ì„ value, referenceë¡œ í•  ê²½ìš°??
	cout << (static_cast<Base>(d)).v << endl;  // 10 - Baseì˜ ì„ì‹œê°ì²´ë¥¼ ë§Œë“¤ê³  valueì— ì ‘ê·¼
                                                // í™•ì¸í•˜ê³  ì‹¶ë‹¤ë©´ Baseì˜ ìƒì„±ìê°€ í˜¸ì¶œë˜ëŠ”ì§€ ë³´ë©´ëœë‹¤.
	cout << (static_cast<Base&>(d)).v << endl; // 10

	(static_cast<Base>(d)).v = 30;  // error - ì„ì‹œê°ì²´ì— ì ‘ê·¼í•˜ê¸°ì— ì—ëŸ¬
	(static_cast<Base&>(d)).v = 30; // ok
	
}
```