---
layout: default
title: "8. semaphore"
parent: (Concurrency)
grand_parent: C++
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

```cpp
#include <iostream>
#include <mutex>
#include <thread>
#include <string>
#include <chrono>
using namespace std::literals;

std::mutex m;

void Download(std::string name)
{
    m.lock();
    for(int i = 0; i < 100; i++)
    {
        std::cout << name;
        std::this_thread::sleep_for(30ms);
    }
    m.unlock();
}

int main()
{
    std::thread t1(Download, "1");
    std::thread t2(Download, "2");
    std::thread t3(Download, "3");
    std::thread t4(Download, "4");
    std::thread t5(Download, "5");
    t1.join();
    t2.join();
    t3.join();
    t4.join();
    t5.join();
}
```

ğŸ¦„ ê²°ê³¼ë¥¼ ë³´ë©´ 1ì´ ëª¨ë‘ ëë‚˜ê³  2ê°€ ì‹œì‘ 2ê°€ ëª¨ë‘ ëë‚˜ê³  3ì´ ì‹œì‘ â€¦ <Br>
ğŸ¦„ ì´ëŸ°ì‹ìœ¼ë¡œ ìì›ì˜ ë…ì ‘ì´ ì¼ì–´ë‚œë‹¤.<Br>
ğŸ¦„ ìì›ì„ ê³µìœ í•˜ëŠ” ë°©ì•ˆì€ ì—†ì„ê¹Œ?<Br>

```cpp
#include <iostream>
#include <thread>
#include <string>
#include <chrono>
#include <semaphore>
using namespace std::literals;

std::counting_semaphore<3> sem(3);  
// std::counting_semaphore<MAX_COUNT> sem(ì´ˆê¸°ê°’);

void Download(std::string name)
{
    sem.acquire();
    for(int i = 0; i < 100; i++)
    {
        std::cout << name;
        std::this_thread::sleep_for(30ms);
    }
    sem.release();
}

int main()
{
    std::thread t1(Download, "1");
    std::thread t2(Download, "2");
    std::thread t3(Download, "3");
    std::thread t4(Download, "4");
    std::thread t5(Download, "5");
    t1.join();
    t2.join();
    t3.join();
    t4.join();
    t5.join();
}
```

```cpp
#include <iostream>
#include <thread>
#include <string>
#include <chrono>
#include <semaphore>
using namespace std::literals;

std::counting_semaphore<3> sem(0);  // ì´ˆê¸°ê°’ì´ 0ì´ë¼ë©´?
// ì–´ë””ì„ ê°€ releaseë¥¼ í•´ì¤˜ì•¼ ë“¤ì–´ê°ˆ ìˆ˜ ìˆìŒ

std::counting_semaphore<1> sem(1);
// std::binrary_semaphore sem(1); // ìœ„ í‘œí˜„ê³¼ ë™ì¼
// counting_semaphore<1>ì€ mutexì™€ ë™ì¼í•œê±° ì•„ë‹Œê°€ ì™œë§Œë“¤ì—ˆì§€?
// mutexëŠ” lockì„ ì¡ì€ í•´ë‹¹ threadë§Œ unlockì´ ê°€ëŠ¥í•˜ì§€ë§Œ
// counting_semaphore<1>ëŠ” ì–´ë””ì„œë“  releaseê°€ ê°€ëŠ¥í•¨
```