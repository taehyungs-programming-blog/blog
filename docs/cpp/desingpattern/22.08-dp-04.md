---
layout: default
title: "04. ë””ìì¸íŒ¨í„´! ì–´ë””ë‹¤ ì¨ì•¼í• ê¹Œ?"
parent: (Desing Pattern)
grand_parent: (C++)
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

ğŸ¦„ ì˜ˆë¡œì„œ ì„¤ëª…í•´ ë³´ìë©´ ...

```cpp
#include <iostream>
#include <string>
using namespace std;

class Edit
{
    string data;
public:
    string getData()
    {
        // Editì´ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì½˜ì†”ì—ì„œ ë¬¸ìë¥¼ ë°›ê³  ì¶œë ¥í•˜ê³ ì í•œë‹¤.
        cin >> data;
        return data;
    }
};

int main()
{
    Edit edit;

    while(1)
    {
        string s = edit.getData();      
        // ë§Œì•½ ê¸°íšì´ ë°”ë€Œì–´ ìˆ«ìë§Œ ë°›ì•„ì•¼ í•œë‹¤ë©´??
        cout << s << endl;
    }
}
```

```cpp
#include <conio.h>      // getch()

class Edit
{
    string data;
public:
    string getData()
    {
        data.clear();
        while(1)
        {
            char c = getch();
            if(c == 13) break;      

            // ì´ëŸ°ì‹ìœ¼ë¡œ ë¬¸ìì…ë ¥ì„ ë§‰ì„ ìˆ˜ ìˆë‹¤.
            if(isdigit(c))
            {
                data.push_back(c);
                cout << c;
            }
        }
        cout << endl;
        return data;
    }
};

// ê¸°íšì´ ë˜ ë°”ë€Œì—ˆë‹¤.
// ë‹¤ì‹œ stringìœ¼ë¡œ ë°”ê¿” ë³´ì
```

ğŸ¦„ ë§¤ë²ˆ `Edit` í´ë˜ìŠ¤ë¥¼ ë§Œì ¸ì•¼í• ê¹Œ?<br>
ğŸ¦„ `Edit`ê°€ ë§¤ìš° ì½”ì–´í•œ í´ë˜ìŠ¤ë¼ë©´?? ì´ê²Œ ê³¼ì—° ì¢‹ì€ ë°©ë²•ì¼ê¹Œ?

```cpp
class Edit
{
    string data;
public:
    virtual bool validate(char c)
    {
        return isdigit(c);
    }

    string getData()
    {
        data.clear();
        while(1)
        {
            char c = getch();
            if(c == 13) break;

            if(validate(c))
            {
                data.push_back(c);
                cout << c;
            }
        }
        cout << endl;
        return data;
    }
};

class AddressEdit : public Edit
{
    public:
    virtual bool validate(char c) override
    {
        return true;        
        // validate ì •ì±…ì„ í•­ìƒ trueë¡œ ë‘”ë‹¤. -> ìˆ«ì, ë¬¸ì ëª¨ë‘ ë°›ëŠ”ë‹¤.
        // í•µì‹¬ì€ ì •ì±…ì„ í´ë˜ìŠ¤ ì™¸ë¶€ë¡œ ë¹¼ëŠ”ê²ƒì— ìˆë‹¤.
    }
};

int main()
{
    AddressEdit edit;

    while(1)
    {
        string s = edit.getData();
        cout << s << endl;
    }
}
```

---

## ê·¸ë˜ì„œ ë””ìì¸ íŒ¨í„´ì´ ì™œ í•„ìš”í•œë°??

* ì¡°ê¸ˆ ë” ê³ ë¯¼í•´ë³´ë©´ ë‘ ê°€ì§€ ë°©ë²•ì´ ìˆëŠ”ë°,

* ë³€í•˜ëŠ” ê²ƒì„ **ê°€ìƒ í•¨ìˆ˜**ë¡œ ë§Œë“¤ì–´ì„œ íŒŒìƒí´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ ë³´ëŠ”ê²Œ ì–´ë–¨ê¹Œ? -> **Template method**
* ë³€í•˜ëŠ” ê²ƒì„ **ì¸í„°í˜ì´ìŠ¤í™”** í•´ì„œ íŒŒìƒí´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ ë³´ëŠ”ê²Œ ì–´ë–¨ê¹Œ? -> **Strategy Composition**
* ë” ìì„¸í•œ ì„¤ëª…ì€ **Template, Strategy Pattern**ì—ì„œ ì„¤ëª…

---

## Example) ë³€í•˜ëŠ” ë¶€ë¶„ê³¼ ë³€í™”ì§€ ì•ŠëŠ” ë¶€ë¶„ì„ ë¶„ë¦¬í•˜ëŠ” ë²• (Template Method)

```cpp
#include <iostream>
#include <vector>
using namespace std;

class Shape
{
protected:
    // ë³€í•˜ëŠ” ê²ƒì„ ê°€ìƒí•¨ìˆ˜ë¡œ ë½‘ì•„ë‚¸ë‹¤.
    virtual void DrawImp()
    {
        cout << "Draw Shape" << endl;
    }

public:
    // final : íŒŒìƒ í´ë˜ìŠ¤ê°€ ì¬ì •ì˜ í• ìˆ˜ ì—†ê²Œ í•œë‹¤.
    virtual void Draw() final
    {
        cout << "mutex lock" << endl;

        DrawImp();
        cout << "mutex unlock" << endl;
    }


    virtual Shape* Clone() { return new Shape(*this);}
};


class Rect : public Shape
{
public:
    virtual void DrawImp() { cout << "Draw Rect" << endl;}

    virtual Shape* Clone() { return new Rect(*this);}
};

class Circle: public Shape
{
public:
    virtual void DrawImp() { cout << "Draw Circle" << endl;}
    virtual Shape* Clone() { return new Circle(*this);}
};


int main()
{
    vector<Shape*> v;

    while(1)
    {
        int cmd;
        cin >> cmd;

        if      ( cmd == 1 ) v.push_back(new Rect);
        else if ( cmd == 2 ) v.push_back(new Circle);
        else if ( cmd == 8 )
        {
            cout << "index >> ";
            int k;
            cin >> k;
            v.push_back( v[k]->Clone() );
        }
        else if ( cmd == 9 )
        {
            for ( auto p : v)
                p->Draw();
        }
    }

}
```

---

## Example) Prototype Pattern

```cpp
#include <iostream>
#include <vector>
using namespace std;

class Shape
{
public:
    int type;
    virtual void Draw() { cout << "Draw Shape" << endl;}

    // ìì‹ ì˜ ë³µì‚¬ë³¸ì„ ë§Œë“œëŠ” ê°€ìƒí•¨ìˆ˜.
    virtual Shape* Clone() { return new Shape(*this);}
};


class Rect : public Shape
{
public:
    Rect() { type = 1;}
    virtual void Draw() { cout << "Draw Rect" << endl;}

    virtual Shape* Clone() { return new Rect(*this);}
};

class Circle: public Shape
{
public:
    Circle() { type = 2;}
    virtual void Draw() { cout << "Draw Circle" << endl;}

    virtual Shape* Clone() { return new Circle(*this);}
};



class Triangle : public Shape
{
public:
    virtual void Draw() { cout << "Draw Triangle" << endl;}
};

int main()
{
    vector<Shape*> v;

    while(1)
    {
        int cmd;
        cin >> cmd;

        if      ( cmd == 1 ) v.push_back(new Rect);
        else if ( cmd == 2 ) v.push_back(new Circle);



        else if ( cmd == 8 )
        {
            cout << "index >> ";
            int k;
            cin >> k;

            // k ë²ˆì§¸ ë„í˜•ì˜ ë³µì‚¬ë³¸ì„ vì— ì¶”ê°€í•œë‹¤.

            v.push_back( v[k]->Clone() ); // ë‹¤í˜•ì„±.

/*
            // k ë²ˆì§¸ ë„í˜•ì˜ ë³µì‚¬ë³¸ì„ vì— ì¶”ê°€í•œë‹¤.
            switch( v[k]->type )
            {
            case 1:  break;
            case 2:  break;
            }
            */

        }


        else if ( cmd == 9 )
        {
            for ( auto p : v)
                p->Draw();  // ë‹¤í˜•ì„±
        }
    }

}
```