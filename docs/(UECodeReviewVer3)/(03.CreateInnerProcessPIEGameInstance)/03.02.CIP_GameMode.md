---
layout: default
title: "GameModeì—ì„œ CreateInnerProcessPIEGameInstanceì—°ê´€ ë¶€ë¶„ ì •ë¦¬"
parent: "(02. CreateRenderState)"
grand_parent: "(UE Code-Review ğŸ³)"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

* Unreal Engineì˜ GameModeëŠ” ê²Œì„ì˜ ê·œì¹™ê³¼ ë¡œì§ì„ ì •ì˜í•˜ëŠ” í•µì‹¬ í´ë˜ìŠ¤
* ê²Œì„ ë‚´ì—ì„œ í”Œë ˆì´ì–´ì˜ ìŠ¤í°, ì ìˆ˜ ê´€ë¦¬, ê²Œì„ ìƒíƒœ ë“±ì„ ê´€ë¦¬

---

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/unreal_review_ver3/basic/03.02_01.png"/>
</p>

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/unreal_review_ver3/basic/03.02_02.png"/>
</p>

```cpp
// MyGameMode.h
#pragma once

#include "CoreMinimal.h"
#include "GameFramework/GameModeBase.h"
#include "MyGameMode.generated.h"

UCLASS()
class MYGAME_API AMyGameMode : public AGameModeBase
{
    GENERATED_BODY()

public:
    AMyGameMode();

    // ê²Œì„ ì‹œì‘ ì‹œ í˜¸ì¶œ
    virtual void StartPlay() override;
    
    // í”Œë ˆì´ì–´ ìŠ¤í° ìœ„ì¹˜ ì„ íƒ
    virtual AActor* ChoosePlayerStart_Implementation(AController* Player) override;
    
    // í”Œë ˆì´ì–´ ë¡œê·¸ì¸ í›„ í˜¸ì¶œ
    virtual void PostLogin(APlayerController* NewPlayer) override;
    
protected:
    // í”Œë ˆì´ì–´ì˜ ê¸°ë³¸ í° í´ë˜ìŠ¤ ê²°ì •
    virtual UClass* GetDefaultPawnClassForController_Implementation(AController* InController) override;
    
    UPROPERTY(EditDefaultsOnly, Category = "Game Settings")
    TSubclassOf<APawn> DefaultHumanPawnClass;
    
    UPROPERTY(EditDefaultsOnly, Category = "Game Settings")
    TSubclassOf<APawn> DefaultAIPawnClass;
};
```

```cpp
// MyGameMode.cpp
#include "MyGameMode.h"
#include "GameFramework/PlayerStart.h"
#include "Kismet/GameplayStatics.h"
#include "MyPlayerController.h"
#include "MyPlayerState.h"
#include "MyGameState.h"

AMyGameMode::AMyGameMode()
{
    // ê¸°ë³¸ í´ë˜ìŠ¤ ì„¤ì •
    PlayerControllerClass = AMyPlayerController::StaticClass();
    GameStateClass = AMyGameState::StaticClass();
    PlayerStateClass = AMyPlayerState::StaticClass();
    DefaultPawnClass = nullptr; // GetDefaultPawnClassForControllerì—ì„œ ê²°ì •
}

void AMyGameMode::StartPlay()
{
    Super::StartPlay();
    
    // ê²Œì„ ì‹œì‘ ì‹œ ì¶”ê°€ ë¡œì§
    UE_LOG(LogTemp, Warning, TEXT("Game Started!"));
}

AActor* AMyGameMode::ChoosePlayerStart_Implementation(AController* Player)
{
    // ì»¤ìŠ¤í…€ í”Œë ˆì´ì–´ ì‹œì‘ ìœ„ì¹˜ ë¡œì§
    TArray<AActor*> PlayerStarts;
    UGameplayStatics::GetAllActorsOfClass(GetWorld(), APlayerStart::StaticClass(), PlayerStarts);
    
    if (PlayerStarts.Num() > 0)
    {
        // ê°„ë‹¨í•œ ì˜ˆ: ëœë¤ ì‹œì‘ ìœ„ì¹˜ ì„ íƒ
        int32 RandomIndex = FMath::RandRange(0, PlayerStarts.Num() - 1);
        return PlayerStarts[RandomIndex];
    }
    
    return Super::ChoosePlayerStart_Implementation(Player);
}

void AMyGameMode::PostLogin(APlayerController* NewPlayer)
{
    Super::PostLogin(NewPlayer);
    
    // í”Œë ˆì´ì–´ ë¡œê·¸ì¸ í›„ ì¶”ê°€ ì„¤ì •
    AMyPlayerState* PS = NewPlayer->GetPlayerState<AMyPlayerState>();
    if (PS)
    {
        PS->SetTeam(FMath::RandBool() ? ETeam::Red : ETeam::Blue);
    }
}

UClass* AMyGameMode::GetDefaultPawnClassForController_Implementation(AController* InController)
{
    // ì»¨íŠ¸ë¡¤ëŸ¬ ìœ í˜•ì— ë”°ë¼ ë‹¤ë¥¸ í° í´ë˜ìŠ¤ ë°˜í™˜
    AMyPlayerController* PC = Cast<AMyPlayerController>(InController);
    if (PC)
    {
        return DefaultHumanPawnClass;
    }
    else
    {
        // AI ì»¨íŠ¸ë¡¤ëŸ¬ì¸ ê²½ìš°
        return DefaultAIPawnClass;
    }
}
```