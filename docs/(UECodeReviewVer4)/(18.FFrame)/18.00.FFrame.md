---
layout: default
title: "(18. FFrame)"
parent: "(UE Code-Review ğŸ¤–)"
has_children: true
nav_order: 2
permalink: docs/review/ue/ver4/18/FFrame
---

## ìš°ì„ , stack frameì„ ì´í•´í•´ì•¼í•œë‹¤

* ìŠ¤íƒ í”„ë ˆì„ì€ í•¨ìˆ˜ê°€ í˜¸ì¶œë  ë•Œ ë©”ëª¨ë¦¬ ìŠ¤íƒì— ìƒì„±ë˜ëŠ” ë°ì´í„° êµ¬ì¡°
* ê° í•¨ìˆ˜ í˜¸ì¶œë§ˆë‹¤ í•˜ë‚˜ì”© ìƒì„±

```cpp
void FunctionA() {
    int a = 10;        // FunctionAì˜ ìŠ¤íƒ í”„ë ˆì„ì— ì €ì¥
    int b = 20;        // FunctionAì˜ ìŠ¤íƒ í”„ë ˆì„ì— ì €ì¥
    FunctionB(a, b);   // ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„ ìƒì„±
}

void FunctionB(int x, int y) {
    int result = x + y;  // FunctionBì˜ ìŠ¤íƒ í”„ë ˆì„ì— ì €ì¥
    FunctionC(result);   // ë˜ ë‹¤ë¥¸ ìŠ¤íƒ í”„ë ˆì„ ìƒì„±
}

void FunctionC(int value) {
    int temp = value * 2;  // FunctionCì˜ ìŠ¤íƒ í”„ë ˆì„ì— ì €ì¥
}
```

* ëŒ€ëµ ì´ëŸ°ì‹ì´ê² ì§€?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â† ìŠ¤íƒ ìµœìƒë‹¨
â”‚  FunctionCì˜ í”„ë ˆì„     â”‚
â”‚  - temp = 60           â”‚
â”‚  - value = 30 (ë§¤ê°œë³€ìˆ˜)â”‚
â”‚  - ë°˜í™˜ ì£¼ì†Œ           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  FunctionBì˜ í”„ë ˆì„     â”‚
â”‚  - result = 30         â”‚
â”‚  - x = 10 (ë§¤ê°œë³€ìˆ˜)    â”‚
â”‚  - y = 20 (ë§¤ê°œë³€ìˆ˜)    â”‚
â”‚  - ë°˜í™˜ ì£¼ì†Œ           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  FunctionAì˜ í”„ë ˆì„     â”‚
â”‚  - a = 10              â”‚
â”‚  - b = 20              â”‚
â”‚  - ë°˜í™˜ ì£¼ì†Œ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â† ìŠ¤íƒ ë°”ë‹¥
```

---

## ê·¸ëŸ¼ FFrameì€ ë­˜ê¹Œ?

* FFrameì€ Unreal Engineì—ì„œ í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ì‚¬ìš©ë˜ëŠ” ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” êµ¬ì¡°ì²´
    * ë¸”ë£¨í”„ë¦°íŠ¸ í•¨ìˆ˜ ì‹¤í–‰: ë¸”ë£¨í”„ë¦°íŠ¸ì—ì„œ ì •ì˜ëœ í•¨ìˆ˜ë¥¼ C++ì—ì„œ í˜¸ì¶œí•  ë•Œ
    * ë¦¬í”Œë ‰ì…˜ ì‹œìŠ¤í…œ: UFunctionì„ í†µí•œ ë™ì  í•¨ìˆ˜ í˜¸ì¶œ
    * í•¨ìˆ˜ ë§¤ê°œë³€ìˆ˜ ì „ë‹¬: í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ë§¤ê°œë³€ìˆ˜ë“¤ì„ ê´€ë¦¬
    * ì‹¤í–‰ ìŠ¤íƒ ì¶”ì : í•¨ìˆ˜ í˜¸ì¶œ ìŠ¤íƒ ì •ë³´ ìœ ì§€


### FFrame êµ¬ì¡°

```cpp
struct FFrame
{
    UStruct* Node;           // í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ë…¸ë“œ
    UObject* Object;         // í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ëŠ” ì˜¤ë¸Œì íŠ¸
    uint8* Code;            // ì‹¤í–‰í•  ë°”ì´íŠ¸ì½”ë“œ
    uint8* Locals;          // ì§€ì—­ ë³€ìˆ˜ë“¤
    FProperty* MostRecentProperty; // ê°€ì¥ ìµœê·¼ í”„ë¡œí¼í‹°
    // ... ê¸°íƒ€ ë©¤ë²„ë“¤
};
```

## ì‚¬ìš© ì˜ˆì‹œ

### 1. ê¸°ë³¸ í•¨ìˆ˜ í˜¸ì¶œ

```cpp
// ë¸”ë£¨í”„ë¦°íŠ¸ í•¨ìˆ˜ ì°¾ê¸°
UFunction* Function = GetClass()->FindFunctionByName(TEXT("MyBlueprintFunction"));

if (Function)
{
    // ë§¤ê°œë³€ìˆ˜ ë©”ëª¨ë¦¬ í• ë‹¹
    uint8* Parameters = (uint8*)FMemory_Alloca(Function->ParmsSize);
    FMemory::Memzero(Parameters, Function->ParmsSize);
    
    // FFrame ìƒì„±
    FFrame Stack(this, Function, Parameters, nullptr, Function->Children);
    
    // í•¨ìˆ˜ ì‹¤í–‰
    Function->Invoke(this, Stack, nullptr);
}
```

### 2. ë§¤ê°œë³€ìˆ˜ê°€ ìˆëŠ” í•¨ìˆ˜ í˜¸ì¶œ

```cpp
// ë§¤ê°œë³€ìˆ˜ êµ¬ì¡°ì²´ ì •ì˜
struct FMyFunctionParams
{
    int32 IntValue;
    FString StringValue;
    bool bReturnValue; // ë°˜í™˜ê°’
};

// ë§¤ê°œë³€ìˆ˜ ì„¤ì •
FMyFunctionParams Params;
Params.IntValue = 42;
Params.StringValue = TEXT("Hello World");

// í•¨ìˆ˜ í˜¸ì¶œ
ProcessEvent(Function, &Params);

// ë°˜í™˜ê°’ ì‚¬ìš©
bool Result = Params.bReturnValue;
```

### 3. exec í•¨ìˆ˜ êµ¬í˜„

```cpp
UFUNCTION(exec)
void execMyCommand(FFrame& Stack, RESULT_DECL)
{
    // ë§¤ê°œë³€ìˆ˜ ì½ê¸°
    P_GET_PROPERTY(FIntProperty, IntParam);
    P_GET_PROPERTY(FStrProperty, StringParam);
    P_FINISH;
    
    // ë¡œì§ ì‹¤í–‰
    UE_LOG(LogTemp, Log, TEXT("Command executed: %d, %s"), IntParam, *StringParam);
    
    // ê²°ê³¼ ë°˜í™˜
    if (RESULT_PARAM)
    {
        *(bool*)RESULT_PARAM = true;
    }
}
```

## ë§¤ê°œë³€ìˆ˜ ë§¤í¬ë¡œ

FFrameì—ì„œ ë§¤ê°œë³€ìˆ˜ë¥¼ ì½ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ìœ ìš©í•œ ë§¤í¬ë¡œë“¤:

```cpp
P_GET_PROPERTY(PropertyType, VarName)     // ì¼ë°˜ í”„ë¡œí¼í‹°
P_GET_OBJECT(Class, VarName)              // ì˜¤ë¸Œì íŠ¸
P_GET_UBOOL(VarName)                      // ë¶ˆë¦°ê°’
P_GET_STRUCT(StructType, VarName)         // êµ¬ì¡°ì²´
P_GET_ARRAY(ArrayType, VarName)           // ë°°ì—´
P_FINISH                                  // ë§¤ê°œë³€ìˆ˜ ì½ê¸° ì™„ë£Œ
```

## ì‹¤ì œ ì‚¬ìš© ì‚¬ë¡€

### 1. ë™ì  ì´ë²¤íŠ¸ í˜¸ì¶œ ì‹œìŠ¤í…œ

```cpp
void TriggerBlueprintEvent(const FString& EventName, int32 Value)
{
    UFunction* EventFunction = FindFunction(*EventName);
    if (EventFunction && EventFunction->HasAnyFunctionFlags(FUNC_BlueprintEvent))
    {
        // ì´ë²¤íŠ¸ ë§¤ê°œë³€ìˆ˜ ì„¤ì •
        uint8* Params = (uint8*)FMemory_Alloca(EventFunction->ParmsSize);
        FMemory::Memzero(Params, EventFunction->ParmsSize);
        
        // int32 ë§¤ê°œë³€ìˆ˜ ì„¤ì •
        if (FIntProperty* IntProp = FindFProperty<FIntProperty>(EventFunction, TEXT("Value")))
        {
            IntProp->SetPropertyValue_InContainer(Params, Value);
        }
        
        // ì´ë²¤íŠ¸ í˜¸ì¶œ
        ProcessEvent(EventFunction, Params);
    }
}
```

### 2. ì»¤ìŠ¤í…€ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ê¸°

```cpp
class MYPROJECT_API UCustomScriptExecutor : public UObject
{
public:
    UFUNCTION(exec)
    void execRunScript(FFrame& Stack, RESULT_DECL)
    {
        P_GET_PROPERTY(FStrProperty, ScriptName);
        P_FINISH;
        
        // ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë¡œì§
        ExecuteScript(ScriptName);
    }
    
private:
    void ExecuteScript(const FString& ScriptName);
};
```

