---
layout: default
title: "6. To-Do List ë§Œë“¤ê¸°-5"
parent: "(Vue.JS ê³ ê¸‰2)"
grand_parent: "Vue.JS"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

{% raw %}

## DBì €ì¥í•˜ê¸°

* [Get Code ğŸŒ](https://github.com/EasyCoding-7/vue3.0-basic/tree/Part6-1)

```bash
$ cd vue3-project
$ npm install axios             # axios
$ npm install -g json-server    # jsonìš© ì„œë²„
```

ğŸ¥ rootë‚´ì— db.jsonì„ ìƒì„±í•œë‹¤.

```bash
$ json-server --watch db.json
```

ğŸ¥ ë§Œì•½ `json-server --watch db.json`ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´?<br>
ğŸ¥ [ì°¸ê³  ğŸŒ](https://godnr149.tistory.com/m/193)

```bash
# powershell ê´€ë¦¬ì ê¶Œí•œ
$ executionpolicy # Unrestrictedì¸ì§€ í™•ì¸
# ì•„ë‹ˆë¼ë©´
$ set-executionpolicy unrestricted
```

```vue
<script>
import { ref, computed } from 'vue';
import TodoSimpleForm from './components/TodoSimpleForm.vue';
import TodoList from './components/TodoList.vue';
import axios from 'axios';

export default {
  components: {
    TodoSimpleForm,
    TodoList
  },
  setup() {
    const todos = ref([]);
    const error = ref('');
    const addTodo = (todo) => {
      // todoë¥¼ ì €ì¥
      error.value = '';
      axios.post('http://localhost:3000/todos', {
        subject: todo.subject,
        completed: todo.completed,
      }).then(res => {
        console.log(res);
        todos.value.push(res.data);
      }).catch(err => {
        console.log(err);
        error.value = 'Something went wrong.';
      });  
    };
```

---

## ë¹„ë™ê¸°ì‹ìœ¼ë¡œ ë³€ê²½

* [Get Code ğŸŒ](https://github.com/EasyCoding-7/vue3.0-basic/tree/Part6-2)

```vue
<script>
import { ref, computed } from 'vue';
import TodoSimpleForm from './components/TodoSimpleForm.vue';
import TodoList from './components/TodoList.vue';
import axios from 'axios';

export default {
  components: {
    TodoSimpleForm,
    TodoList
  },
  setup() {
    const todos = ref([]);
    const error = ref('');
    const addTodo = async (todo) => {
      error.value = '';
      try {
        const res = await axios.post('http://localhost:3000/todos', {
          subject: todo.subject,
          completed: todo.completed,
        });
        todos.value.push(res.data);
      } catch (err) {
        console.log(err);
        error.value = 'Something went wrong.';
      }
    };
```

---

## ê°ì¢… dbë°˜ì˜

* [Get Code ğŸŒ](https://github.com/EasyCoding-7/vue3.0-basic/tree/Part6-3)

```vue
<script>
import { ref, computed } from 'vue';
import TodoSimpleForm from './components/TodoSimpleForm.vue';
import TodoList from './components/TodoList.vue';
import axios from 'axios';

export default {
  components: {
    TodoSimpleForm,
    TodoList
  },
  setup() {
    const todos = ref([]);
    const error = ref('');

    // dbë¥¼ í•œ ë²ˆ ì½ëŠ”ë‹¤
    const getTodos = async () => {
      try {
        const res = await axios.get('http://localhost:3000/todos');
        todos.value = res.data;
      } catch (err) {
        console.log(err);
        error.value = 'Something went wrong.';
      }    
    };

    getTodos();

    // ...

    // ì‚­ì œ dbë°˜ì˜
    const deleteTodo = async (index) => {
      error.value = '';
      const id = todos.value[index].id;
      try {
        await axios.delete('http://localhost:3000/todos/' + id);
        
        todos.value.splice(index, 1);
      } catch (err) {
        console.log(err);
        error.value = 'Something went wrong.';
      }
    };

    // toggle db ë°˜ì˜
    const toggleTodo = async (index) => {
      error.value = '';
      const id = todos.value[index].id;
      try {
        await axios.patch('http://localhost:3000/todos/' + id, {
          completed: !todos.value[index].completed
        });

        todos.value[index].completed = !todos.value[index].completed
      } catch (err) {
        console.log(err);
        error.value = 'Something went wrong.';
      }
      
    };
```

{% endraw %}