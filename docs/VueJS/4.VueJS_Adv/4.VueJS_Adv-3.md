---
layout: default
title: "3. API"
parent: "(Vue.JS ê³ ê¸‰)"
grand_parent: "Vue.JS"
nav_order: 1
---

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

{% raw %}

* [Get Code ğŸŒ](https://github.com/EasyCoding-7/vue3.0-adv-tutorial/tree/apiinit)

ğŸ… APIê´€ë¦¬ìš© ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ ë³´ì.

```bash
# APIë¥¼ ìœ„í•´ì„œ axios, vuexì„¤ì¹˜
$ npm i axios@next --save
$ npm i vuex@next --save
```

```js
// index.js
import Vuex from 'vuex';
import getters from './getters.js';
import mutations from './mutations.js';
import actions from './actions.js';

export default new Vuex.Store({
  strict: process.env.NODE_ENV !== 'production',
  state: {
    news: [],
    ask: [],
    jobs: [],
    user: {},
    item: {}
  },
  getters,
  mutations,
  actions,
})
```

---

## API ìš”ì²­ìš©

* [Get Code ğŸŒ](https://github.com/EasyCoding-7/vue3.0-adv-tutorial/tree/requestapi)

```js
import axios from 'axios';

const api = {
  news: 'https://api.hnpwa.com/v0/news/1.json',
  ask: 'https://api.hnpwa.com/v0/ask/1.json',
  jobs: 'https://api.hnpwa.com/v0/jobs/1.json',
  user: 'https://api.hnpwa.com/v0/user/',
  item: 'https://api.hnpwa.com/v0/item/'
};

function fetchNews() {
  return axios.get(api.news);
}

function fetchAsk() {
  return axios.get(api.ask);
}

function fetchJobs() {
  return axios.get(api.jobs);
}

function fetchUser(id) {
  const url = `${api.user}${id}.json`;
  return axios.get(url);
}

function fetchItem(id) {
  const url = `${api.item}${id}.json`;
  return axios.get(url);
}

export {
  fetchNews,
  fetchAsk,
  fetchJobs,
  fetchUser,
  fetchItem
}
```

```vue
<template>
  <div>
      ask
  </div>
</template>

<script>
import { fetchAsk } from '../api/index.js';

export default {
  created() {
    fetchAsk()
      .then(response => console.log(response))
      .catch(error => console.log(error));
  }
}
</script>

<style>

</style>
```

---

## ì¶”ê°€ì„¤ëª…

### JavaScriptì˜ this

```js
// ê·¸ëƒ¥ ì½˜ì†”ì°½ì—ì„œ thisë¥¼ ì³ë³´ì.
this
```

<p align="center">
  <img src="https://taehyungs-programming-blog.github.io/blog/assets/images/vuejs/4.VueJS_Adv/4.VueJS_Adv-3-1.png"/>
</p>

ğŸ… ë­ê°€ ì­ˆë¥´ë¥µ ë‚˜ì˜¤ëŠ”ë° í˜„ì¬ ë¸Œë¼ìš°ì € ê°ì²´(window)ë¥¼ ì˜ë¯¸í•œë‹¤.

```js
// í•¨ìˆ˜ë¥¼ í•˜ë‚˜ ì„ ì–¸í•´ ë³´ì.
function sum(a, b) {
    console.log(this);      // í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ thisë¥¼ í˜¸ì¶œí•´ë„ ìœ„ì™€ ë™ì¼í•˜ê²Œ ë¸Œë¼ìš°ì € ê°ì²´(window)ê°€ ë‚˜ì˜¨ë‹¤.
    return a + b;
}

sum(10, 20);
```

```js
// Vueê°ì²´ë¥¼ í•˜ë‚˜ ìƒì„±í•´ ë³´ì
function Vue(el) {
    console.log(this);      // ì—¬ê¸°ì„œ thisëŠ” ìƒì„±ëœ Vueê°ì²´ë¥¼ ì˜ë¯¸í•œë‹¤.
    this.el = el;
}

new Vue('#app');
```

```js
// ES5 ê¸°ì¤€
// ë§ˆì§€ë§‰ìœ¼ë¡œ ë¹„ë™ê¸° ì²˜ë¦¬ì—ì„œì˜ this
created() {
    var vm = this;
    console.log(this);              // Vue ì»´í¬ë„ŒíŠ¸ë¥¼ ì˜ë¯¸
    fetchNewList()
        .then(function(response) {
            console.log(this);      // None - ë¹„ë™ê¸° í˜¸ì¶œì´ê¸°ì— thisê°€ ëˆ„êµ°ì§€ ëª¨ë¥¸ë‹¤
            vm.user = response.data;// ë”°ë¼ì„œ thisë¥¼ ë³„ë„ ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì ‘ê·¼í•œë‹¤
        })
        .catch(function(error) {
            console.log(error);
        });
}
```

```js
// ES6 ì—ì„œ ìœ„ ë¬¸ì œê°€ ê°œì„ ë¨
created() {
    console.log(this);              // Vue ì»´í¬ë„ŒíŠ¸ë¥¼ ì˜ë¯¸
    fetchNewList()
        .then(response => {         // í™”ì‚´í‘œ í•¨ìˆ˜ë¥¼ ì“°ë©´ ìì‹ ì˜ thisì— ì ‘ê·¼ê°€ëŠ¥
            console.log(this);      // Vue ì»´í¬ë„ŒíŠ¸ë¥¼ ì˜ë¯¸
            this.user = response.data;
        })
        .catch(function(error) {
            console.log(error);
        });
}
```

### JavaScriptì˜ Callback

```js
function fetchData() {
    var result = [];

    $.ajax({
        url: 'https://api.hnpwa.com/v0/news/1.json',
        success: function(data) {
            // ì„±ê³µì‹œ ì—¬ê¸°ë¥¼ í˜¸ì¶œ
            console.log('data' : data);
            retsult = data;

            // ë¬¸ì œ1) callbackë‚´ì—ì„œ callbackì„ ë°›ì„ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ê²½ìš°ê°€ ë°œìƒí•˜ë©´
            // callback hellì´ ì—´ë¦¬ê²Œ ëœë‹¤.

            // ë¬¸ì œ2) ajaxì•¼ callbackì„ ì œê³µí•œë‹¤ì§€ë§Œ callbackì„ ì œê³µí•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ë¥¼ callbackìœ¼ë¡œ ì“°ê³ ì‹¶ë‹¤ë©´?
        }
    });

    console.log('result' : result); // ì´ ë¡œê·¸ì—ëŠ” ì•„ë¬´ê²ƒë„ ë‚¨ê¸°ì§€ ì•ŠëŠ”ë‹¤(ë¹„ë™ê¸°ë¡œ ë™ì‘í•˜ê¸°ì—)
}

fetchData();
```

### JavaScriptì˜ Promise

```js
function callAjax() {
    return new Promise(function(resolve, reject){
        $.ajax({
            url: 'https://api.hnpwa.com/v0/news/1.json',
            success: function(data) {
                resolve(data);
            }
        });
    });
}

function fetchData() {
    callAjax()
        .then(function(result) {
            console.log(result);
        });
}

fetchData();
```

{% endraw %}